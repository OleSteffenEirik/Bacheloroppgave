/*! GENERIC_IPC bundle, Copyright (c) 2011-2017 Paragraphics */
var cortona3d=function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){i(3),i(4),i(5),i(6),e.exports=i(37)},,,function(e,t,i){e.exports=i.p+"../ipc-interactivity-to-html.xsl"},function(e,t,i){e.exports=i.p+"../optimize.xsl"},function(e,t,i){e.exports=i.p+"../ipc2cannella.xsl"},function(e,t){},,function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var i=this[t];i[2]?e.push("@media "+i[2]+"{"+i[1]+"}"):e.push(i[1])}return e.join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},o=0;o<this.length;o++){var r=this[o][0];"number"==typeof r&&(n[r]=!0)}for(o=0;o<t.length;o++){var s=t[o];"number"==typeof s[0]&&n[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),e.push(s))}},e}},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){function n(e,t){for(var i=0;i<e.length;i++){var n=e[i],o=u[n.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](n.parts[r]);for(;r<n.parts.length;r++)o.parts.push(a(n.parts[r],t))}else{for(var s=[],r=0;r<n.parts.length;r++)s.push(a(n.parts[r],t));u[n.id]={id:n.id,refs:1,parts:s}}}}function o(e){for(var t=[],i={},n=0;n<e.length;n++){var o=e[n],r=o[0],s=o[1],a=o[2],l=o[3],c={css:s,media:a,sourceMap:l};i[r]?i[r].parts.push(c):t.push(i[r]={id:r,parts:[c]})}return t}function r(){var e=document.createElement("style"),t=f();return e.type="text/css",t.appendChild(e),e}function s(){var e=document.createElement("link"),t=f();return e.rel="stylesheet",t.appendChild(e),e}function a(e,t){var i,n,o;if(t.singleton){var a=v++;i=m||(m=r()),n=l.bind(null,i,a,!1),o=l.bind(null,i,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=s(),n=d.bind(null,i),o=function(){i.parentNode.removeChild(i),i.href&&URL.revokeObjectURL(i.href)}):(i=r(),n=c.bind(null,i),o=function(){i.parentNode.removeChild(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}function l(e,t,i,n){var o=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=_(t,o);else{var r=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function c(e,t){var i=t.css,n=t.media;t.sourceMap;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function d(e,t){var i=t.css,n=(t.media,t.sourceMap);n&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var o=new Blob([i],{type:"text/css"}),r=e.href;e.href=URL.createObjectURL(o),r&&URL.revokeObjectURL(r)}var u={},p=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},h=p(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),f=p(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,v=0;e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=h());var i=o(e);return n(i,t),function(e){for(var r=[],s=0;s<i.length;s++){var a=i[s],l=u[a.id];l.refs--,r.push(l)}if(e){var c=o(e);n(c,t)}for(var s=0;s<r.length;s++){var l=r[s];if(0===l.refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete u[l.id]}}}};var _=function(){var e=[];return function(t,i){return e[t]=i,e.filter(Boolean).join("\n")}}()},function(e,t,i){i(38);var n=i(39);e.exports=n.expand({loadSpecIDCSS:i(40),scene:i(41),interfaces:{solo:{IPCApiDummy:i(45).IPCApiBase,IPCApi:i(46).IPCApi,Callout3D:i(46).Callout3D},viewer3d:{IPCApiDummy:i(45).IPCApiBase,IPCApi:i(47).IPCApi,Callout3D:i(47).Callout3D}},factory:{fps:i(50),error:i(51),loading:i(52),svg:i(58),solo:i(60),viewer2d:i(65),viewer3d:i(67)},app:i(68)},n),i(70)},function(e,t,i){e.exports=i.p+"../cgm-to-svg.xsl"},function(e,t){function i(e){function t(){}return t.prototype=e.prototype||e,new t}function n(e,t,i){function n(){}if(e&&(n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.superClass=e),i)for(var o in i)i.hasOwnProperty(o)&&(t.prototype[o]=i[o]);return t}function o(e,t){for(var i in t)t.hasOwnProperty(i)&&(i in e?"function"==typeof e[i]&&"function"==typeof t[i]?e[i]=t[i]:e[i]instanceof Object&&t[i]instanceof Object&&t[i]!=={}?o(e[i],t[i]):e[i]=t[i]:e[i]=t[i]);return e}function r(e,t,i){return e+256*t+65536*i}function s(e){return"number"==typeof e?e:"string"==typeof e&&e.match(/^#?([0-9A-F]{6})$/i)?parseInt(RegExp.$1.substr(4,2)+RegExp.$1.substr(2,2)+RegExp.$1.substr(0,2),16):0}function a(e,t,i){var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",e),t&&n.setAttribute("async","async"),n.onload=i,document.getElementsByTagName("head")[0].appendChild(n)}function l(e,t){var i=document.createElement("link");i.href=e,i.rel="stylesheet",i.type="text/css",i.onload=t,document.getElementsByTagName("head")[0].appendChild(i)}e.exports={extend:i,defineClass:n,expand:o,RGB:r,fromHTMLColor:s,loadScript:a,loadStyleSheet:l}},function(e,t,i){function n(e,t){for(var i=!1,n=new RegExp(e+"\\.css","i"),r=document.getElementsByTagName("link"),s=0;s<r.length&&!i;s++){var a=r[s].getAttribute("href");a&&(i=n.test(a))}return i?t():(document.body.style.visibility="hidden",o.loadStyleSheet(e+".css",function(){document.body.style.visibility="visible",t()})),i}var o=i(39);e.exports=n},function(e,t,i){e.exports=i(42)},function(e,t,i){var n=i(39).defineClass,o=i(43),r=i(44),s={},a=n(null,function(e){if(!e)return null;var t=e;if("string"==typeof e?e=document.getElementById(e):t=e.getAttribute("id"),!t){t="__cortona3d-container-1";for(var i=1;document.getElementById(t);i++)t="__cortona3d-container-"+i;e.setAttribute("id",t)}return t in s||(e.classList&&e.classList.add("cortona3d-container"),s[t]=this instanceof a?this:new a(t),this.container=e),s[t]},{add:function(){for(var e=arguments.length-1;e>=0;e--){var t=arguments[e];t instanceof o&&(t=t.factory),t instanceof r&&(this[t.type]=t.create(this))}return this},remove:function(){for(var e=arguments.length-1;e>=0;e--){var t=arguments[e];t instanceof o&&(t=t.factory),t instanceof r&&(t.destroy(this),delete this[t.type])}return this},destroy:function(){var e=this.container.getAttribute("id"),t=s[e];for(var i in t)t[i]instanceof o&&t.remove(t[i].factory);this.container.classList&&this.container.classList.remove("cortona3d-container"),delete s[e]}});e.exports=a},function(e,t,i){var n=i(39).defineClass,o=n(null,function(e){this.factory=e,this.instance=null,this.invalid=!1,this.events=[]},{isValid:function(){return!!this.instance&&!this.invalid},attach:function(){return this},detach:function(){return this},trigger:function(e,t,i){var n=!1,o=null;if(i=void 0===i?this.instance:i,t=t||{raw:[],src:null},t instanceof Object&&(t.targetControl=this),"function"==typeof window.Event?o=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0}):document.createEvent?(o=document.createEvent("CustomEvent"),o.initCustomEvent(e,!0,!0,t)):console.error("ERROR: Browser does not support DOM L3/L4 events specification"),o)try{n=i.dispatchEvent(o)}catch(t){console.error("dispatchEvent('"+e+"') exception: "+t.message)}return n},show:function(){if(this.instance){var e=this.instance.style;e.width=e.height="100%",e.marginLeft=""}return this},hide:function(){if(this.instance){var e=this.instance.style;e.width=e.height="1px",e.marginLeft="-10000px"}return this},load:function(e){return this},unload:function(){return this},version:function(){}});e.exports=o},function(e,t,i){var n=i(39).defineClass,o=n(null,function(e,t){console.assert("string"==typeof e,"WARNING: C3DControlFactory type not a string."),this.type=e,this.events=t&&t instanceof Array?t:[]},{create:function(e){},destroy:function(e){if(void 0!==e[this.type]){e[this.type].detach();var t=e[this.type].instance;t&&t.parentNode&&t.parentNode.removeChild(t)}},getNextId:function(){for(var e=1;document.getElementById(this.type+e);)e++;return this.type+e}});e.exports=o},function(e,t,i){var n=i(39).defineClass,o=function(){},r=function(){console.log("nop"),console.trace()},s=function(){return r(),!0},a=n(null,function(e){this.visible=!1,this.text=e},{show:r,hide:r,setPoint1:r,setPoint2:r,setText:function(e){this.text=e,this.visible&&(this.hide(),this.show())}}),l=n(null,function(e){return e._ipc3dNode||(this.node=e,this.show_flag=!0,this.filter_flag=!1,e._ipc3dNode=this),e._ipc3dNode},{isEqual:function(e){var t=!1;try{t=e instanceof l&&e.node===this.node}catch(e){}return t},getBBox:r,setEmissiveColor:r,setDiffuseColor:r,visibility:r,show:function(e){this.show_flag=e,this.filter_flag||this.visibility(e)},filter:function(e){this.filter_flag=e,this.visibility(this.show_flag&&!e)},setTransparency:r,getTransparency:function(){return 0},getVisibility:s,getSwitchState:s,checkFullTransparency:r,hasGeometry:s,isHidden:r,getAllChildren:function(){return[]},getParentsNames:r,saveMaterial:r,restoreMaterial:r,resetMaterial:r}),c=n(null,function(){this.vrmlNodes=[],this.withoutGeometry=!0},{restoreVrmlNodesMaterial:function(){this.vrmlNodes.forEach(function(e){e.restoreMaterial(!0)})},resetVrmlNodesMaterial:function(){this.vrmlNodes.forEach(function(e){e.resetMaterial(!0)})},setEmissiveColor:function(e){this.vrmlNodes.forEach(function(t){t.setEmissiveColor(e[0],e[1],e[2])})},setDiffuseColor:function(e){this.vrmlNodes.forEach(function(t){t.saveMaterial(!0),t.setDiffuseColor(e[0],e[1],e[2])})},setTransparency:function(e){this.vrmlNodes.forEach(function(t){t.saveMaterial(!0),t.setTransparency(e)})},getTransparency:function(){for(var e=0,t=0;t<this.vrmlNodes.length;t++)e+=this.vrmlNodes[t].getTransparency();return this.vrmlNodes.length&&(e/=this.vrmlNodes.length),e},show:function(e){this.vrmlNodes.forEach(function(t){t.show(e)})},filter:function(e){this.vrmlNodes.forEach(function(t){t.filter(e)})},getVisibility:function(){return this.vrmlNodes.some(function(e){return e.getVisibility()})},checkFullTransparency:function(){return this.vrmlNodes.every(function(e){return e.isHidden()})},fit:r,setCenterpoint:r}),d=n(null,function(e){return d._api||(this.control3d=e,this.data=null,this.tooltipOver3D={hide:o,setTooltipHTML:o},d._api=this),d._api},{attach:r,detach:r,_trigger:function(e,t){"function"==typeof e&&e.apply(this,t)},reset:function(){this._trigger(this.on_reset)},load:r,loadMetadata:function(e){e.indexByNodeName={},e.indexById={},e.dplist.forEach(function(t,i){e.indexById[t.id]=i,t.vrmlnodes.forEach(function(t){e.indexByNodeName[t]=i})}),e.viewById={},e.views.forEach(function(t,i){e.viewById[t.id]=t}),this.data=e},unload:function(){},getCurrentIPCView:r,setIPCView:function(e){this._trigger(this.on_view_changed,[e])},gotoIPCView:function(e){this.setIPCView(e)},resetIPCView:r,hide_background_geometry:r,show_background_geometry:r,set_ui_axis:r,set_ui_zoom:r,set_ui_centerpoint:r,set_ui_revision:r,zoom_reset:r,zoom_set_delta:r,zoom_set_level:r,activatePageViewpoint:o,fitToScene:r,fitToViewParts:r,resetCenterpoint:r,fitToParts:r,setCenterpointToParts:r,setCenterpointToViewParts:r,getIPCPartByIndex:function(){return new c},clearAllCallouts:r,set_axes_file:r,setNavigationStyle:r,getNavigationStyle:r,setCortonaSkin:r,enableNavigation:r,showCortonaProperties:r,setAutoRefreshOff:o,setAutoRefreshOn:o,restoreAutoRefresh:o,doRefresh:o,checkCortonaComponent:function(){return!0},getCortonaVersion:function(){return"8"},print3D:r});e.exports={IPCApiBase:d,IPCPartBase:c,IPCVrmlNodeBase:l,Callout3DBase:a}},function(e,t,i){function n(e){function t(e){var t=e.$("metadata/value").filter(function(e){return 3==e.$attr("role")}).concat(e.$("metadata/value").filter(function(e){return 4==e.$attr("role")})).map(function(e){return e.$text()}).join("");return t+="/",t+=i(e.$("metadata/value"),"ISN")}function i(e,t){return e.filter(function(e){return e.$attr("decl-id")==t}).map(function(e){return e.$text()}).join("")}function n(e,t,n){for(var o="",r=i(e.$("metadata/value"),"IND")-1,s=t-1;s>=0;s--){var a=n[s],l=i(a.$("metadata/value"),"ASP")||0;if(1!=l&&+i(a.$("metadata/value"),"IND")===r)break}for(;s>=0;s--){var a=n[s];if(+i(a.$("metadata/value"),"IND")===r&&!+i(a.$("metadata/value"),"NIL")){o=a.$attr("id");break}}return o}var o=e.app.ipc.interactivity,r=o.json,s={metadata:[],media:[],dplist:[],views:[],bgmedia:[]},a=o.getProjectMetadata();for(var l in a)s.metadata.push({name:l,value:a[l]});s.vrmlfile=r.$("ipc/figure/media").filter(function(e){return 1==e.$attr("id")})[0].$attr("src"),s.interactivity=e.app.getDocumentInfo().companionFile;var a=o.getOptions();for(var l in a)s.media.push({name:l,value:a[l]});return s.bgmedia=r.$("ipc/figure/bgmedia/refmedia").map(function(e){return e.$text()}),s.views=r.$("ipc/figure/views/view").map(function(e){var n={id:e.$attr("id"),stepid:e.$attr("stepid"),description:e.$text("description"),changed:!!+e.$attr("changed"),hidden:!!+e.$attr("hidden"),viewpoint:{},itemnbr:{},cgmsrc:""};e.viewpoint&&(n.viewpoint.name=e.viewpoint.$attr("name")||"",n.viewpoint.vrmlnode=e.viewpoint.$text("refmedia")),n.transitions=e.$("transition").map(function(e){return{id:e.$attr("id"),stepid:e.$attr("stepid"),vrmlnodes:e.$("refmedia").map(function(e){return e.$text()})}}),n.items=e.$("refItem").map(function(e){return e.$attr("ref")}),e.$("refItem").forEach(function(e){var i=e.$attr("ref"),o=r.$("ipc/figure/dplist/item").filter(function(e){return e.$attr("id")===i})[0];n.itemnbr[t(o)]=1}),n.metadata=e.$("metadata/value").map(function(e){return{name:e.$attr("name"),value:e.$text()}}),n.graphics=i(e.$("metadata/value"),"GRAPHICS");var o=e.$("refmedia").filter(function(e){return 1!=e.$attr("ref")}).map(function(e){return e.$attr("ref")}).join("");return o&&(n.cgmsrc=r.$("ipc/figure/media").filter(function(e){return e.$attr("id")==o})[0].$attr("src")),n}),s.dplist=r.$("ipc/figure/dplist/item").filter(function(e){return e.$("metadata/value").filter(function(e){return"IND"==e.$attr("decl-id")}).length>0}).map(function(e,o,s){function a(e){e.$("cmdtext").forEach(function(e){y[e.$attr("refCmd")]=e.$text()}),e.$("*").forEach(function(e){a(e)})}function l(e){return[e.MI||u,e.SDC||p,e.SYSTEM||h,e.SUBSYSTEM||f,e.UNIT||m,(e.DC||v)+(e.DCV||_),(e.IC||g)+(e.ICV||C),e.ILC||I].join("-")}var c={id:e.$attr("id"),parent:n(e,o,s),itemnumber:t(e),filter:{usage:[],modelapply:[],sb:[]},mainview:"",links:[]};c.vrmlnodes=e.$("refmedia").map(function(e){return e.$text()}),c.filter.usage=i(e.$("metadata/value"),"UCA").replace(/[ -]/g,"").split(""),e.refview&&(c.mainview=e.refview.$attr("ref")),e.tooltip&&(c.tooltip=e.$text("tooltip"));var d=r.$("ipc/figure/metadata/value"),u=i(d,"MI")||"GENERIC",p=i(d,"SDC")||"A",h=i(d,"SYSTEM")||"00",f=i(d,"SUBSYSTEM")||"00",m=(f.substr(0,1),f.substr(1,1),i(d,"UNIT")||"00"),v=i(d,"DC")||"00",_=i(d,"DCV")||"0",g=i(d,"IC")||"941",C=i(d,"ICV")||"A",I=i(d,"ILC")||"D",y={};return a(r),e.$("commands/command").forEach(function(e){var t,i,n=e.$attr("type"),o="";switch(n){case"REF_CSN":case"REF_NHA":case"REF_DET":t=l({SYSTEM:e.value[0].$text(),SUBSYSTEM:e.value[1].$text(),UNIT:e.value[2].$text(),DC:e.value[3].$text(),DCV:e.value[4].$text()||(e.value[3].$text()?"0":"")}),i=e.value[5].$text()+e.value[6].$text(),o=t+".htm"+(i?"#"+i:"");break;case"RTX_CSNREF":t=l({SYSTEM:e.value[1].$text(),SUBSYSTEM:e.value[2].$text(),UNIT:e.value[3].$text(),DC:e.value[4].$text(),DCV:e.value[5].$text()||(e.value[4].$text()?"0":"")}),i=e.value[6].$text()+e.value[7].$text(),o=t+".htm"+(i?"#"+i:"")}o&&c.links.push({href:o,description:y[e.$attr("id")]})}),c}),s}var o=i(39).defineClass,r=i(45).IPCApiBase,s=i(45).IPCVrmlNodeBase,a=i(45).IPCPartBase,l=i(45).Callout3DBase,c=(i(39).RGB,o(l,function(e){c.superClass.call(this,e)},{})),d={},u={},p=o(s,function(e){return e in d||(this.name=e,this.handle=f().solo.app.getObjectWithName(e),this.show_flag=!0,this.filter_flag=!1,d[e]=this,u[this.handle]=this),d[e]},{visibility:function(e){f().solo.app.setObjectPropertyf(this.handle,3,!1,!e)},saveMaterial:function(){},setEmissiveColor:function(e,t,i){f().solo.app.setObjectPropertyf(this.handle,1,!1,e,t,i)},setDiffuseColor:function(e,t,i){f().solo.app.setObjectPropertyf(this.handle,0,!1,e,t,i)},setTransparency:function(e){f().solo.app.setObjectPropertyf(this.handle,2,!1,e)},restoreMaterial:function(){f().solo.app.restoreObjectProperty(this.handle,0,!1)},resetMaterial:function(){for(var e=f().solo.app,t=0;t<2;t++)e.restoreObjectProperty(this.handle,t,!1)}}),h=o(a,function(e,t){h.superClass.call(this),this.vrmlNodes=t,this.children=[],this.withoutGeometry=0===t.length,this.index=e,this.tag=e,this.visible=!0,this.filtered=!1,this.display=!0,this.emissiveColor=0},{initialize:function(){this.vrmlNodes=this.vrmlNodes.map(function(e){return new p(e)})},appendChild:function(e){this.children.push(e)},getAllChildren:function(){var e=this.children;return this.children.forEach(function(t){e=e.concat(t.getAllChildren())}),this.children},getObjectVMArray:function(e){var t=this.vrmlNodes;return e&&this.getAllChildren().forEach(function(e){t=t.concat(e.getObjectVMArray())}),t},setDisplay:function(e){this.display=e},getSheetIndex:function(){for(var e=f(),t=e.data.viewById[e.currentViewId],i=t.items.sort(function(e,t){return e===t?0:e>t?1:-1}),n=-1,o=0;o<i.length;o++)if(i[o]===this.index){n=o;break}return n},checkFullTransparency:function(){return!this.visible},show:function(e){var t=f();if(this.visible=e,t.NO_DPL)this.constructor.superClass.prototype.show.call(this,e);else{var i=this.getSheetIndex();if(i>=0){var n=this.visible&&!this.filtered;this.display!==n&&(this.display=n,t.ipc.toggleItemVisibility(i))}}},filter:function(e){this.filtered=e,this.show(this.visible)},setEmissiveColor:function(e){this.constructor.superClass.prototype.setEmissiveColor.call(this,e),this.getAllChildren().forEach(function(t){t.setEmissiveColor(e)})},setDiffuseColor:function(e){this.constructor.superClass.prototype.setDiffuseColor.call(this,e),this.getAllChildren().forEach(function(t){t.setDiffuseColor(e)})},setTransparency:function(e){this.constructor.superClass.prototype.setTransparency.call(this,e),this.getAllChildren().forEach(function(t){t.setTransparency(e)})},restoreVrmlNodesMaterial:function(){this.constructor.superClass.prototype.restoreVrmlNodesMaterial.call(this),this.getAllChildren().forEach(function(e){e.restoreVrmlNodesMaterial()})},resetVrmlNodesMaterial:function(){this.constructor.superClass.prototype.resetVrmlNodesMaterial.call(this),this.getAllChildren().forEach(function(e){e.resetVrmlNodesMaterial()})}}),f=o(r,function(e){var t=f.superClass.call(this,e);return t===this&&(this.initialViewName="",this.currentViewId="",this.container=i(41)(e.instance.parentNode).container,this.parts={},this.tooltipOver3D={_t:null,hide:function(){t.container.removeAttribute("title"),clearTimeout(this._t)},setTooltipHTML:function(e){this._t=setTimeout(function(){t.container.title=e.replace(/<br>/g,"\n").replace(/(^[\s\n]+|[\s\n]+$)/g,"")},0)}}),t},{loadMetadata:function(e){if(e){this.constructor.superClass.prototype.loadMetadata.call(this,e);var t=this;e.dplist.forEach(function(i,n){var o=e.dplist[n];t.parts[n]=new h(n,o.vrmlnodes)}),e.dplist.forEach(function(i,n){var o=e.dplist[n];o.parent&&t.parts[e.indexById[o.parent]].appendChild(t.parts[n])});for(var i=0;i<e.views.length;i++){var o=e.views[i];if(!o.hidden){this.initialViewName=o.id,this.currentViewId=o.id;break}}}else!this.data&&this.solo&&this.solo.app.ipc.interactivity&&this.loadMetadata(n(this.solo))},load:function(e,t){this.loadMetadata(t),this.control3d.load(e.replace(/\.wrl$/i,".interactivity.xml"))},setIPCView:function(e){this.ipc.setCurrentSheet(e,0)},gotoIPCView:function(e){this.ipc.setCurrentSheet(e,1)},resetIPCView:function(){this.ipc.resetCurrentSheet(1),this.solo.app.restoreObjectProperty(0,0,!1),this.solo.app.restoreObjectProperty(0,1,!1),this.solo.app.restoreObjectProperty(0,2,!1)},fitToViewParts:function(e){e?("left"==e?e="right":"right"==e&&(e="left"),this.solo.app.jumpToStandardView(e,!0)):this.solo.app.fitSceneInView(!0)},fitToParts:function(e){var t=[];e.forEach(function(e){t=t.concat(e.getObjectVMArray().map(function(e){return e.handle}))}),this.solo.app.fitObjectsInView(t,!0,.5)},fitToScene:function(){this.solo.app.fitSceneInView(!0)},resetCenterpoint:function(){this.solo.app.resetRotationCenter()},setCenterpointToParts:function(e){var t=[];e.forEach(function(e){t=t.concat(e.getObjectVMArray().map(function(e){return e.handle}))}),this.solo.app.setRotationCenterToObjects(t,!0)},setCenterpointToViewParts:function(){this.solo.app.setRotationCenterToScene()},getIPCPartByIndex:function(e){return this.parts[e]||null},getPartBySheetIndex:function(e){var t=this.data.viewById[this.currentViewId],i=null;return e>=0&&t&&(i=this.getIPCPartByIndex(t.items.sort(function(e,t){return e===t?0:e>t?1:-1})[e])),i},getPartByNodeName:function(e){return this.getIPCPartByIndex(this.data.indexByNodeName[e])},set_ui_centerpoint:function(e){this.solo.app.setRotationCenterVisibility(e)},setNavigationStyle:function(e){"goto"===e&&(this.gotoMode=!0)},getNavigationStyle:function(){return this.gotoMode?"goto":"spin"},print3D:function(e){setTimeout(function(){window.print(),e&&e()},500)},attach:function(){if(!this.defaultHandler){var e=this;this.defaultHandler=function(t){var i=!0;if(t.detail&&t.detail.src){var n=t.detail.src;if(void 0!==n.altKey&&void 0!==n.button){var o=[0,1,4,2],r=n.target||n.srcElement,s=r.getBoundingClientRect(),a=n.clientX-s.left,l=n.clientY-s.top;e._mouse_keys=+(n.shiftKey&&1)|+(n.ctrlKey&&2)|+(n.altKey&&4),e._mouse_button=void 0!==n.which?o[n.which]:n.button,e._mouseX=a,e._mouseY=l}}var c,d;if(e.solo){var u=e.solo.app.getPickerTransparencyThreshold(),h=e.SKIP_TRANSPARENCY_THRESHOLD_LEVEL||1e-4;Math.abs(u-h)>.01&&e.solo.app.setPickerTransparencyThreshold(h)}switch(t.type){case"OnReady":e.solo=e.control3d.solo,e.ipc=e.solo.app.ipc;break;case"OnObjectVMEnter":handle=t.detail.raw[0],d=t.detail.raw[1],e.NO_DPL?(c=new p(d),c.handle=handle):c=e.getPartByNodeName(d),e._trigger(e.on_part_over,[c]);break;case"OnObjectVMOut":e._trigger(e.on_part_over,[null]);break;case"OnObjectVMHit":e.gotoMode?(e.solo.app.setRotationCenterToObjects([t.detail.raw[0]],!0),e.gotoMode=!1):4&t.detail.raw[2]||1&t.detail.raw[2]&&4&t.detail.raw[3]?(e.solo.app.setRotationCenterToObjects([t.detail.raw[0]],!1),e.solo.app.centerRotationCenterInView(!0)):(handle=t.detail.raw[0],d=t.detail.raw[1],e.NO_DPL?(c=new p(d),c.handle=handle):c=e.getPartByNodeName(d),e._trigger(e.on_part_click,[c,t.detail.raw[2],t.detail.raw[3],t.detail.raw[4],t.detail.raw[5]]));break;case"Click":e.control3d.overObject||e._trigger(e.on_part_click,[null,e._mouse_button,e._mouse_keys,e._mouseX,e._mouseY]);break;case"OnSceneLoaded":var f=!1;if(t.detail.raw[0]&&"ipc"==t.detail.src.type){e.solo.app.configureInstance(e.solo.app.DISABLE_DOCUMENT_INTERACTIVITY,0),e.loadMetadata();for(var m in e.parts)e.parts[m].initialize();e.ipc.didSelectSheet=function(t){var i=Array.prototype.slice.call(arguments);setTimeout(function(){console.info(i),e._trigger(e.on_view_changed,[t.id]),e.currentViewId=t.id},0)},e.ipc.didHoverItem=function(t){Array.prototype.slice.call(arguments);setTimeout(function(){var i=(e.data.viewById[e.currentViewId],e.getPartBySheetIndex(t));e._trigger(e.on_part_over,[i])},0)},e.ipc.didSelectItem=function(t){Array.prototype.slice.call(arguments);setTimeout(function(){var i=(e.data.viewById[e.currentViewId],e.getPartBySheetIndex(t));e._trigger(e.on_part_click,[i,e._mouse_button,e._mouse_keys,e._mouseX,e._mouseY])},0)},e.ipc.didChangeItemVisibility=function(t,i,n){for(var o=0;o<n;o++){var r=e.solo.core.getValue(i+4*o,"i32");e.getPartBySheetIndex(r).setDisplay(!t)}},f=!0}e._trigger(e.on_simulation_load,[f]),e._trigger(e.on_view_changed,[e.initialViewName])}return i},this.control3d.factory.events.forEach(function(t){e.control3d.instance.addEventListener(t,e.defaultHandler,!1)}),console.log("Ipc3D API attached")}},detach:function(){if(this.defaultHandler){var e=this;this.control3d.factory.events.forEach(function(t){e.control3d.instance.removeEventListener(t,e.defaultHandler,!1)}),delete this.defaultHandler,console.log("Ipc3D API detached")}},getIPCPart:function(e){return this.getIPCPartByIndex(e)},prepareIPCParts:function(e){for(var t=0;t<e.length;t++)this.parts[e[t].id]=new h(t,e[t].vrmlnodes),this.parts[e[t].id].initialize()}});e.exports={IPCApi:f,Callout3D:c}},function(module,exports,__webpack_require__){function IPCApi(e,t){return IPCApi._api||(this.VERSION="1.5.1.34",this.STOP=0,this.PLAY=1,this.PAUSE=2,this.MOUSE_MOVE_SENSITIVITY=3,this.TOOLTIP_DELAY=500,this.ENABLE_TOOLTIPS=!0,this.SKIP_TRANSPARENT_SHAPES=!0,this.SKIP_TRANSPARENCY_THRESHOLD_LEVEL=0,this.NO_DPL=!1,this.STANDARD_VIEWS={front:"0 1 0 3.14159",back:"0 1 0 0",left:"0 -1 0 1.5708",right:"0 1 0 1.5708",top:"1 0 0 -1.5708",bottom:"0 .707107 -.707107 3.14159",isometric:"-.156558 -.912487 -.377964 2.41886"},this.MIN_ZOOM_MINIMUM=0,this.MIN_ZOOM_MAXIMUM=.3,this.DEFAULT_MIN_ZOOM=.3,this.DEFAULT_MAX_ZOOM=150,this.ZOOM_CORRECTION_FACTOR=2,this.TRANSITION_SPEED_RATIO=5,this.FREEZE_CAMERA_MODE=!1,this.ATP=0,this.CALLOUT_COLOR=[0,0,0],this.CALLOUT_FONT_SIZE=3,this.CALLOUT_PROTO=__webpack_require__(48),this.uiActions=["revokePropPage:{E5711FD5-464F-11D3-9D7D-00A0247A5F3F}","revokePropPage:{EC48A005-4978-11D3-9D7E-00A0247A5F3F}","revokePropPage:{E5711FD4-464F-11D3-9D7D-00A0247A5F3F}","revokePropPage:{4E98BA8B-91CE-45C3-B62A-1C67CB99EB75}"],this.ICA_CONTROL_SCRIPT_SYNTAX=__webpack_require__(49),this.COPIER_SYNTAX='DEF CORTONA_CARBONCOPIER Script {eventIn SFBool pageSetup eventIn SFBool print field SFString headerText "&bProprietary Commercial Data" field SFString footerText "" field MFString headerStyle ["" "" "" "" "" "solid"] field MFString footerStyle ["" "" "" "" "" "solid"] url "nativescript: libuid=CarbonCopy; scriptid=CopierScript; file-win32-x86=CarbonCopy.dll#version=1,0,0,8" }',this.VP_ORDER=1,this.is_loaded=!1,this.autorefreshstack=[],this.tooltipOver3D=t?new TooltipOver3D(t):new TooltipIn3D,this.cortona=e.instance||e,this.control=e,this.data=null,this.control_script=null,this.navigation_central=null,this.root_switch=null,this.revision_switch=null,this.axes_switch=null,this.callouts_group=null,this._skipNodes=[],this._lastOverObject=null,this.id_procedure="",this.id_step="",this.id_substep="",this.state=0,this.procedure_fraction=0,this.zoom_level=.5,this.initialViewName=null,this.IPCViewList=new IPCViews,this.IPCParts={},this.IPCPartsArray=[],this.nodes={},this.allnodes={},this.bgnodes=null,this._transitions=[],this._view=null,this.is_nonlinear_mode=!1,this._all_steps=null,this._active_steps=null,this._default_skin="{75B359F4-C1D2-4E21-BC36-F699BD1792BA}",this._axes_file="",this.is_set_center_mode=!1,this._xEventScript=null,this._xProcessedParts=[],this._control_script_handlers={on_start_substep:function(e,t,i){IPCApi._api._trigger(IPCApi._api.on_start_substep,[e.GetValue(0),e.GetValue(1),e.GetValue(2)]),IPCApi._api.id_procedure=e.GetValue(0),IPCApi._api.id_step=e.GetValue(1),IPCApi._api.id_substep=e.GetValue(2)},on_vcr_state:function(e,t,i){IPCApi._api._trigger(IPCApi._api.on_vcr_state,[e.Value]),IPCApi._api.state==IPCApi._api.PLAY&&e.Value==IPCApi._api.STOP&&IPCApi._api._nextTransition(),IPCApi._api.state=e.Value},on_proc_fraction_changed:function(e,t,i){IPCApi._api._trigger(IPCApi._api.on_proc_fraction_changed,[e.Value]),IPCApi._api.procedure_fraction=e.Value},on_zoom_changed:function(e,t,i){IPCApi._api._trigger(IPCApi._api.on_zoom_changed,[e.Value]),IPCApi._api.zoom_level=e.Value}},this._tooltip_timeout=null,this._last_x=this._last_y=this._last_button=this._down_x=this._down_y=0,IPCApi._api=this),IPCApi._api}function IPCPart(e,t){this.vrmlNodes=new Array,this.withoutGeometry=!0;for(var i=0;i<e.length;i++)this.vrmlNodes[i]=IPCApi._api.getVrmlNode(e[i]),null!=this.vrmlNodes[i]&&(null==this.vrmlNodes[i].tag&&(this.vrmlNodes[i].tag=t),this.withoutGeometry=!1)}function IPCViewpoint(e,t){this.description=e,this.node=t,""==this.description&&(this.description="unnamed")}function IPCVrmlNodeMaterial(e,t){this.materialnode=e,this.nodecolors=[],this.colorfield=null;try{var i=t.Fields.Item("currentRepresentation").Value;if(i>=0&&t.Fields.Item("representations").Count>i){var n=t.Fields.Item("representations").GetValue(i).Fields.Item("geometry").Value;if("IndexedFaceSet"==n.TypeName){var o=n.Fields.Item("color").Value;if(o){this.colorfield=o.Fields.Item("color");for(var r=0;r<this.colorfield.Count;r++)this.nodecolors.push(this.colorfield.GetValue(r))}}}}catch(e){}var s=e.Fields.Item("diffuseColor");this.diffuseColor=new Array(s.Red,s.Green,s.Blue),this.transparency=e.Fields.Item("transparency").Value}function IPCVrmlNode(e){this.node=e,arguments.length>1?this.name=arguments[1]:this.name=e.Name,this.tag=null,this._materialSaved=!1,this.show_flag=!0,this.filter_flag=!1}function IPCViews(){this.array={},this.initialViewName=null}function IPCView(e,t,i,n,o,r,s){this.id=e,this.name=t,this.description=i,this.autoLevelFlags=n,this.nodesList=o,this.transitionsList=r,this.viewpointsList=s}function IPCTransition(e,t,i,n){this.id=e,this.name=t,this.reverse=n,this.triggersArray=i}function TooltipOver3D(e){this.tooltip=e,this.tooltipHTML="",this.tooltipWin=window.createPopup(),this.TOOLTIP_DX=15,this.TOOLTIP_DY=20;var t=this.tooltipWin.document.body;t.style.backgroundColor="#FFFFDD",t.style.border="black solid 1px",t.style.padding="3px 3px 3px 3px",t.style.fontSize="9pt",t.style.fontFamily="tahoma, sans-serif",t.style.textAlign="center",TooltipOver3D.prototype.show=function(){if(""!=this.tooltipHTML){this.tooltip.innerHTML=this.tooltipHTML;var t=cortona.offsetWidth,i=cortona.offsetHeight,n=e.offsetWidth,o=e.offsetHeight,r=this.x+this.TOOLTIP_DX,s=this.y+this.TOOLTIP_DY;r+n>t&&(r=t-n),s+o>i&&(s=i-o),this.tooltipWin.document.body.innerHTML=this.tooltipHTML,this.tooltipWin.show(r,s,n,o,cortona)}},TooltipOver3D.prototype.hide=function(){this.tooltipWin.hide()},TooltipOver3D.prototype.setTooltipHTML=function(e){this.tooltipHTML=e},TooltipOver3D.prototype.setXY=function(e,t){this.x=e,this.y=t},TooltipOver3D.prototype.checkPointTooltip=function(e,t){return!1}}function TooltipIn3D(){this.tooltipHTML="",this.groupNode=null,this.x=0,this.y=0,this.state=null,this.TOOLTIP_DX=15,this.TOOLTIP_DY=20,this.PADDING=3,this.BACKGROUNDTRANSPARENCY=0,this.BACKGROUNDCOLOR=[1,1,.87],this.BORDERCOLOR=[0,0,0],this.BORDERSIZE=1,this.WIDTH="",TooltipIn3D.prototype.show=function(){if(IPCApi._api.is_loaded&&""!=this.tooltipHTML&&(0!=this.x||0!=this.y)){var e=IPCApi._api.cortona.Engine;null==this.groupNode&&(this.groupNode=e.CreateVrmlFromString("Group{}").GetValue(0),e.RootNodes.Add(this.groupNode));var t=IPCApi._api.cortona.DisplayMode,i=0==t.Width?IPCApi._api.cortona.clientWidth:t.Width,n=0==t.Height?IPCApi._api.cortona.clientHeight:t.Height,o='Panel{top "-500" left "-500" width "'+this.WIDTH+'" source HTMLText{body "<font face=\\"tahoma, sans-serif\\" color=\\"#000000\\">'+this.tooltipHTML+'</font>" padding ['+this.PADDING+", "+this.PADDING+", "+this.PADDING+", "+this.PADDING+"]}borderSize "+this.BORDERSIZE+"}",r=e.CreateVrmlFromString(o).GetValue(0);this.groupNode.Fields.Item("children").Add(r);var s=r.Fields.Item("contentSize"),a=s.GetValue(0)+2,l=s.GetValue(1)+2;this.groupNode.Fields.Item("children").Clear();var c=this.x+this.TOOLTIP_DX,d=this.y+this.TOOLTIP_DY;c+a>i&&(c=i-a),d+l>n&&(d=n-l);var o='Panel{left "'+c+'" top "'+d+'" width "'+a+'" height "'+l+'" source HTMLText{body "<font face=\\"tahoma, sans-serif\\" color=\\"#000000\\">'+this.tooltipHTML+'</font>" padding ['+this.PADDING+", "+this.PADDING+", "+this.PADDING+", "+this.PADDING+"]}backgroundTransparency "+this.BACKGROUNDTRANSPARENCY+" backgroundColor "+this.BACKGROUNDCOLOR.join(" ")+" borderColor "+this.BORDERCOLOR.join(" ")+" borderSize "+this.BORDERSIZE+"}";this.state={x:c,y:d,w:a,h:l};var r=e.CreateVrmlFromString(o).GetValue(0);this.groupNode.Fields.Item("children").Add(r);
}},TooltipIn3D.prototype.hide=function(){null!=this.groupNode&&(this.groupNode.Fields.Item("children").Clear(),this.state=null)},TooltipIn3D.prototype.setTooltipHTML=function(e){this.tooltipHTML=e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')},TooltipIn3D.prototype.setXY=function(e,t){this.x=e,this.y=t},TooltipIn3D.prototype.checkPointTooltip=function(e,t){var i=!1;if(this.state){var n=this.state;e>n.x&&e<n.x+n.w&&t>n.y&&t<n.y+n.h&&(i=!0)}return i}}function Callout3D(e,t,i,n,o){this.visible=!1,this.text=e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"');var r=IPCApi._api.cortona.Engine;this.point1=r.GetProjectedPoint(t,i,"1"),this.point2=r.GetProjectedPoint(n,o,"1"),this.node=null,this.id="N"+Math.random()}IPCApi.prototype.attach=function(){if(!this.defaultHandler){var e=this;this.defaultHandler=function(t){function i(e,t,i,n){return Math.sqrt((i-e)*(i-e)+(n-t)*(n-t))}if(t.target===e.cortona)switch(t.type){case"OnSceneLoaded":var n=t.detail.raw[0];if(e.cortona){if(n){var o=e.cortona.Engine;if(o.AutoRefresh=1,n=!1,o.RootNodes.Count>0){e.setAutoRefreshOff();try{e.is_loaded=!1;for(var r=1;r<=o.RootNodes.Count;r++)if("AxesPanel"==o.RootNodes.Item(r).TypeName){e.axes_switch=o.RootNodes.Item(r);break}for(e.control_script=null,r=1;r<=o.RootNodes.Count;r++)if("IPCSimulation"==o.RootNodes.Item(r).TypeName){e.control_script=o.RootNodes.Item(r);break}if(null===e.control_script){for(e.control_script=o.CreateProtoFromString(e.ICA_CONTROL_SCRIPT_SYNTAX).CreateInstance(),o.RootNodes.Add(e.control_script),r=1;r<=o.RootNodes.Count;r++)if("Procedure"==o.RootNodes.Item(r).TypeName){e.control_script.Fields.Item("procedure").Value=o.RootNodes.Item(r);break}var s=o.CreateVrmlFromString("Group{}");e.revision_switch=s.GetValue(0),o.RootNodes.Add(e.revision_switch)}if(0!==e.ATP){var a=o.CreateVrmlFromString('Script{eventIn MFNode trnsNodes eventIn MFNode dcNodes eventIn MFNode emsNodes eventIn SFString inVal eventOut SFString outVal url "javascript: /** @ignore */ function inVal(value) {outVal=value;} /** @ignore */ function emsNodes(value) {var hlColor=value[0].emissiveColor;for (var i=1; i<value.length; i++) {value[i].appearance.material.emissiveColor=hlColor;}} /** @ignore */ function dcNodes(value) {var slColor=value[0].diffuseColor;var nodes=[];for (var i=1; i<value.length; i++) {nodes.push(value[i]);}for (var i=0;i<nodes.length;i++) {var n=nodes[i];dcNode(n, slColor);if (n.children) {var ch = n.children;for (var j=0; j<ch.length; j++) {nodes.push(ch[j]);}}}} /** @ignore */ function dcNode(nd, slColor) {if (nd) {if (nd.appearance && nd.appearance.material)nd.appearance.material.diffuseColor=slColor;var cr=nd.currentRepresentation;if (nd.representations && nd.representations.length>cr) {var geom = nd.representations[cr].geometry;if (geom && geom.color && geom.color.color) {var fc=geom.color.color;for (var j=0; j<fc.length; j++) {fc[j]=slColor;}}}}} /** @ignore */ function trnsNodes(value) {var t=value[0].transparency;var nodes=[];for (var i=1;i<value.length;i++) {nodes.push(value[i]);}for (var i=0;i<nodes.length;i++) {var n=nodes[i];if (n) {if (n.appearance && n.appearance.material)n.appearance.material.transparency=t;if (n.children) {var ch=n.children;for (var j=0;j<ch.length;j++) {nodes.push(ch[j]);}}}}}"}');e._xEventScript=a.GetValue(0),o.RootNodes.Add(e._xEventScript),e._xEventScript.Fields.Item("outVal").Advise(e._onEventX,0)}var l=null;try{l=o.Nodes.Item("_SKIN_INFO")}catch(t){var c='PROTO WorldInfo0 [exposedField MFString info [] exposedField SFString title ""]{Group{}}DEF _SKIN_INFO WorldInfo0{info["zoom_center=true", "fit=false", "setcenter=false", "skipsensors=true", "limits='+e.DEFAULT_MIN_ZOOM+","+e.DEFAULT_MAX_ZOOM+'"]}',a=o.CreateVrmlFromString(c);l=a.GetValue(0),o.RootNodes.Add(l)}e._advise_control_script_events(),e.navigation_central=e.control_script,e.root_switch=e.control_script,e.is_loaded=!0,n=!0,e.initialize_nonlinear_mode()}catch(e){console.error("Error in OnSceneLoaded: "+e.message),o.RootNodes.Clear()}e.prepareIPCParts(e.data.dplist),e.cortona.Skin=e._default_skin;for(var r=0;r<e.uiActions.length;r++)e.cortona.uiAction(e.uiActions[r]);e.IPCViewList.loadFromData(e.data.views,e.data.dplist)}e.restoreAutoRefresh()}e._trigger(e.on_simulation_load,t.detail.raw)}break;case"OnSceneUnloaded":e._unadvise_control_script_events();try{e.reset()}catch(e){}e.is_loaded=!1;break;case"MouseDown":var d=t.detail.raw[0],u=t.detail.raw[1],p=t.detail.raw[2],h=t.detail.raw[3];if(!e.is_loaded)return;if(clearTimeout(e._tooltip_timeout),e.ENABLE_TOOLTIPS&&e.tooltipOver3D.hide(),1==e.cortona.NavigationBar&&h>e.cortona.clientHeight-30)return;if(e._trigger(e.on_mouse_down,t.detail.raw),e.is_set_center_mode||5==u||4==u)return e.is_set_center_mode=!1,void e._onClick(e._skipAndPick(p,h),4,0,p,h);e._last_button=d,e._down_x=p,e._down_y=h;break;case"MouseMove":var d=t.detail.raw[0],u=t.detail.raw[1],p=t.detail.raw[2],h=t.detail.raw[3];if(!e.is_loaded)return;if(1==e.cortona.NavigationBar&&h>e.cortona.clientHeight-30)return void e.OnMouseOut();i(p,h,e._last_x,e._last_y)>e.MOUSE_MOVE_SENSITIVITY&&(e._trigger(e.on_mouse_move,t.detail.raw),0==d?(e._last_x=p,e._last_y=h,e.tooltipOver3D.checkPointTooltip(p,h)||(e.tooltipOver3D.setXY(p,h),e._onOver(e._skipAndPick(p,h)))):e._onOver([]));break;case"MouseUp":var d=t.detail.raw[0],u=t.detail.raw[1],p=t.detail.raw[2],h=t.detail.raw[3];if(!e.is_loaded)return;if(1==e.cortona.NavigationBar&&h>e.cortona.offsetHeight-30)return;e._trigger(e.on_mouse_up,t.detail.raw),i(p,h,e._down_x,e._down_y)<e.MOUSE_MOVE_SENSITIVITY&&(e.tooltipOver3D.checkPointTooltip(p,h)?e._trigger(e.on_tooltip_click):e._onClick(e._skipAndPick(p,h),e._last_button,u,p,h));break;case"OnMouseOut":if(!e.is_loaded)return;e.reset()}},this.control.factory.events.forEach(function(t){e.cortona.addEventListener(t,e.defaultHandler,!1)}),console.log("Ipc3D API attached")}},IPCApi.prototype.detach=function(){if(this.defaultHandler){var e=this;this.control.factory.events.forEach(function(t){e.cortona.removeEventListener(t,e.defaultHandler,!1)}),delete this.defaultHandler,console.log("Ipc3D API detached")}},IPCApi.prototype._trigger=function(e,t){"function"==typeof e&&e.apply(this,t)},IPCApi.prototype._advise_control_script_events=function(){if(this.control_script)for(var e in this._control_script_handlers)this.control_script.Fields.Item(e).Advise(this._control_script_handlers[e],this)},IPCApi.prototype._unadvise_control_script_events=function(){if(this.control_script)for(var e in this._control_script_handlers)this.control_script.Fields.Item(e).Unadvise(this._control_script_handlers[e]);this._xEventScript&&(this._xEventScript.Fields.Item("outVal").Unadvise(this._onEventX),this._xEventScript=null)},IPCApi.prototype.reset=function(){try{clearTimeout(this._tooltip_timeout),this.ENABLE_TOOLTIPS&&this.tooltipOver3D.hide(),this.tooltipOver3D.setXY(0,0)}catch(e){}try{this.cortona.Engine.ClearSkipNodes()}catch(e){}this._last_x=0,this._last_y=0,this._last_button=-1,this._tooltip_timeout=null,this._trigger(this.on_reset)},IPCApi.prototype.load=function(e,t){IPCApi._api=this,this.data=t,this.cortona.Scene=e},IPCApi.prototype.loadMetadata=function(e){IPCApi._api=this,this.data=e},IPCApi.prototype.unload=function(){this.is_loaded=!1,this.cortona.Engine.RootNodes.Clear(),this.control_script=null,this.navigation_central=null,this.root_switch=null,this.axes_switch=null,this._skipNodes.length=0,this._lastOverObject=null,this.id_procedure="",this.id_step="",this.id_substep="",this.state=0,this.procedure_fraction=0,this.zoom_level=.5,this._transitions=new Array,this.IPCViewList.clear(),this.is_nonlinear_mode=!1,this._all_steps=null,this._active_steps=null,this.nodes={},this.allnodes={},this.IPCPartsArray=[],this.IPCParts={},this.tooltipOver3D.tooltip||(this.tooltipOver3D=new this.tooltipOver3D.constructor),this._trigger(this.on_simulation_unload)},IPCApi.prototype.getCurrentIPCView=function(){return this._view},IPCApi.prototype.setIPCView=function(e){if(this.is_loaded){if(this.show_background_geometry(),this.bgnodes=null,this.setAutoRefreshOff(),this.IPCViewList.exists(e)){var t=this.IPCViewList.get(e);t&&t.id?(this.control_script.Fields.Item("set_speed_ratio").Value=1e3,this.set_procedure(t.id,0),this.set_reverse(!1),this.control_script.Fields.Item("vcr_play").Value=0,this._view=e):(this._view=e,setTimeout(function(){IPCApi._api._trigger(IPCApi._api.on_view_changed,[e])},200))}this.restoreAutoRefresh()}},IPCApi.prototype.gotoIPCView=function(e){if(this.is_loaded){if(this.show_background_geometry(),this.bgnodes=null,this._transitions=this.IPCViewList.findPath(this._view,e),null==this._view||this._view==e||0==this._transitions.length)return void this.setIPCView(e);this.state!=this.PLAY&&(this._nextTransition()||this.setIPCView(e))}},IPCApi.prototype.resetIPCView=function(){},IPCApi.prototype._nextTransition=function(){if(this.is_loaded){if(this._transitions.length>0){var e=this._transitions.shift(),t=this._view;this._view=e.name,this.control_script.Fields.Item("set_speed_ratio").Value=this.TRANSITION_SPEED_RATIO,this.set_procedure(e.id,e.reverse?1:0),this.set_reverse(e.reverse);var i=this._view;t&&(1==this.VP_ORDER&&e.reverse||2==this.VP_ORDER&&!e.reverse)&&(i=t);var n=this.IPCViewList.get(i).viewpointsList,o=!1;return this.FREEZE_CAMERA_MODE?o=!0:n.length>0?(o=this.checkPosition(n[0]),this.setViewpoint(n[0])):this.fitToViewParts(3),setTimeout(function(){IPCApi._api.control_script.Fields.Item("vcr_play").Value=0},o?0:1700),!0}setTimeout(function(){IPCApi._api._trigger(IPCApi._api.on_view_changed,[IPCApi._api._view])},200)}return!1},IPCApi.prototype.hide_background_geometry=function(){if(this.is_loaded&&"undefined"!=typeof this.data.bgmedia&&0!=this.data.bgmedia.length){if(null==this.bgnodes){this.bgnodes={},this.bgnodes.hidden=!1,this.bgnodes.list=[];for(var e=0;e<this.data.bgmedia.length;e++){var t=this.cortona.Engine.Nodes.Item(this.data.bgmedia[e]).Fields.Item("whichChoice");t.Value>=0&&this.bgnodes.list.push(t)}}if(!this.bgnodes.hidden){this.bgnodes.hidden=!0,this.setAutoRefreshOff();for(var e=0;e<this.bgnodes.list.length;e++)this.bgnodes.list[e].Value=-1;this.restoreAutoRefresh(),this.doRefresh()}}},IPCApi.prototype.show_background_geometry=function(){if(this.is_loaded&&null!=this.bgnodes&&this.bgnodes.hidden){this.bgnodes.hidden=!1,this.setAutoRefreshOff();for(var e=0;e<this.bgnodes.list.length;e++)this.bgnodes.list[e].Value=0;this.restoreAutoRefresh(),this.doRefresh()}},IPCApi.prototype.set_ui_axis=function(e){this.is_loaded&&(this.control_script.Fields.Item("set_ui_axis").Value=new Boolean(e),null!=this.axes_switch&&(this.axes_switch.Fields.Item("whichChoice").Value=e?0:-1))},IPCApi.prototype.set_ui_zoom=function(e){this.is_loaded&&(this.control_script.Fields.Item("set_ui_zoom").Value=new Boolean(e))},IPCApi.prototype.set_ui_centerpoint=function(e){this.is_loaded&&(this.navigation_central.Fields.Item("CenterpointSwitch").Value=e?0:-1)},IPCApi.prototype.set_ui_revision=function(e){if(this.is_loaded&&null!=this.revision_switch){var t=this.revision_switch("children");if(t.Clear(),e){var i=this.cortona.Engine.CreateVrmlFromString('Panel{backgroundTransparency 0 source HTMLText{body "<font color=\\"#FF0000\\">R</font>"}}');t.Add(i.GetValue(0))}}},IPCApi.prototype.zoom_reset=function(){this.is_loaded&&(this.control_script.Fields.Item("zoom_reset").Value=0)},IPCApi.prototype.zoom_set_delta=function(e){this.is_loaded&&(this.control_script.Fields.Item("zoom_set_delta").Value=new Number(e))},IPCApi.prototype.zoom_set_level=function(e){this.is_loaded&&(this.control_script.Fields.Item("zoom_set_level").Value=new Number(e))},IPCApi.prototype._skipAndPick=function(e,t){function i(e){var t=null;if(e.Count>0)for(var i=e.Count-1;"Shape"==e.GetValue(i).TypeName&&i>=0;i--){t=e.GetValue(i);break}return t}var n=this.cortona.Engine;this._skipNodes.forEach(function(e){this.cortona.Engine.AddSkipNode(e)}),n.AddSkipNode(this.root_switch),null!=this.axes_switch&&n.AddSkipNode(this.axes_switch);var o=n.Pick(e,t);try{for(var r=i(o),s=1e3;s>0&&this.SKIP_TRANSPARENT_SHAPES&&r&&r.Fields.Item("appearance").Value.Fields.Item("material").Value.Fields.Item("transparency").Value>this.SKIP_TRANSPARENCY_THRESHOLD_LEVEL;)s--,n.AddSkipNode(r),o=n.Pick(e,t),r=i(o);return n.ClearSkipNodes(),o}catch(e){return n.ClearSkipNodes(),n.CreateField("MFNode")}},IPCApi.prototype._onOver=function(e){if(this.state==this.STOP){var t=this._getClickedIPCVrmlNode(this._getIPCVrmlNodeArray(e));t!=this._lastOverObject&&(this._trigger(this.on_part_over,[t]),this._lastOverObject=t,clearTimeout(this._tooltip_timeout),this.ENABLE_TOOLTIPS&&(this.tooltipOver3D.hide(),this._tooltip_timeout=setTimeout(function(){IPCApi._api.tooltipOver3D.show()},this.TOOLTIP_DELAY)))}},IPCApi.prototype._onClick=function(e,t,i,n,o){if(this.state==this.STOP){var r=this._getIPCVrmlNodeArray(e);if(1==t||2==t){var s=this._getClickedIPCVrmlNode(this._getIPCVrmlNodeArray(e));this._trigger(this.on_part_click,[s,t,i,n,o])}if((4&t||1&t&&4&i)&&r.length>0)if(1&i)this.setCenterpointToPart(r.pop());else{var a=this.cortona.Engine.PickedPoint,l=this._createFieldFromArray("SFVec3f",[a.X,a.Y,a.Z]);this.navigation_central.Fields.Item("set_centerpoint").Assign(l)}}},IPCApi.prototype.setViewpoint=function(e){this.navigation_central.Fields.Item("set_viewpoint").Value=e.node;var t=this.DEFAULT_MIN_ZOOM,i=this._calculateMaxZoom(2.1);if(/Viewpoint(\d|Ortho)/.test(e.node.TypeName))try{for(var n=e.node.Fields.Item("center"),o=this.cortona.Engine.CreateField("MFFloat"),r=0;r<3;r++)o.Add(this.navigation_central.Fields.Item("avatarSize").GetValue(r));o.Add(n.X),o.Add(n.Y),o.Add(n.Z),this.navigation_central.Fields.Item("avatarSize").Assign(o);var s=e.node.Fields.Item("position"),a=Math.sqrt((n.X-s.X)*(n.X-s.X)+(n.Y-s.Y)*(n.Y-s.Y)+(n.Z-s.Z)*(n.Z-s.Z));a>0&&a/2<this.DEFAULT_MIN_ZOOM&&(t=a/2),2*a>i&&(i=2*a)}catch(e){this.setCenterpointToViewParts()}else this.setCenterpointToViewParts();this._set_zoom_limits(t,i)},IPCApi.prototype.checkPosition=function(e){try{var t=this.cortona.Engine,i=t.CameraPosition.Translation,n=e.node.Fields.Item("position"),o=Math.sqrt((i.X-n.X)*(i.X-n.X)+(i.Y-n.Y)*(i.Y-n.Y)+(i.Z-n.Z)*(i.Z-n.Z)),r=Math.sqrt(i.X*i.X+i.Y*i.Y+i.Z*i.Z)/1e4;if(o<=r){var s=e.node.Fields.Item("orientation"),a=t.CreatePosition(t.CreateNodeFromString("Transform{rotation "+s.X+" "+s.Y+" "+s.Z+" "+s.Angle+"}")),l=a.Inverse().MultRight(t.CameraPosition).Rotation;if(l.Angle<.01)return!0}}catch(e){}return!1},IPCApi.prototype.activatePageViewpoint=function(){this._view&&this.setViewpoint(this.IPCViewList.get(this._view).viewpointsList[0])},IPCApi.prototype._fitToObject=function(e){if(this.is_loaded&&null!=e){var t=1,i="";arguments.length>1&&(t=arguments[1]),arguments.length>2&&(i=arguments[2]);var n=null,o=e,r=function(e){return e.slice(3).every(function(e){return 0==e})};try{switch(e.constructor){case Array:n=this._getNodesBoundBox(o);break;case IPCVrmlNode:n=e.getBBox();break;default:n=this._getSceneBBox()}}catch(e){}null==n||r(n)||this._fitToBoundBox(n,i,t)}},IPCApi.prototype._fitToBoundBox=function(e,t,i){if(!(!this.is_loaded||null==e||e.length<6||0==e[3]&&0==e[4]&&0==e[5])){var n=this.cortona.Engine,o=.75,r=Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5])*i/o;r<this.MIN_ZOOM_MINIMUM&&(r=this.MIN_ZOOM_MINIMUM);var s=r,a=this._calculateMaxZoom(2.1);a>2*r&&r>0&&(r*=1+this.ZOOM_CORRECTION_FACTOR*(.5-r/a)),a<2*r&&(a=2*r),s>this.MIN_ZOOM_MAXIMUM&&(s=this.MIN_ZOOM_MAXIMUM);var l=null;if(""!=t&&t in this.STANDARD_VIEWS)l=n.CreatePosition(n.CreateNodeFromString("Transform{rotation "+this.STANDARD_VIEWS[t]+"}"));else{var c=n.CameraPosition.Rotation;l=n.CreatePosition(n.CreateNodeFromString("Transform{rotation "+c.X+" "+c.Y+" "+c.Z+" "+c.Angle+"}"))}var d=l.Rotation,u=this._createFieldFromArray("SFVec3f",e),p=n.CreatePosition(n.CreateNodeFromString("Transform{translation "+u.X+" "+u.Y+" "+u.Z+"}"));this._assignValueFromArray(u,new Array(0,0,r));for(var h=p.MultVecMatrix(l.Inverse().MultMatrixVec(u)),f=this._createArrayFromField(h),m=this._createArrayFromField(d),u=n.CreateField("MFFloat"),v=0;v<3;v++)u.Add(this.navigation_central.Fields.Item("avatarSize").GetValue(v));for(var v=0;v<3;v++)u.Add(e[v]);this.navigation_central.Fields.Item("avatarSize").Assign(u);var _,g,C=/Ortho/.test(this.IPCViewList.get(this._view).viewpointsList[0].node.typeName);C?(g=r/1.5,_="OrthographicViewpoint { viewportSize "+g):_="Viewpoint {",_+=" position "+f.join(" ")+" orientation "+m.join(" ")+" }",this.navigation_central.Fields.Item("set_viewpoint").Value=n.CreateNodeFromString(_),this._set_zoom_limits(s,a)}},IPCApi.prototype._getNodesBoundBox=function(e){for(var t=null,i=function(e){return e.slice(3).every(function(e){return 0==e})},n=0;n<e.length&&(t=e[n].getBBox(),i(t));n++)t=null;for(var o=n+1;o<e.length;o++){var r=e[o].getBBox();if(!i(r)){var s=Math.min(t[0]-t[3]/2,r[0]-r[3]/2),a=Math.min(t[1]-t[4]/2,r[1]-r[4]/2),l=Math.min(t[2]-t[5]/2,r[2]-r[5]/2),c=Math.max(t[0]+t[3]/2,r[0]+r[3]/2),d=Math.max(t[1]+t[4]/2,r[1]+r[4]/2),u=Math.max(t[2]+t[5]/2,r[2]+r[5]/2);t[3]=c-s,t[4]=d-a,t[5]=u-l,t[0]=(c+s)/2,t[1]=(d+a)/2,t[2]=(u+l)/2}}return t},IPCApi.prototype.fitToScene=function(){if(this.is_loaded){var e=this._getSceneBBox(),t=1;arguments.length>0&&(t=arguments[0]),this._fitToBoundBox(e,"",t)}},IPCApi.prototype.fitToViewParts=function(){if(this._view){var e=new Array,t=this.IPCViewList.get(this._view);for(var i in t.nodesList)e.push(t.nodesList[i]);var n="",o=1;arguments.length>0&&(n=arguments[0]),arguments.length>1&&(o=arguments[1]);var r=e.length?this._getNodesBoundBox(e):this._getSceneBBox();this._fitToBoundBox(r,n,o)}},IPCApi.prototype.resetCenterpoint=function(){if(this.is_loaded){var e=this._getSceneBBox();this._assignValueFromArray(this.navigation_central.Fields.Item("set_centerpoint"),e)}},IPCApi.prototype._calculateMaxZoom=function(e){var t=0;if(this.is_loaded){var i=this._getSceneBBox(),n=.75;t=Math.sqrt(i[3]*i[3]+i[4]*i[4]+i[5]*i[5])*e/n,0==t&&(t=this.DEFAULT_MAX_ZOOM)}return t},IPCApi.prototype._getSceneBBox=function(){if(this.is_loaded){this.root_switch.Fields.Item("whichChoice").Value=-1;var e=!1;null!=this.axes_switch&&this.axes_switch.Fields.Item("whichChoice").Value>=0&&(e=!0,this.axes_switch.Fields.Item("whichChoice").Value=-1);var t=this._GetVRMLBBox_Array(this.cortona.Engine);return this.root_switch.Fields.Item("whichChoice").Value=0,e&&(this.axes_switch.Fields.Item("whichChoice").Value=0),t}return null},IPCApi.prototype.setCenterpointToPart=function(e){try{this._assignValueFromArray(this.navigation_central.Fields.Item("set_centerpoint"),e.getBBox())}catch(e){}},IPCApi.prototype._setSceneCenterpoint=function(e){!this.is_loaded||null==e||e.length<6||0==e[3]&&0==e[4]&&0==e[5]||this._assignValueFromArray(this.navigation_central.Fields.Item("set_centerpoint"),e)},IPCApi.prototype.fitToParts=function(e){for(var t=new Array,i=0;i<e.length;i++)t=t.concat(e[i].vrmlNodes);for(var n=new Array,o={},i=0;i<t.length;i++)0!=t[i].name.length&&t[i].name in o||(o[t[i].name]=!0,n.push(t[i]));var r=1,s="";arguments.length>1&&(s=arguments[1]),arguments.length>2&&(r=arguments[2]);var a=this._getNodesBoundBox(n);this._fitToBoundBox(a,s,r)},IPCApi.prototype.setCenterpointToParts=function(e){for(var t=new Array,i=0;i<e.length;i++)t=t.concat(e[i].vrmlNodes);for(var n=new Array,o={},i=0;i<t.length;i++)0!=t[i].name.length&&t[i].name in o||(o[t[i].name]=!0,n.push(t[i]));var r=this._getNodesBoundBox(n);this._setSceneCenterpoint(r)},IPCApi.prototype.setCenterpointToViewParts=function(){if(this._view){var e=new Array,t=this.IPCViewList.get(this._view);for(var i in t.nodesList)e.push(t.nodesList[i]);var n=this._getNodesBoundBox(e);if(null==n||n.length<6||0==n[3]&&0==n[4]&&0==n[5])return;for(var o=this.cortona.Engine.CreateField("MFFloat"),r=0;r<3;r++)o.Add(this.navigation_central.Fields.Item("avatarSize").GetValue(r));for(var r=0;r<3;r++)o.Add(n[r]);this.navigation_central.Fields.Item("avatarSize").Assign(o)}},IPCApi.prototype.prepareIPCParts=function(e){for(var t=0;t<e.length;t++){var i=new IPCPart(e[t].vrmlnodes,t);this.IPCPartsArray.push(i),this.IPCParts[e[t].id]=i}},IPCApi.prototype.getIPCPart=function(e){return e in this.IPCParts?this.IPCParts[e]:null},IPCApi.prototype.getIPCPartByIndex=function(e){return this.IPCPartsArray[e]},IPCApi.prototype.getVrmlNode=function(e){if(!(e in this.nodes)){var t=this.cortona.Engine.Nodes.Item(e);if("ObjectVM"!=t.TypeName)return null;this.nodes[e]=this._createVrmlNode(t,e)}return this.nodes[e]},IPCApi.prototype._createVrmlNode=function(e,t){if(""==t)return new IPCVrmlNode(e);if(!(t in this.allnodes))try{this.allnodes[t]=new IPCVrmlNode(e,t)}catch(e){this.allnodes[t]=null}return this.allnodes[t]},IPCApi.prototype.clearAllCallouts=function(){null!=this.callouts_group&&this.callouts_group.Fields.Item("children").Clear()},IPCApi.prototype.initialize_nonlinear_mode=function(){if(this.is_loaded&&!this.is_nonlinear_mode){this.is_nonlinear_mode=!0;var e=this.cortona.Engine,t=this.control_script.Fields.Item("procedure").Value;this._all_steps=t.Fields.Item("steps");var i=e.CreateProtoFromString('PROTO _AC9F503D-A7CE-470b-A636-264433E4A204 [field SFString title "" field SFString comment "" exposedField SFString id "" exposedField MFNode steps []]{Group{children IS steps}}').CreateInstance();this._active_steps=i.Fields.Item("steps"),i.Fields.Item("id").Assign(t.Fields.Item("id")),i.Fields.Item("title").Assign(t.Fields.Item("title"));try{i.Fields.Item("comment").Assign(t.Fields.Item("comment"))}catch(e){}i.Fields.Item("steps").Assign(t.Fields.Item("steps")),this.control_script.Fields.Item("procedure").Value=i}},IPCApi.prototype.set_procedure=function(e,t){if(this.is_loaded&&this.is_nonlinear_mode){if(this.control_script.Fields.Item("vcr_pause").Value=0,this._active_steps.Clear(),"string"==typeof e)this._add_animation_step(e);else for(var i=0;i<e.length;i++)this._add_animation_step(e[i]);if(this._active_steps.Count>0){var n=0;if("undefined"!=typeof t)try{1==t&&(n=1)}catch(e){n=0}return 0==n?this._preset_to_start():this._preset_to_end(),1}}return 0},IPCApi.prototype.reset_procedure=function(){this.is_loaded&&this.is_nonlinear_mode&&this._active_steps.Assign(this._all_steps)},IPCApi.prototype.jump_to_start=function(){this.control_script.Fields.Item("vcr_set_proc_fraction").Value=0},IPCApi.prototype.jump_to_end=function(){this.control_script.Fields.Item("vcr_set_proc_fraction").Value=1},IPCApi.prototype._preset_to=function(e,t,i){var n=this.cortona.Engine.CreateField("MFFloat");n.Add(e),n.Add(t),n.Add(i);var o=-1;try{o=this.control_script.Fields.Item("now_step_substep_fraction").Category}catch(e){}o>0?this.control_script.Fields.Item("now_step_substep_fraction").Assign(n):(this.control_script.Fields.Item("ControlScript").Value.Fields.Item("reinitialize_substep").Value=0,this.control_script.Fields.Item("ControlScript").Value.Fields.Item("oldstep").Value=e,this.control_script.Fields.Item("ControlScript").Value.Fields.Item("oldsubstep").Value=t,this.control_script.Fields.Item("ControlScript").Value.Fields.Item("set_step_substep_fraction").Assign(n))},IPCApi.prototype._preset_to_start=function(){this.is_nonlinear_mode&&this._active_steps.Count>0&&this._preset_to(0,0,0)},IPCApi.prototype._preset_to_end=function(){if(this.is_nonlinear_mode&&this._active_steps.Count>0){var e=this._active_steps.Count-1,t=this._active_steps.GetValue(e).Fields.Item("substeps").Count-1;this._preset_to(e,t,1)}},IPCApi.prototype._add_animation_step=function(e){if(this.is_nonlinear_mode){for(var t=0;t<this._all_steps.Count;t++)if(this._all_steps.GetValue(t).Fields.Item("id").Value==e)return void this._active_steps.Add(this._all_steps.GetValue(t));alert("WARNING:\r\n\r\nAnimation with ID - "+e+" - not found.")}},IPCApi.prototype.set_reverse=function(e){this.is_loaded&&(this.control_script.Fields.Item("sim_reverse").Value=e)},IPCApi.prototype.set_axes_file=function(e){this._axes_file=e,this.is_loaded&&(""==this._axes_file?this.control_script.Fields.Item("externalAxes").Clear():this.control_script.Fields.Item("externalAxes").Add(this.cortona.Engine.CreateVrmlFromString('Inline{url "'+e+'"}')))},IPCApi.prototype._set_zoom_limits=function(e,t){if(this.is_loaded)try{this.control_script.Fields.Item("setMinZoom").Value=e,this.control_script.Fields.Item("setMaxZoom").Value=t;var i=this.cortona.Engine;i.Nodes.Item("_SKIN_INFO").Fields.Item("info").SetValue(3,"limits="+e+","+t)}catch(e){}},IPCApi.prototype._createFieldFromArray=function(e,t){var i=null;try{switch(i=this.cortona.Engine.CreateField(e),i.Type){case 211:case 209:i.Value=t[0];break;case 215:case 207:case 205:i.Value=new Number(t[0]);break;case 202:i.Value=new Boolean(t[0]);break;case 203:i.Red=new Number(t[0]),i.Green=new Number(t[1]),i.Blue=new Number(t[2]);break;case 206:break;case 210:i.Angle=new Number(t[3]);case 213:i.Z=new Number(t[2]);case 212:i.Y=new Number(t[1]),i.X=new Number(t[0])}}catch(e){}return i},IPCApi.prototype._createArrayFromField=function(e){var t=[];switch(e.Type){case 211:case 209:case 215:case 207:case 205:case 202:t=[e.Value];break;case 203:t=[e.Red,e.Green,e.Blue];break;case 206:break;case 210:t=[e.X,e.Y,e.Z,e.Angle];break;case 213:t=[e.X,e.Y,e.Z];break;case 212:t=[e.X,e.Y]}return t},IPCApi.prototype._assignValueFromArray=function(e,t){e.Assign(this._createFieldFromArray(e.TypeName,t))},IPCApi.prototype._getClickedIPCVrmlNode=function(e){for(var t=e.length-1;t>=0;t--){var i=e[t].node.Name;if(""!=i&&i in this.nodes)return this.nodes[i];if(this.NO_DPL)return this.getVrmlNode(i)}return null},IPCApi.prototype._getIPCVrmlNodeArray=function(e){for(var t=new Array,i=0;i<e.Count;i++)if("ObjectVM"==e.GetValue(i).TypeName){var n=this._createVrmlNode(e.GetValue(i),e.GetValue(i).Name);t.push(n)}return t},IPCApi.prototype.setNavigationStyle=function(e){"goto"==e?this.is_set_center_mode=!0:this.cortona.NavigationStyle=e},IPCApi.prototype.getNavigationStyle=function(){return this.is_set_center_mode?"goto":this.cortona.NavigationStyle},IPCApi.prototype.setCortonaSkin=function(e){this._default_skin=e,this.is_loaded&&(this.cortona.Skin=this._default_skin)},IPCApi.prototype.enableNavigation=function(e){this.cortona.InputDevices=e?255:0},IPCApi.prototype.showCortonaProperties=function(){this.cortona.uiAction("preferences")},IPCApi.prototype.setAutoRefreshOff=function(){this.autorefreshstack.push(this.cortona.Engine.AutoRefresh),0!=this.cortona.Engine.AutoRefresh&&(this.cortona.Engine.AutoRefresh=0)},IPCApi.prototype.restoreAutoRefresh=function(){var e=this.autorefreshstack.length>0?this.autorefreshstack.pop():1;this.cortona.Engine.AutoRefresh!=e&&(this.cortona.Engine.AutoRefresh=e),0!=this.ATP&&0!=e&&this.evalOnEventX("1")},IPCApi.prototype.doRefresh=function(){0==this.cortona.Engine.AutoRefresh&&(this.cortona.Refresh(),0!=this.ATP&&this.evalOnEventX("1"))},IPCApi.prototype.setAutoRefreshOn=function(){this.autorefreshstack=[],this.cortona.Engine.AutoRefresh=1,this.evalOnEventX("1")},IPCApi.prototype.evalOnEventX=function(e){this._xEventScript&&(this._xEventScript.Fields.Item("inVal").Value=e)},IPCApi.prototype._onEventX=function(value,hint,timeStamp){var self=IPCApi._api;if("1"==value.Value){for(var xDCP=self._xProcessedParts,engine=self.cortona.Engine,emsNodes=null,dcNodes=null,trnsNodes=null,i=0;i<xDCP.length;i++){var nds=xDCP[i][1].vrmlNodes;if(0==xDCP[i][0])nds.forEach(function(e){e.restoreMaterial(!0)});else if(1==xDCP[i][0])nds.forEach(function(e){e.resetMaterial(!0)});else if(2==xDCP[i][0]){emsNodes||(emsNodes=engine.CreateField("MFNode"),emsNodes.Add(engine.CreateNodeFromString("Material{emissiveColor "+xDCP[i][2].join(" ")+"}")));for(var j=0;j<nds.length;j++)emsNodes.Add(nds[j].node)}else if(3==xDCP[i][0]){nds.forEach(function(e){e.saveMaterial(!0)}),dcNodes||(dcNodes=engine.CreateField("MFNode"),dcNodes.Add(engine.CreateNodeFromString("Material{diffuseColor "+xDCP[i][2].join(" ")+"}")));for(var j=0;j<nds.length;j++)dcNodes.Add(nds[j].node)}else if(4==xDCP[i][0]){nds.forEach(function(e){e.saveMaterial(!0)}),trnsNodes||(trnsNodes=engine.CreateField("MFNode"),trnsNodes.Add(engine.CreateNodeFromString("Material{transparency "+xDCP[i][2]+"}")));for(var j=0;j<nds.length;j++)trnsNodes.Add(nds[j].node)}else 5==xDCP[i][0]?nds.forEach(new Function("n","n.show("+xDCP[i][2]+");")):6==xDCP[i][0]&&nds.forEach(new Function("n","n.filter("+xDCP[i][2]+");"))}self._xProcessedParts=[],emsNodes&&self._xEventScript.Fields.Item("emsNodes").Assign(emsNodes),dcNodes&&self._xEventScript.Fields.Item("dcNodes").Assign(dcNodes),trnsNodes&&self._xEventScript.Fields.Item("trnsNodes").Assign(trnsNodes)}else eval(""+value.Value)},IPCApi.prototype.checkCortonaComponent=function(){try{return this.cortona.uiAction("revokePropPage:{E5711FD5-464F-11D3-9D7D-00A0247A5F3F}"),!0}catch(e){return!1}},IPCApi.prototype.getCortonaVersion=function(){return this.cortona.Version||"6"},IPCApi.prototype.print3D=function(){var e,t=this.cortona.Engine;try{e=t.Nodes.Item("CORTONA_CARBONCOPIER")}catch(i){e=t.CreateVrmlFromString(this.COPIER_SYNTAX),t.RootNodes.Add(e)}try{t.Nodes.Item("CORTONA_CARBONCOPIER").Fields.Item("print").Value=!0}catch(e){}},IPCApi.prototype.openPrintPageSetup=function(){var e,t=this.cortona.Engine;try{e=t.Nodes.Item("CORTONA_CARBONCOPIER")}catch(i){e=t.CreateVrmlFromString(this.COPIER_SYNTAX),t.RootNodes.Add(e)}try{t.Nodes.Item("CORTONA_CARBONCOPIER").Fields.Item("pageSetup").Value=!0}catch(e){}},IPCApi.prototype.setPrintHeaderStyle=function(e){this._copier_field_set_string_array("headerStyle",e)},IPCApi.prototype.setPrintFooterStyle=function(e){this._copier_field_set_string_array("footerStyle",e)},IPCApi.prototype.setPrintHeader=function(e){this._copier_field_set_string("headerText",e)},IPCApi.prototype.setPrintFooter=function(e){this._copier_field_set_string("footerText",e)},IPCApi.prototype._copier_field_set_string=function(e,t){var i,n=this.cortona.Engine;try{i=n.Nodes.Item("CORTONA_CARBONCOPIER")}catch(e){i=n.CreateVrmlFromString(this.COPIER_SYNTAX),n.RootNodes.Add(i)}try{n.Nodes.Item("CORTONA_CARBONCOPIER").Fields.Item(e).Value=t}catch(e){}},IPCApi.prototype._copier_field_set_string_array=function(e,t){var i,n=this.cortona.Engine;try{i=n.Nodes.Item("CORTONA_CARBONCOPIER")}catch(e){i=n.CreateVrmlFromString(this.COPIER_SYNTAX),n.RootNodes.Add(i)}for(var o=n.CreateField("MFString"),r=0;r<t.length;o.Add(t[r++]));try{n.Nodes.Item("CORTONA_CARBONCOPIER").Fields.Item(e).Assign(o)}catch(e){}},IPCApi.prototype.checkPrintComponent=function(){var e=!1;try{void new ActiveXObject("CarbonCopy.CopierX"),e=!0}catch(e){}return e},IPCApi.prototype._GetVRMLBBox_Array=function(e){var t=e.BBoxCenter,i=e.BBoxSize;return[t.X,t.Y,t.Z,i.X,i.Y,i.Z]},IPCPart.prototype.restoreVrmlNodesMaterial=function(){0==IPCApi._api.ATP?this.vrmlNodes.forEach(function(e){e.restoreMaterial(!0)}):IPCApi._api._xProcessedParts.push([0,this])},IPCPart.prototype.resetVrmlNodesMaterial=function(){0==IPCApi._api.ATP?this.vrmlNodes.forEach(function(e){e.resetMaterial(!0)}):IPCApi._api._xProcessedParts.push([1,this])},IPCPart.prototype.setEmissiveColor=function(e){0==IPCApi._api.ATP?this.vrmlNodes.forEach(function(t){t.setEmissiveColor.apply(t,e)}):IPCApi._api._xProcessedParts.push([2,this,e])},IPCPart.prototype.setDiffuseColor=function(e){0==IPCApi._api.ATP?this.vrmlNodes.forEach(function(t){t.saveMaterial(!0),t.setDiffuseColor.apply(t,e)}):IPCApi._api._xProcessedParts.push([3,this,e])},IPCPart.prototype.setTransparency=function(e){0==IPCApi._api.ATP?this.vrmlNodes.forEach(function(t){t.saveMaterial(!0),t.setTransparency(e)}):IPCApi._api._xProcessedParts.push([4,this,e])},IPCPart.prototype.getTransparency=function(){for(var e=0;e<this.vrmlNodes.length;e++)if(1!=this.vrmlNodes[0].getTransparency())return this.vrmlNodes[0].getTransparency();return 0},IPCPart.prototype.show=function(e){0==IPCApi._api.ATP?this.vrmlNodes.forEach(function(t){t.show(e)}):IPCApi._api._xProcessedParts.push([5,this,e])},IPCPart.prototype.filter=function(e){0==IPCApi._api.ATP?this.vrmlNodes.forEach(function(t){t.filter(e)}):IPCApi._api._xProcessedParts.push([6,this,e])},IPCPart.prototype.fit=function(){var e=1,t="";arguments.length>0&&(t=arguments[0]),arguments.length>1&&(e=arguments[1]);
var i=IPCApi._api._getNodesBoundBox(this.vrmlNodes);IPCApi._api._fitToBoundBox(i,t,e)},IPCPart.prototype.setCenterpoint=function(){var e=1,t="";arguments.length>0&&(t=arguments[0]),arguments.length>1&&(e=arguments[1]);var i=IPCApi._api._getNodesBoundBox(this.vrmlNodes);IPCApi._api._setSceneCenterpoint(i)},IPCPart.prototype.getVisibility=function(){return this.vrmlNodes.some(function(e){return e.getVisibility()})},IPCPart.prototype.checkFullTransparency=function(){return this.vrmlNodes.every(function(e){return e.isHidden()})},IPCVrmlNodeMaterial.prototype.resetDiffuseColor=function(){if(IPCApi._api._assignValueFromArray(this.materialnode.Fields.Item("diffuseColor"),this.diffuseColor),null!=this.colorfield)for(var e=0;e<this.colorfield.Count;e++)try{this.colorfield.SetValue(e,this.nodecolors[e])}catch(e){}},IPCVrmlNodeMaterial.prototype.resetMaterial=function(){this.resetDiffuseColor(),this.materialnode.Fields.Item("transparency").Value=this.transparency};var _processed_Vrml_Nodes={};IPCVrmlNode.prototype.isEqual=function(e){var t=!1;try{t=e.constructor==IPCVrmlNode&&e.node==this.node}catch(e){}return t},IPCVrmlNode.prototype.getBBox=function(){for(var e=IPCApi._api._GetVRMLBBox_Array(this.node),t=IPCApi._api.cortona.Engine,i=t.CreatePosition(null),n=IPCApi._api._createFieldFromArray("SFVec3f",new Array(e[0]-e[3]/2,e[1]-e[4]/2,e[2]-e[5]/2)),o=IPCApi._api._createFieldFromArray("SFVec3f",new Array(e[0]+e[3]/2,e[1]+e[4]/2,e[2]+e[5]/2)),r=this.node.Fields.Item("_parent_").Value;null!=r;r=r.Fields.Item("_parent_").Value){if(r.Fields.Item("whichChoice").Value<0)return new Array(0,0,0,0,0,0);i.SetTransform(r),n=i.MultVecMatrix(n),o=i.MultVecMatrix(o)}return n=IPCApi._api._createArrayFromField(n),o=IPCApi._api._createArrayFromField(o),e=new Array((n[0]+o[0])/2,(n[1]+o[1])/2,(n[2]+o[2])/2,Math.abs(o[0]-n[0]),Math.abs(o[1]-n[1]),Math.abs(o[2]-n[2]))},IPCVrmlNode.prototype.setEmissiveColor=function(e,t,i){IPCApi._api._assignValueFromArray(this.node.Fields.Item("appearance").Value.Fields.Item("material").Value.Fields.Item("emissiveColor"),arguments)},IPCVrmlNode.prototype.setDiffuseColor=function(e,t,i){function n(e,t){try{var i=e.Fields.Item("currentRepresentation").Value;if(i>=0&&e.Fields.Item("representations").Count>i){var n=e.Fields.Item("representations").GetValue(i).Fields.Item("geometry").Value;if("IndexedFaceSet"==n.TypeName){var o=n.Fields.Item("color").Value;if(o)for(var r=o.Fields.Item("color"),s=0;s<r.Count;s++)r.SetValue(s,t)}}}catch(e){}}var o=IPCApi._api.cortona.Engine.CreateField("SFColor");o.Red=new Number(e),o.Green=new Number(t),o.Blue=new Number(i),n(this.node,o),IPCApi._api._assignValueFromArray(this.node.Fields.Item("appearance").Value.Fields.Item("material").Value.Fields.Item("diffuseColor"),arguments);for(var r=this.getAllChildren(),s=0;s<r.length;s++)IPCApi._api._assignValueFromArray(r[s].node.Fields.Item("appearance").Value.Fields.Item("material").Value.Fields.Item("diffuseColor"),arguments),n(r[s].node,o)},IPCVrmlNode.prototype.show=function(e){this.show_flag=e,this.filter_flag||(this.node.Fields.Item("whichChoice").Value=e?0:-1)},IPCVrmlNode.prototype.filter=function(e){this.filter_flag=e,this.node.Fields.Item("whichChoice").Value=this.show_flag&&!e?0:-1},IPCVrmlNode.prototype.setTransparency=function(e){if(1!=e){1!=this.getTransparency()&&IPCApi._api._assignValueFromArray(this.node.Fields.Item("appearance").Value.Fields.Item("material").Value.Fields.Item("transparency"),arguments);for(var t=this.getAllChildren(),i=0;i<t.length;i++)1!=t[i].node.Fields.Item("appearance").Value.Fields.Item("material").Value.Fields.Item("transparency").Value&&IPCApi._api._assignValueFromArray(t[i].node.Fields.Item("appearance").Value.Fields.Item("material").Value.Fields.Item("transparency"),arguments)}},IPCVrmlNode.prototype.getTransparency=function(){return this.node.Fields.Item("appearance").Value.Fields.Item("material").Value.Fields.Item("transparency").Value},IPCVrmlNode.prototype.getVisibility=function(){if(this.getSwitchState()){if(!this.parentsNodes){this.parentsNodes=new Array;for(var e=this.node.Fields.Item("_parent_").Value;null!=e;)this.parentsNodes.push(e),e=e.Fields.Item("_parent_").Value}for(var t=0;t<this.parentsNodes.length;t++)if(this.parentsNodes[t].Fields.Item("whichChoice").Value<0)return!1;if(this.hasGeometry()&&!this.checkFullTransparency())return!0;this.getAllChildren();for(var t=0;t<this.children.length;t++)if(this.children[t].getVisibility())return!0}return!1},IPCVrmlNode.prototype.getSwitchState=function(){return this.node.Fields.Item("whichChoice").Value>=0},IPCVrmlNode.prototype.checkFullTransparency=function(){return 1==this.node.Fields.Item("appearance").Value.Fields.Item("material").Value.Fields.Item("transparency").Value},IPCVrmlNode.prototype.hasGeometry=function(){return this.node.Fields.Item("representations").Count>0},IPCVrmlNode.prototype.isHidden=function(){return(!this.hasGeometry()||this.checkFullTransparency())&&this.getAllChildren().every(function(e){return!e.hasGeometry()||e.checkFullTransparency()})},IPCVrmlNode.prototype.getAllChildren=function(){if(!this.allChildren){""!=this.name&&(_processed_Vrml_Nodes[this.name]=this),this.children=new Array;for(var e=this.node.Fields.Item("children"),t=0;t<e.Count;t++){var i=e.GetValue(t).Name;""!=i&&i in _processed_Vrml_Nodes?this.children.push(_processed_Vrml_Nodes[i]):"ObjectVM"==e.GetValue(t).TypeName&&this.children.push(IPCApi._api._createVrmlNode(e.GetValue(t),i))}this.allChildren=this.children;for(var t=0;t<this.children.length;t++)this.allChildren=this.allChildren.concat(this.children[t].getAllChildren())}return this.allChildren},IPCVrmlNode.prototype.getParentsNames=function(){this.parents=new Array,this.parentsNames=new Array;for(var e=this.node.Fields.Item("_parent_").Value;null!=e;)this.parents.push(e),this.parentsNames.push(e.Name),e=e.Fields.Item("_parent_").Value;return this.parentsNames},IPCVrmlNode.prototype.saveMaterial=function(e){if(this._materialSaved||(this.vrmlMaterial=new IPCVrmlNodeMaterial(this.node.Fields.Item("appearance").Value.Fields.Item("material").Value,this.node),this._materialSaved=!0),e){var t=this.getAllChildren();t.forEach(function(e){e.saveMaterial(!1)})}},IPCVrmlNode.prototype.restoreMaterial=function(e){if(this._materialSaved&&this.vrmlMaterial.resetDiffuseColor(),e){var t=this.getAllChildren();t.forEach(function(e){e.restoreMaterial(!1)})}},IPCVrmlNode.prototype.resetMaterial=function(e){if(this._materialSaved&&(this.vrmlMaterial.resetMaterial(),this._materialSaved=!1),e){var t=this.getAllChildren();t.forEach(function(e){e.resetMaterial(!1)})}},IPCViews.prototype.clear=function(){this.array={}},IPCViews.prototype.add=function(e){this.array[e.name]=e},IPCViews.prototype.remove=function(e){delete this.array[e.name]},IPCViews.prototype.get=function(e){return this.array[e]},IPCViews.prototype.exists=function(e){return"undefined"!=typeof this.array[e]},IPCViews.prototype.findPath=function(e,t){var i=new Array,n={};for(var o in this.array)n[o]=-1;n[e]=0;for(var r=!1,s=0,a=new Array(e),l=new Array;!r;a=l,l=new Array,s++){for(var c=0;c<a.length;c++)for(var d in this.array[a[c]].transitionsList)n[d]<0&&(n[d]=s+1,l.push(d),d==t&&(r=!0));if(0==l.length)return i}for(var u=t;u!=e;){var p=n[u]-1,r=!1;for(var d in this.array){for(var h in this.array[d].transitionsList)if(h==u&&n[d]==p){u=d,i.push(this.array[d].transitionsList[h]),r=!0;break}if(r)break}}return i.reverse(),i},IPCViews.prototype.loadFromData=function(e,t){var i=IPCApi._api.cortona.Engine,n=null;this.clear();for(var o=e,r=0;r<o.length;r++){for(var s={},a=o[r].transitions,l=0;l<a.length;l++)s[a[l].id]=new IPCTransition(a[l].stepid,a[l].id,new Array,!1);for(var c={},d=o[r].items,l=0;l<d.length;l++)if(""!=d[l]){var u=IPCApi._api.getIPCPart(d[l]);if(null!=u)for(var p=0;p<u.vrmlNodes.length;p++)c[d[l]+"_"+p]=u.vrmlNodes[p]}var h=o[r].stepid,f=o[r].id,m=o[r].description,v=0,_=new Array;try{var d=o[r].viewpoint;_.push(new IPCViewpoint(d.name,i.Nodes.Item(d.vrmlnode)))}catch(e){}var g=new IPCView(h,f,m,v,c,s,_);this.add(g),null!=n||o[r].hidden||(n=g)}if(null==n)return void alert("Error: There are no IPC sheets in project.");this.initialViewName=n.name,IPCApi._api.initialViewName=this.initialViewName;for(var C in this.array){var g=this.array[C];for(var I in g.transitionsList)if(this.exists(I)){var y=this.get(I);"undefined"==typeof y.transitionsList[g.name]&&(y.transitionsList[g.name]=new IPCTransition(g.transitionsList[I].id,g.name,new Array,!0))}}},IPCView.prototype.getTransitionViewForTrigger=function(e){for(var t in this.transitionsList)for(var i=this.transitionsList[t].triggersArray,n=0;n<i.length;n++)if(i[n].isEqual(e))return IPCApi._api.IPCViewList.get(t);return null},IPCView.prototype.getTriggersList=function(){var e=new Array;for(var t in this.transitionsList)e=e.concat(this.transitionsList[t].triggersArray);return e},Callout3D.prototype.show=function(){if(!this.visible){var e=IPCApi._api.cortona.Engine;null==IPCApi._api.callouts_group&&(IPCApi._api.callouts_group=e.CreateVrmlFromString("ZGroup{check FALSE}").GetValue(0),e.RootNodes.Add(IPCApi._api.callouts_group));var t=this.point1.X+" "+this.point1.Y+" "+this.point1.Z,i=this.point2.X+" "+this.point2.Y+" "+this.point2.Z,n='Callout3D{id "'+this.id+'" p1 '+t+" p2 "+i+" point ["+t+", "+i+']body "<font face=\\"Courier, monospace\\" size=\\"'+IPCApi._api.CALLOUT_FONT_SIZE+'\\" color=\\"#000000\\">'+this.text+'</font>" color '+IPCApi._api.CALLOUT_COLOR[0]+" "+IPCApi._api.CALLOUT_COLOR[1]+" "+IPCApi._api.CALLOUT_COLOR[2]+"}";this.node=e.CreateVrmlFromString(IPCApi._api.CALLOUT_PROTO+n).GetValue(0),IPCApi._api.callouts_group.Fields.Item("children").Add(this.node),this.visible=!0}},Callout3D.prototype.setPoint1=function(e,t){var i=IPCApi._api.cortona.Engine;this.point1=i.GetProjectedPoint(e,t,"1"),this.visible&&(this.hide(),this.show())},Callout3D.prototype.setPoint2=function(e,t){var i=IPCApi._api.cortona.Engine;this.point2=i.GetProjectedPoint(e,t,"1"),this.visible&&(this.hide(),this.show())},Callout3D.prototype.setText=function(e){this.text=e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"'),this.visible&&(this.hide(),this.show())},Callout3D.prototype.hide=function(){if(this.visible){for(var e=IPCApi._api.callouts_group.Fields.Item("children"),t=0;t<e.Count;t++)if(e.GetValue(t).Fields.Item("id").Value==this.id){try{e.Remove(t)}catch(e){}break}this.node=null,this.visible=!1}},module.exports={IPCApi:IPCApi,Callout3D:Callout3D}},function(e,t){e.exports=' PROTO Callout3D [ exposedField SFString id "" exposedField SFColor color 0 0 0 exposedField SFColor backgroundColor 1 1 1 exposedField MFVec3f point [0 0 0, 0 0 0] exposedField SFVec3f p1 0 0 0 exposedField SFVec3f p2 0 0 0 exposedField SFString body "" ] { Group { children [ Shape { appearance Appearance { material Material { diffuseColor 0 0 0 emissiveColor IS color } } geometry IndexedLineSet { coord DEF Crd Coordinate { point IS point } coordIndex [0 1 -1] } } DEF TR Transform { center IS p1 translation IS p2 children [ Panel { source HTMLText { body IS body padding [2, 2, 2, 2] } sticky TRUE backgroundTransparency 0 backgroundColor IS backgroundColor offsetTop "7" offsetLeft "7" borderColor IS color borderSize 1 } ] } ] } '},function(e,t){e.exports=' PROTO IPCSimulation [ eventIn SFFloat setMinZoom eventIn SFFloat setMaxZoom eventOut SFNode ControlScript exposedField SFNode procedure NULL exposedField SFInt32 whichChoice 0 exposedField MFNode externalAxes [] eventIn SFBool set_ui_smoothcontrol eventIn SFBool set_ui_axis eventIn SFBool set_ui_zoom eventIn SFBool set_ui_vcr eventIn SFTime vcr_play eventIn SFTime vcr_stop eventIn SFTime vcr_pause eventIn SFTime vcr_forward eventIn SFTime vcr_backward eventIn SFTime vcr_next eventIn SFTime vcr_previous eventIn SFString vcr_goto eventIn SFString vcr_set_position eventIn SFFloat vcr_set_fraction eventIn SFFloat set_speed_ratio eventIn SFBool set_stop_by_substep eventIn SFBool set_stop_by_step eventIn SFTime zoom_reset eventIn SFFloat zoom_set_delta eventIn SFFloat zoom_set_level eventIn SFFloat vcr_set_proc_fraction eventIn SFFloat vcr_set_step_fraction eventIn SFFloat set_substep_fraction eventIn SFFloat set_procedure_fraction eventIn SFFloat set_step_fraction eventIn MFFloat now_step_substep_fraction eventIn SFBool set_ignore_viewpoints eventOut MFString on_start_substep eventOut MFString on_start_new_substep eventOut MFString on_event_out eventOut SFInt32 on_vcr_state eventOut SFFloat on_zoom_changed eventOut SFFloat on_proc_fraction_changed eventOut SFFloat on_substep_fraction_changed eventOut SFFloat on_step_fraction_changed eventIn SFTime reinitialize eventIn SFTime reinitialize_step eventIn SFTime reinitialize_substep field SFInt32 oldsubstep 0 field SFInt32 oldstep 0 eventIn SFVec3f set_centerpoint eventIn SFNode set_object eventIn SFNode set_viewpoint exposedField MFFloat avatarSize [0.25,1.6,0.75,0,0,0] exposedField SFInt32 CenterpointSwitch 0 eventIn SFBool sim_reverse eventIn MFFloat set_step_substep_fraction ] { PROTO Viewpoint3 [ field SFInt32 orthographic 0 field SFString description "" exposedField SFVec3f position 0 0 10 exposedField SFRotation orientation 0 0 1 0 exposedField SFFloat fieldOfView 0.785398 exposedField SFVec3f center 0 0 0 exposedField SFBool jump TRUE eventIn SFBool set_bind eventOut SFBool isBound eventOut SFTime bindTime ] { DEF SW Switch { choice [ Viewpoint { fieldOfView IS fieldOfView jump IS jump orientation IS orientation position IS position description IS description bindTime IS bindTime isBound IS isBound } OrthographicViewpoint { jump IS jump orientation IS orientation position IS position viewportSize IS fieldOfView description IS description bindTime IS bindTime isBound IS isBound } ] whichChoice IS orthographic } Script { url "javascript: function set_bind(val) { if (orthographic == 0 || orthographic == 1) sw.choice[orthographic].set_bind = val; } " directOutput TRUE eventIn SFBool set_bind IS set_bind field SFInt32 orthographic IS orthographic field SFNode sw USE SW } } PROTO protoSFNode [ exposedField SFNode _ NULL ] { Group {} } PROTO _ViewPoint [ eventOut SFTime bindTime field SFString description "" exposedField SFFloat fieldOfView 0.785398 eventOut SFBool isBound exposedField SFBool jump TRUE exposedField SFRotation orientation 0 0 1 0 exposedField SFVec3f position 0 0 10 eventIn SFBool set_bind ] { Group {} } PROTO _navigation_central [ exposedField MFFloat avatarSize [0.25,1.6,0.75] exposedField SFVec3f position 0 0 0 exposedField SFVec3f position2 0 0 0 exposedField SFRotation orientation 1 0 0 1.40877 eventIn SFVec3f set_centerpoint eventIn SFNode set_object eventIn SFNode set_viewpoint exposedField SFInt32 CenterpointSwitch -1 exposedField SFBool jump FALSE exposedField SFVec3f centerpoint 0 0 0 ] { PROTO _ [ exposedField SFVec3f centerpoint 0 0 0 ] { Group {} } Group { children [ Switch { choice [ DEF TR Transform { children [ Group { children [ Shape { appearance Appearance { material Material { emissiveColor 1 1 0 } } geometry IndexedLineSet { coord Coordinate { point [-1 0 0,1 0 0,0 -1 0,0 1 0,0 0 -1,0 0 1] } coordIndex [0,1,-1,2,3,-1,4,5,-1] } } Shape { appearance Appearance { material Material { ambientIntensity 0.08 diffuseColor 0.6 0.17 0.21 emissiveColor 0.09 0.02 0.03 shininess 0.48 specularColor 0.82 0.23 0.23 transparency 0.3 } } geometry Sphere { radius 0.01 } } ] } ] } ] whichChoice IS CenterpointSwitch } DEF TR3 Transform { children [ DEF PS ProximitySensor { size 100000 100000 100000 } ] } DEF NI NavigationInfo { avatarSize IS avatarSize type [ "ANY","WALK" ] } DEF VP1 Viewpoint3 { jump IS jump orientation IS orientation position IS position } DEF VP2 Viewpoint3 { jump IS jump orientation IS orientation position IS position2 } DEF S Script { url "javascript: navigationscript = this; function initialize() { ni.set_bind = true; face.centerpoint = new SFVec3f(ni.avatarSize[3], ni.avatarSize[4], ni.avatarSize[5]); TR.translation = face.centerpoint; } function set_avatarSize(value) { face.centerpoint = new SFVec3f(value[3], value[4], value[5]); TR.translation = face.centerpoint; } function set_viewpoint(value) { var requestOrtho = /OrthographicViewpoint/.test(String(value)); var isOrtho = /Ortho/.test(String(value)); idx = (idx + 1) % 2; vp[idx].fieldOfView = requestOrtho ? value.viewportSize : value.fieldOfView; vp[idx].orientation = value.orientation; vp[idx].position = value.position; vp[idx].orthographic = isOrtho ? 1 : 0; vp[idx].set_bind = true; } function set_centerpoint(value) { dst = value; change = true; } function set_p(value) { vpp = value; } function set_o(value) { vpo = value; } function eventsProcessed() { if (change) { change = false; TR.translation = dst; face.centerpoint = dst; controlscript.center = dst; var i; for (i = 0; i < 3; i++) ni.avatarSize[3 + i] = dst[i]; ni.set_bind = true; var orthographic = vp[idx].orthographic; var fieldOfView = orthographic ? Browser.getScene().getViewportSize() : vp[idx].fieldOfView; idx = (idx + 1) % 2; vp[idx].fieldOfView = fieldOfView; vp[idx].orthographic = orthographic; vp[idx].orientation = vpo; var n = vpo.multVec(new SFVec3f(0, 0, -1)); var d = (dst.x * n.x + dst.y * n.y + dst.z * n.z - n.dot(vpp)) / n.length(); vp[idx].position = vpo.multVec(new SFVec3f(0, 0, 1)).multiply(d).add(dst); vp[idx].set_bind = true; } } function set_object(value) { var bb = value.getBBox(); if (value != null) { var i; for (i = 0; i < 3; i++) dst[i] = (bb[0][i] + bb[1][i]) / 2; change = true; } } function V3(value) { var ln = Math.sqrt((value.subtract(TR.translation)).length() / 6 + .1); Scl = new SFVec3f(ln, ln, ln); } function V32() { if (TR3.translation.x == 0) TR3.translation.x = .001; else TR3.translation.x = 0; } " field SFNode face DEF FACE _ { centerpoint IS centerpoint } eventIn MFFloat set_avatarSize eventIn SFVec3f V3 eventIn SFVec3f V32 eventOut SFVec3f Scl field SFNode TR USE TR field SFNode TR3 USE TR3 eventIn SFNode set_object IS set_object field MFNode vp [ USE VP1 USE VP2 ] field SFNode ni USE NI eventIn SFVec3f set_p eventIn SFRotation set_o eventIn SFVec3f set_centerpoint IS set_centerpoint eventIn SFNode set_viewpoint IS set_viewpoint field SFVec3f dst 0 0 0 field SFVec3f vpp 0 0 0 field SFRotation vpo 0 0 1 0 field SFBool change FALSE field SFInt32 idx 0 } ] } ROUTE TR.translation TO S.V32 ROUTE NI.avatarSize TO S.set_avatarSize ROUTE PS.position_changed TO S.set_p ROUTE PS.position_changed TO S.V3 ROUTE S.Scl TO TR.scale ROUTE PS.orientation_changed TO S.set_o } DEF CONTROLS_SWITCH Switch { choice [ Group { children [ DEF Simulation_environment Group { children [ DEF BaseNavigation _navigation_central { avatarSize IS avatarSize position 2.07545 2.94011 -3.74856 position2 1.79903 2.67255 -3.79413 orientation -0.341284 0.906356 0.249086 1.35588 CenterpointSwitch IS CenterpointSwitch centerpoint -1.99974e-005 1.64445 -4.41302 set_centerpoint IS set_centerpoint set_object IS set_object set_viewpoint IS set_viewpoint } DEF BaseViewpoint1 _ViewPoint { jump FALSE orientation -0.0369923 0.997533 0.0596659 1.90355 position 2.86986 3.53167 7.07428 } DEF BaseViewpoint2 _ViewPoint { } Sound { } ] } DEF HUD_Controls Group { children [ DEF ControlBar Transform { children [ Collision { children [ DEF HUDTrnsfrm Transform { children [ Transform { children [ DEF XYZSW Switch { choice [ Group { children [ DEF SS SphereSensor { enabled FALSE } DEF T Transform { children [ DEF XYZTR2 Transform { children [ Transform { children IS externalAxes } ] rotation -0.402722 0.869396 0.286296 -1.37088 } ] rotation 0.704574 -0.708973 0.030528 0.437745 scale 1.5 1.5 1.5 translation 0.05 0.048 -0.162 } ] } ] whichChoice 0 } DEF ZOOMSW Switch { choice [ Transform { children [ Transform { children [ Transform { children [ Transform { children [ Shape { appearance DEF AppZoom Appearance { material Material { diffuseColor 0 0 0 } } geometry IndexedFaceSet { color Color { color [ 1 1 1,0.502 0.502 0.7529,0.502 0.502 0.7529 ] } coord Coordinate { point [ 0.03496 -0.314 0,-0.01207 0.314 0,0.03496 0.314 0 ] } colorIndex [ 0,2,1,-1 ] coordIndex [ 0,2,1,-1 ] } } ] translation -0.005111 -0.009789 0 } ] rotation 0 0 1 -1.57 scale 1 1.2 1 translation -0.022 0 0 } Transform { children [ DEF ZoomMover Transform { children [ Transform { children [ DEF Tooltip_SW Switch { choice [ Transform { children [ Transform { children [ Shape { appearance Appearance { material Material { diffuseColor 1 1 0.8 } } geometry IndexedFaceSet { coord Coordinate { point [ 0.5 0.15 0,0.5 -0.15 0,-0.5 -0.15 0,-0.5 0.15 0 ] } colorPerVertex FALSE coordIndex [ 3,2,1,0,-1 ] } } ] translation 0 0.06 -0.1 } Shape { appearance Appearance { material Material { diffuseColor 0 0 0 } } geometry Text { string "Zoom" fontStyle FontStyle { family [ "Tahoma","Helvetica","Arial" ] justify "MIDDLE" leftToRight TRUE size 0.3 style "" } } } ] scale 0.139 0.167 0.125 translation 0.045 0.035 -0.1 } ] } Transform { children [ Shape { appearance USE AppZoom geometry IndexedFaceSet { color DEF ZoomMoverColor Color { color [ 0.502 0.502 0.7529,0 0 0,0 0 0,0.502 0.502 0.7529,1 1 1,0.502 0.502 0.7529,0.502 0.502 0.7529,0.502 0.502 0.7529,1 1 1 ] } coord Coordinate { point [ -0.02107 3.059e-005 0.0432,0.02935 -3.059e-005 -0.04554,-0.008597 -3.059e-005 -0.04554,-0.01168 3.059e-005 0.03973,0.04364 -3.059e-005 -0.05367,-0.0207 2.386e-005 0.04327,-0.00834 -2.535e-005 -0.04609,0.005336 -3.059e-005 -0.0536,0.03044 1.346e-005 -0.04616 ] } colorIndex [ 0,1,2,-1,3,4,5,-1,6,4,7,-1,8,4,6,-1,5,4,8,-1 ] coordIndex [ 0,1,2,-1,3,4,5,-1,6,4,7,-1,8,4,6,-1,5,4,8,-1 ] } } ] rotation -1 0 0 -1.571 translation 0.00458 -0.02003 0.02 } ] translation -0.005 0.015 0 } ] translation 0.0623099 0 0 } DEF ZoomSence PlaneSensor { autoOffset FALSE } DEF ZoomClick TouchSensor { } DEF XYZScript Script { url "javascript: function activeZoom(value) { if (value) AppZoom.material.transparency = 0; else AppZoom.material.transparency = .8; } function set_orientation(value) { tr.rotation = value.inverse(); } function overZoom(value) { over = value; swtt(); } function pressedZoom(value) { pressed = value; swtt(); } function swtt() { if (over) { if (!pressed) ToolTipSW.whichChoice = 0; else ToolTipSW.whichChoice = -1; } else ToolTipSW.whichChoice = -1; } " directOutput TRUE eventIn SFBool overZoom eventIn SFBool pressedZoom eventIn SFBool activeZoom field SFNode ToolTipSW USE Tooltip_SW field SFBool over FALSE field SFBool pressed FALSE field SFNode tr USE XYZTR2 eventIn SFRotation set_orientation field SFNode ASize USE BaseNavigation field SFNode AppZoom USE AppZoom } ] translation -0.03 0 0 } ] scale 0.012 0.01 0.01 translation 0 -0.004 0 } ] translation 0 0 -0.0125 } ] whichChoice -1 } ] } ] } ] collide FALSE } ] rotation -0.402722 0.869396 0.286296 1.37088 translation 1.92601 3.15088 -3.74299 } DEF PSens ProximitySensor { size 1e+007 1e+007 1e+007 } ] } DEF VCR_CONTROL_SCRIPT Script { field SFNode me USE VCR_CONTROL_SCRIPT eventOut SFNode ControlScript field SFString version_num "2.073Reversed" eventOut MFString on_start_substep IS on_start_substep eventOut MFString on_start_new_substep IS on_start_new_substep eventOut MFString on_event_out IS on_event_out eventOut SFInt32 on_vcr_state IS on_vcr_state eventOut SFFloat on_zoom_changed IS on_zoom_changed eventOut SFFloat on_proc_fraction_changed IS on_proc_fraction_changed eventOut SFFloat on_substep_fraction_changed IS on_substep_fraction_changed eventOut SFFloat on_step_fraction_changed IS on_step_fraction_changed eventIn SFBool set_ui_smoothcontrol IS set_ui_smoothcontrol eventIn SFBool set_ui_axis IS set_ui_axis eventIn SFBool set_ui_zoom IS set_ui_zoom eventIn SFBool set_ui_vcr IS set_ui_vcr eventIn SFTime vcr_play IS vcr_play eventIn SFTime vcr_stop IS vcr_stop eventIn SFTime vcr_pause IS vcr_pause eventIn SFTime vcr_forward IS vcr_forward eventIn SFTime vcr_backward IS vcr_backward eventIn SFTime vcr_next IS vcr_next eventIn SFTime vcr_previous IS vcr_previous eventIn SFString vcr_goto IS vcr_goto eventIn SFString vcr_set_position IS vcr_set_position eventIn SFFloat vcr_set_fraction IS vcr_set_fraction eventIn SFFloat set_speed_ratio IS set_speed_ratio eventIn SFBool set_stop_by_substep IS set_stop_by_substep eventIn SFBool set_stop_by_step IS set_stop_by_step eventIn SFTime zoom_reset IS zoom_reset eventIn SFFloat zoom_set_delta IS zoom_set_delta eventIn SFFloat zoom_set_level IS zoom_set_level eventIn SFFloat vcr_set_proc_fraction IS vcr_set_proc_fraction eventIn SFFloat vcr_set_step_fraction IS vcr_set_step_fraction eventIn SFFloat set_substep_fraction IS set_substep_fraction eventIn SFFloat set_procedure_fraction IS set_procedure_fraction eventIn SFFloat set_step_fraction IS set_step_fraction eventIn MFFloat now_step_substep_fraction IS now_step_substep_fraction eventIn MFFloat set_step_substep_fraction IS set_step_substep_fraction eventIn SFBool set_ignore_viewpoints IS set_ignore_viewpoints eventIn SFTime reinitialize IS reinitialize eventIn SFTime reinitialize_step IS reinitialize_step eventIn SFTime reinitialize_substep IS reinitialize_substep eventIn SFBool sim_reverse IS sim_reverse field SFBool isReversed FALSE field MFNode CommandsSetID [ ] field SFBool isFinal FALSE eventIn SFFloat ScrollSlider eventIn SFFloat time_fraction1 eventIn SFFloat time_fraction2 eventIn SFBool cycleTime1 eventIn SFBool cycleTime2 eventIn SFTime cycleTimeDelay eventIn SFTime cycleTimeFast eventIn SFBool cycleTimeVP1 eventIn SFBool cycleTimeVP2 eventIn SFTime onVCRTimer eventIn SFVec3f PS_pos eventIn SFRotation PS_rot eventIn SFVec3f PosZoomSlider eventIn SFBool slActive field MFFloat EventsFraction [ ] field MFInt32 EventsNum [ ] field SFInt32 EventsCount -1 field SFFloat OldEventFraction -1 field SFFloat NextEventFraction 1000 field SFInt32 NextEventNum -1 field SFNode STime TimeSensor { loop TRUE enabled TRUE cycleInterval 10000 } field SFNode OP protoSFNode { _ IS procedure } field SFInt32 step 0 field SFInt32 substep 0 field SFFloat phase 0 field SFInt32 NCmds 0 field MFNode Timers [ DEF AnimationTimer1 TimeSensor { cycleInterval 5 stopTime 1 } ,DEF AnimationTimer2 TimeSensor { cycleInterval 5 stopTime 1 } ,DEF VPTimer1 TimeSensor { cycleInterval 3 stopTime 1 } ,DEF VPTimer2 TimeSensor { cycleInterval 3 stopTime 1 } ,DEF ExtraFastTimer TimeSensor { cycleInterval .001 enabled FALSE loop TRUE } DEF DelayTimer TimeSensor { cycleInterval .001 enabled FALSE loop TRUE } ] field SFInt32 activeVPtimer 2 field MFInt32 CSteps [ 0,0,0 ] field SFInt32 isDelay 0 field SFInt32 activeTimer 0 field SFTime cycleInterval 5 field SFTime currentTime -1 field SFFloat timeCompression 1 field SFInt32 paused 0 field SFFloat paused_fr 0 field SFFloat val 0 field MFFloat StepDuration [ ] field MFVec2f TaskDuration [ ] field SFInt32 isScroll 0 field MFNode VP [ USE BaseViewpoint1,USE BaseViewpoint2 ] field SFInt32 activeVP 1 field SFNode PSens USE PSens field SFInt32 VPmodification 0 field SFTime intervalVP 3.5 field MFFloat avatarSz [ .25,1.6,.75,0,0,0 ] field SFNode Navigation USE BaseNavigation field SFBool onestep_mode FALSE field SFInt32 selectedTask 1 field SFInt32 bindAllVPs 0 field SFInt32 oldsubstep IS oldsubstep field SFInt32 oldstep IS oldstep field SFInt32 alertStep -1 field SFInt32 alertSubStep -1 field SFInt32 alertOut 0 field SFBool stop_every_substep FALSE field SFBool stop_every_step FALSE field SFInt32 current_mode 0 field SFInt32 VPnum 0 field MFVec3f VPperiod [ ] field SFInt32 VP_enabled 0 field SFInt32 fragment_type 0 field SFString lastID "" field SFFloat simfraction 0 field SFNode XYZSW USE XYZSW field SFNode ZOOMSW USE ZOOMSW field SFInt32 simsteps 0 field SFNode ZoomSence USE ZoomSence field SFVec3f center 0 0 0 field SFVec3f VPposition 0 0 10 eventIn SFFloat setMinZoom IS setMinZoom eventIn SFFloat setMaxZoom IS setMaxZoom field SFFloat maxZoom 10 field SFFloat minZoom .4 field SFFloat currentPositon 0 field SFNode ZoomMover USE ZoomMover field SFFloat xPos .5 field SFFloat xMin -.32 field SFFloat xMax .32 field SFFloat lastFr 0 field SFFloat distanceVP 0 field SFFloat distance 0 field SFVec3f ortVP 0 0 0 field SFNode VCRTimer DEF VCRTimer TimeSensor { loop TRUE enabled FALSE cycleInterval .001 } field MFInt32 cmd_stack [ ] field SFString last_goto_val "" field SFString last_set_position_val "" field SFFloat last_fraction_val 0 field SFFloat last_speed_ratio 0 field SFFloat last_proc_fraction_val 0 field SFFloat last_step_fraction_val 0 field SFInt32 WrnNum -1 field SFInt32 totalStop 0 field SFInt32 StepsTrueLength 0 field SFBool blockCommands FALSE field SFBool blockViewpoints FALSE field SFBool overlap_flag FALSE field SFInt32 overlap_mode 0 field SFFloat maxDim 0 field SFFloat bias .001 field SFBool alwaysWarning FALSE field SFBool lastCycleTm FALSE field SFFloat lastTmFr -1 directOutput TRUE url "javascript: /* version_num 2.073 Reversed*/ ControlScript = me; controlscript = this; function initialize() { alwaysWarning = false; blockViewpoints = true; overlap_flag = false; stop_every_substep = false; stop_every_step = false; Browser.addRoute(navigationscript.face, \'centerpoint\', me, \'PS_pos\'); if (OP._ != null) on_load(); } function setMinZoom(value) { minZoom = value; } function setMaxZoom(value) { maxZoom = value; } function onVCRTimer(value) { if (blockCommands) cmd_stack.length = 0; if (cmd_stack.length > 0) { if (cmd_stack[0] == 1) _vcr_play(); if (cmd_stack[0] == 2) _vcr_stop(); if (cmd_stack[0] == 3) _vcr_pause(); if (cmd_stack[0] == 4) _vcr_forward(); if (cmd_stack[0] == 5) _vcr_backward(); if (cmd_stack[0] == 6) _vcr_next(); if (cmd_stack[0] == 7) _vcr_previous(); if (cmd_stack[0] == 8) _vcr_goto(last_goto_val); if (cmd_stack[0] == 9) _set_speed_ratio(last_speed_ratio); if (cmd_stack[0] == 10) _vcr_set_fraction(last_fraction_val); if (cmd_stack[0] == 11) _vcr_set_proc_fraction(last_proc_fraction_val); if (cmd_stack[0] == 12) _vcr_set_step_fraction(last_step_fraction_val); if (cmd_stack[0] == 13) _vcr_set_position(last_set_position_val); var ln = cmd_stack.length - 1; var d; for (d = 1; d <= ln; d++) cmd_stack[d - 1] = cmd_stack[d]; cmd_stack.length = ln; } else VCRTimer.enabled = false; } function add_to_stack(value) { cmd_stack[cmd_stack.length] = value; VCRTimer.enabled = true; } function vcr_play() { add_to_stack(1); } function vcr_stop() { totalStop = 1; add_to_stack(3); add_to_stack(2); } function vcr_pause() { totalStop = 1; add_to_stack(3); } function vcr_forward() { totalStop = 1; add_to_stack(3); add_to_stack(4); } function vcr_backward() { totalStop = 1; add_to_stack(3); add_to_stack(5); } function vcr_next() { totalStop = 1; add_to_stack(3); add_to_stack(6); } function vcr_previous() { totalStop = 1; add_to_stack(3); add_to_stack(7); } function vcr_goto(value) { totalStop = 1; add_to_stack(3); last_goto_val = value; add_to_stack(8); } function vcr_set_position(value) { totalStop = 1; add_to_stack(3); last_set_position_val = value; add_to_stack(13); } function set_speed_ratio(value) { last_speed_ratio = value; add_to_stack(9); } function vcr_set_fraction(value) { totalStop = 1; add_to_stack(3); last_fraction_val = value; add_to_stack(10); } function vcr_set_step_fraction(value) { totalStop = 1; add_to_stack(3); last_step_fraction_val = value; add_to_stack(12); } function vcr_set_proc_fraction(value) { totalStop = 1; add_to_stack(3); last_proc_fraction_val = value; add_to_stack(11); } function reinitialize() { overlap_flag = true; overlap_mode = 0; on_load(); } function reinitialize_step() { overlap_flag = true; overlap_mode = 1; on_load(); } function reinitialize_substep() { overlap_flag = true; overlap_mode = 2; on_load(); } function sim_reverse(value) { isReversed = value; } function on_load() { oldstep = 0; oldsubstep = 0; selectedTask = 1; fragment_type = 0; TaskDuration.length = 0; simsteps = 0; var z, g, h, j; for (z = 0; z < OP._.steps.length; z++) if (OP._.steps[z].substeps.length == 0) OP._.steps[z].simulate = false; delete_Steps(); if (StepsTrueLength > 0) { blockCommands = false; lastID = OP._.id; for (z = 0; z < StepsTrueLength; z++) if (OP._.steps[z].simulate) { TaskDuration[z] = new SFVec2f(simsteps, simsteps + 1); simsteps++; } else TaskDuration[z] = new SFVec2f(-simsteps, -(simsteps + 1)); for (z = 0; z < StepsTrueLength; z++) TaskDuration[z] = TaskDuration[z].multiply(1 / simsteps); check_overlap(); if (overlap_mode == 0) { start(); alertStep = -1; alertSubStep = -1; } else { alertStep = -1; alertSubStep = -1; presetSubstep(); oldstep = step; oldsubstep = substep; } } else { blockCommands = true; if (OP._.steps.length > 0) { for (z = 0; z < OP._.steps.length; z++) if (OP._.steps[z].substeps.length == 0) return; check_overlap(); step = OP._.steps.length - 1; substep = OP._.steps[OP._.steps.length - 1].substeps.length - 1; paused_fr = 1; setPhase(); for (g = OP._.steps.length - 1; g >= 0; g--) { for (h = OP._.steps[g].substeps.length - 1; h >= 0; h--) { for (j = OP._.steps[g].substeps[h].commands.length - 1; j >= 0; j--) { if (OP._.steps[g].substeps[h].commands[j].attributeName == \'set_viewpoint\') { setVP(g, h, j); return; } } } } } } } function check_overlap() {} function delete_Steps() { StepsTrueLength = OP._.steps.length; var z; for (z = OP._.steps.length - 1; z >= 0; z--) { if (!OP._.steps[z].simulate) StepsTrueLength = z; else return; } } function out_on_zoom() { on_zoom_changed = Math.round(lastFr * 100000) / 100000; } function PosZoomSlider(value) { xPos = currentPositon + value.x; if (xPos < xMin) xPos = xMin; if (xPos > xMax) xPos = xMax; ZoomMover.translation = new SFVec3f(xPos, 0, 0); lastFr = (xPos - xMin) / (xMax - xMin); out_on_zoom(); setzoomVP(lastFr); } function setzoomVP(value) { ortVP = ortVP.normalize(); var V3_0 = VPposition.subtract(ortVP.multiply(maxZoom - distance)); var V3_2 = VPposition.subtract(ortVP.multiply(minZoom - distance)); navigationscript.vp[navigationscript.idx].position = V3_0.add((V3_2.subtract(V3_0)).multiply(value)); } function slActive(value) { if (!value) currentPositon = xPos; } function zoom_reset() { if (VPmodification != 1) { lastFr = 1 - (distanceVP - minZoom) / (maxZoom - minZoom); setzoomVP(lastFr); } } function zoom_set_level(value) { if (VPmodification != 1) { lastFr = value; if (lastFr < 0) lastFr = 0; if (lastFr > 1) lastFr = 1; setzoomVP(lastFr); } } function zoom_set_delta(value) { if (VPmodification != 1) { lastFr += .2 * value; if (lastFr < 0) lastFr = 0; if (lastFr > 1) lastFr = 1; setzoomVP(lastFr); } } function set_stop_by_substep(value) { stop_every_substep = value; } function set_stop_by_step(value) { stop_every_step = value; onestep_mode = value; } function _vcr_play() { totalStop = 0; if (!Timers[activeTimer].isActive) { play(); } } function _vcr_stop() { stop(); _vcr_goto(lastID); } function _vcr_pause() { pause(); } function _vcr_forward() { forward(); } function _vcr_backward() { backward(); } function _vcr_next() { next(); } function _vcr_previous() { prev(); } function _vcr_goto(value) { alertStep = -1; var g, h; if (OP._.id == value) { selectedTask = 1; fragment_type = 0; stop(); start(); lastID = value; } else { for (g = 0; g < StepsTrueLength; g++) { if ((OP._.steps[g].id == value) && (OP._.steps[g].simulate)) { selectedTask = 0; fragment_type = 1; onestep_mode = true; stop(); setStep(g); lastID = value; return; } } for (g = 0; g < StepsTrueLength; g++) { if (OP._.steps[g].simulate) for (h = 0; h < OP._.steps[g].substeps.length; h++) { if (OP._.steps[g].substeps[h].id == value) { selectedTask = 0; fragment_type = 2; stop_every_substep = true; stop(); step = g; substep = h; paused_fr = 0; presetSubstep(); setPhase(); lastID = value; return; } } } } } function _vcr_set_position(value) { alertStep = -1; var g, h; if (OP._.id == value) { selectedTask = 1; fragment_type = 0; stop(); start(); lastID = value; } else { for (g = 0; g < StepsTrueLength; g++) { if ((OP._.steps[g].id == value) && (OP._.steps[g].simulate)) { stop(); setStep(g); return; } } for (g = 0; g < StepsTrueLength; g++) { if (OP._.steps[g].simulate) for (h = 0; h < OP._.steps[g].substeps.length; h++) { if (OP._.steps[g].substeps[h].id == value) { stop(); step = g; substep = h; paused_fr = 0; presetSubstep(); setPhase(); return; } } } } } function _set_speed_ratio(value) { if (value > 0) { timeCompression = value; } } function set_substep_fraction(value) { _vcr_set_fraction(value); } function _vcr_set_fraction(value) { paused_fr = value; if (paused_fr > 1) paused_fr = 1; if (paused_fr < 0) paused_fr = 0; setPhase(); } function set_ignore_viewpoints(value) { blockViewpoints = value; if (!value) VP[activeVP].set_bind = true; } function set_ui_axis(value) { if (value) XYZSW.whichChoice = 0; else XYZSW.whichChoice = -1; } function set_ui_zoom(value) { if (value) ZOOMSW.whichChoice = 0; else ZOOMSW.whichChoice = -1; } function cycleTimeVP1(value) { if (activeVPtimer == 2) cycleTimeVP(value); } function cycleTimeVP2(value) { if (activeVPtimer == 3) cycleTimeVP(value); } function cycleTimeVP(value) { if ((VPmodification == 1) && (!value)) { VPmodification = 0; play2(); } } function VPmodification0() { VPmodification = 0; Timers[activeVPtimer].stopTime = STime.time; } function delayVP() { currentTime = STime.time; if (Timers[activeVPtimer].isActive) { Timers[activeVPtimer].stopTime = STime.time; activeVPtimer = (activeVPtimer == 2) ? 3 : 2; } Timers[activeVPtimer].cycleInterval = intervalVP; Timers[activeVPtimer].startTime = currentTime; Timers[activeVPtimer].stopTime = currentTime + intervalVP; } function setPosZoomSlider(value) { lastFr = 1 - (value - minZoom) / (maxZoom - minZoom); if (lastFr < 0) lastFr = 0; if (lastFr > 1) lastFr = 1; xPos = lastFr * (xMax - xMin) + xMin; out_on_zoom(); currentPositon = xPos; ZoomMover.translation = new SFVec3f(xPos, 0, 0); VPposition = navigationscript.vp[navigationscript.idx].position; } function PS_pos(value) { check_position(); if (!ZoomSence.isActive) { distance = (navigationscript.face.centerpoint.subtract(PSens.position_changed)).length(); ortVP = navigationscript.face.centerpoint.subtract(PSens.position_changed); setPosZoomSlider(distance); } } function PS_rot(value) { check_position(); } function check_position() { if (VPmodification == 1) { if (maxDim < PSens.position_changed.length()) { maxDim = PSens.position_changed.length(); bias = maxDim / 10000 + .001; } var tmpV3 = (VP[activeVP].position).subtract(PSens.position_changed); var tmpRot = (VP[activeVP].orientation).multiply((PSens.orientation_changed).inverse()); if ((tmpV3.length() < bias) && (Math.abs(tmpRot.angle) < .001)) { VPmodification0(); play2(); } } } function check_position0() { if (VPmodification == 1) { if (maxDim < PSens.position_changed.length()) { maxDim = PSens.position_changed.length(); bias = maxDim / 10000 + .001; } var tmpV3 = (VP[activeVP].position).subtract(PSens.position_changed); var tmpRot = (VP[activeVP].orientation).multiply((PSens.orientation_changed).inverse()); if ((tmpV3.length() < bias) && (Math.abs(tmpRot.angle) < .001)) { VPmodification0(); } } } function checkCondition() { isFinal = (simfraction == 1); if (current_mode == 0) { if ((simfraction != 0) && (simfraction != 1)) { current_mode = 2; on_vcr_state = current_mode; return; } } if (current_mode == 2) { if ((simfraction == 0) || (simfraction == 1)) { current_mode = 0; on_vcr_state = current_mode; return; } } } function setCondition(value) { val0 = value; isFinal = (simfraction == 1); if ((value == 0) && (simfraction > 0) && (simfraction < 1)) val0 = 2; if (current_mode != val0) { current_mode = val0; on_vcr_state = current_mode; if (current_mode == 1) ZoomSence.enabled = false; else ZoomSence.enabled = true; } } function setVP(v1, v2, v3) { if (!blockViewpoints) { activeVP = (VP[0].isBound) ? 1 : 0; if (isScroll == 1) VP[activeVP].jump = true; else VP[activeVP].jump = false; distanceVP = (navigationscript.face.centerpoint.subtract(OP._.steps[v1].substeps[v2].commands[v3].position)).length(); center = OP._.steps[v1].substeps[v2].commands[v3].center; minZoom = OP._.steps[v1].substeps[v2].commands[v3].zoom_limits[0]; maxZoom = OP._.steps[v1].substeps[v2].commands[v3].zoom_limits[1]; VP[activeVP].orientation = OP._.steps[v1].substeps[v2].commands[v3].orientation; VP[activeVP].position = OP._.steps[v1].substeps[v2].commands[v3].position; VP[activeVP].set_bind = true; avatarSz[3] = OP._.steps[v1].substeps[v2].commands[v3].center.x; avatarSz[4] = OP._.steps[v1].substeps[v2].commands[v3].center.y; avatarSz[5] = OP._.steps[v1].substeps[v2].commands[v3].center.z; } } function bindVP() { var z, h, j; for (z = VPperiod.length - 1; z >= 0; z--) if ((VPperiod[z].x <= paused_fr) && (VPperiod[z].y >= paused_fr)) { VPnum = VPperiod[z].z; setVP(step, substep, VPnum); VP_enabled = 1; return; } VP_enabled = 0; if (isScroll == 1) { for (h = substep - 1; h >= 0; h--) { var endVP = -1; for (j = 0; j < OP._.steps[step].substeps[h].commands.length; j++) { if ((OP._.steps[step].substeps[h].commands[j].attributeName == \'set_viewpoint\') && (OP._.steps[step].substeps[h].commands[j].period[1] >= endVP)) { VPnum = j; endVP = OP._.steps[step].substeps[h].commands[j].period[1]; } } if (endVP >= 0) { setVP(step, h, VPnum); VPnum = -1; return; } } VPnum = -1; } } function presetSubstep() { var z; if (StepsTrueLength > step) { paused = 0; NCmds = OP._.steps[step].substeps[substep].commands.length; cycleInterval = OP._.steps[step].substeps[substep].duration / timeCompression; VPperiod.length = 0; var cntV = 0; WrnNum = -1; EventsCount = -1; NextEventFraction = 1000; NextEventNum = -1; EventsNum.length = 0; EventsFraction.length = 0; for (z = 0; z < NCmds; z++) { if (OP._.steps[step].substeps[substep].commands[z].attributeName == \'set_viewpoint\') { VPperiod[cntV].x = OP._.steps[step].substeps[substep].commands[z].period[0]; VPperiod[cntV].y = OP._.steps[step].substeps[substep].commands[z].period[1]; VPperiod[cntV].z = z; if ((VPperiod[cntV].x <= paused_fr) && (VPperiod[cntV].y >= paused_fr)) VPnum = z; cntV++; } if (OP._.steps[step].substeps[substep].commands[z].attributeID == -2) { if (WrnNum == -1) WrnNum = z; EventsCount++; EventsNum[EventsCount] = z; EventsFraction[EventsCount] = OP._.steps[step].substeps[substep].commands[z].period[0]; if ((EventsFraction[EventsCount] < NextEventFraction) && (EventsFraction[EventsCount] > paused_fr)) { NextEventFraction = EventsFraction[EventsCount]; NextEventNum = EventsCount; } } } StepDuration.length = 0; StepDuration[0] = 0; for (z = 1; z <= OP._.steps[step].substeps.length; z++) StepDuration[z] = StepDuration[z - 1] + OP._.steps[step].substeps[z - 1].duration; for (z = 1; z <= OP._.steps[step].substeps.length; z++) StepDuration[z] = StepDuration[z] / StepDuration[OP._.steps[step].substeps.length]; setSlidersPos(paused_fr); bindVP(); if ((isScroll == 1) || (alwaysWarning)) OutID(); } } function start() { onestep_mode = false; var q; for (q = 0; q < StepsTrueLength; q++) if (OP._.steps[q].simulate) { setStep(q); return; } } function forward() { stop(); var q; for (q = step + 1; q < StepsTrueLength; q++) if (OP._.steps[q].simulate) { setStep(q); return; } substep = OP._.steps[step].substeps.length - 1; paused_fr = 1; presetSubstep(); setPhase(); } function backward() { stop(); var q; if ((substep > 0) || (paused_fr > 0)) { substep = 0; paused_fr = 0; presetSubstep(); setPhase(); return; } for (q = step - 1; q >= 0; q--) if (OP._.steps[q].simulate) { setStep(q); return; } start(); } function next() { stop(); if (OP._.steps[step].substeps.length > substep + 1) setSubStep(substep + 1); else { paused_fr = 1; presetSubstep(); setPhase(); } } function prev() { stop(); if (paused_fr > 0) { paused_fr = 0; presetSubstep(); setPhase(); return; } if (substep > 0) setSubStep(substep - 1); } function stop() { if (current_mode == 1) { if (Timers[activeTimer].isActive) { Timers[activeTimer].stopTime = STime.time; activeTimer = (activeTimer == 0) ? 1 : 0; } setCondition(0); VPmodification0(); } } function pause() { if ((paused == 0) && (Timers[activeTimer].isActive)) { paused = 1; paused_fr = Timers[activeTimer].fraction_changed + paused_fr; phase = paused_fr; } Timers[activeTimer].stopTime = STime.time; totalStop = 1; setCondition(0); VPmodification0(); } function set_procedure_fraction(value) { _vcr_set_proc_fraction(value); } function _vcr_set_proc_fraction(value) { var val0 = value; if (value > 1) val0 = 1; if (value < 0) val0 = 0; ScrollTask(val0); setSlidersPos(paused_fr); checkCondition(); } function set_step_fraction(value) { _vcr_set_step_fraction(value); } function _vcr_set_step_fraction(value) { var val0 = value; if (value > 1) val0 = 1; if (value < 0) val0 = 0; ScrollStep(val0); setSlidersPos(paused_fr); checkCondition(); } function ScrollSlider(value) { if (!blockCommands) { OldEventFraction = -1; simfraction = value; if (fragment_type == 0) ScrollTask(value); else { if (fragment_type == 1) ScrollStep(value); else if (fragment_type == 2) ScrollSubstep(value); } checkCondition(); } } function ScrollTask(value) { scrll(); isScroll = 1; val = value; var z; if ((TaskDuration[step].x <= val) && (val <= TaskDuration[step].y)) TaskToStep(0); else { var iStep = -1; for (z = 0; z < StepsTrueLength; z++) { if ((TaskDuration[z].x <= val) && (val <= TaskDuration[z].y)) iStep = z; } if (iStep != -1) step = iStep; substep = 0; StepDuration.length = 0; StepDuration[0] = 0; for (z = 1; z <= OP._.steps[step].substeps.length; z++) StepDuration[z] = StepDuration[z - 1] + OP._.steps[step].substeps[z - 1].duration; for (z = 1; z <= OP._.steps[step].substeps.length; z++) StepDuration[z] = StepDuration[z] / StepDuration[OP._.steps[step].substeps.length]; TaskToStep(1); } isScroll = 0; } function TaskToStep(value) { val = (val - TaskDuration[step].x) / (TaskDuration[step].y - TaskDuration[step].x); var z; if ((value == 0) && ((StepDuration[substep] <= val) && (val <= StepDuration[substep + 1]))) { val = (val - StepDuration[substep]) / (StepDuration[substep + 1] - StepDuration[substep]); paused_fr = val; time_fraction(0); } else { var iSubStep0 = -1; for (z = 1; z <= OP._.steps[step].substeps.length; z++) if ((StepDuration[z - 1] <= val) && (val <= StepDuration[z])) iSubStep0 = z - 1; if (iSubStep0 != -1) { substep = iSubStep0; val = (val - StepDuration[substep]) / (StepDuration[substep + 1] - StepDuration[substep]); paused_fr = val; } else { substep = 0; paused_fr = 0; } bindAllVPs = value; presetSubstep(); setPhase(); bindAllVPs = 0; } } function ScrollStep(value) { var smfr0 = simfraction; scrll(); isScroll = 1; val = value; var z; if ((StepDuration[substep] <= val) && (val <= StepDuration[substep + 1])) { val = (val - StepDuration[substep]) / (StepDuration[substep + 1] - StepDuration[substep]); paused_fr = val; time_fraction(0); if (value == 0) bindVP(); } else { var iSubStep = -1; for (z = 1; z <= OP._.steps[step].substeps.length; z++) { if ((StepDuration[z - 1] <= val) && (val <= StepDuration[z])) iSubStep = z - 1; } if (iSubStep != -1) { substep = iSubStep; paused_fr = (val - StepDuration[substep]) / (StepDuration[substep + 1] - StepDuration[substep]); presetSubstep(); setPhase(); bindVP(); } } isScroll = 0; simfraction = smfr0; } function ScrollSubstep(value) { scrll(); isScroll = 1; paused_fr = value; time_fraction(0); if (value == 0) bindVP(); isScroll = 0; } function scrll() { stop(); if (paused == 1) { totalStop = 0; paused = 0; } } function setSlidersPos(value) { var val2 = StepDuration[substep] + value * (StepDuration[substep + 1] - StepDuration[substep]); simfraction = TaskDuration[step].x + val2 * (TaskDuration[step].y - TaskDuration[step].x); OutSubstep(); on_substep_fraction_changed = value; on_step_fraction_changed = val2; on_proc_fraction_changed = simfraction; if (isScroll == 0) { if (fragment_type == 1) simfraction = val2; if (fragment_type == 2) simfraction = value; } } function eventsProcessed() { if (lastCycleTm) { cycleTime(false); lastTmFr = -1; lastCycleTm = false; } else { if (lastTmFr >= 0) { time_fraction(lastTmFr); } lastTmFr = -1; } } function time_fraction1(value) { if (activeTimer == 0) time_fraction0(value); } function time_fraction2(value) { if (activeTimer == 1) time_fraction0(value); } function time_fraction0(value) { if (paused == 0) lastTmFr = value; } function time_fraction(value) { var z; if (paused == 0) { val = (isReversed) ? 1 - value : value; phase = val; for (z = 0; z < NCmds; z++) OP._.steps[step].substeps[substep].commands[z].time_fraction = val; } } function cycleTime1(value) { if (activeTimer == 0) cycleTime0(value); } function cycleTime2(value) { if (activeTimer == 1) cycleTime0(value); } function cycleTime0(value) { if (!value) lastCycleTm = true; } function cycleTime(value) { var q; if ((!value) && (paused == 0) && (totalStop == 0)) { CheckEventOnCycle(); Timers[activeTimer].stopTime = STime.time; if (!isReversed) { if (OP._.steps[step].substeps.length <= substep + 1) { if (StepsTrueLength <= step + 1) { paused_fr = 1; phase = paused_fr; } else { if (OP._.steps[step + 1].simulate) { substepfinish(); step++; substep = 0; setOldValues(); paused_fr = 0; phase = paused_fr; activeTimer = (activeTimer == 0) ? 1 : 0; presetSubstep(); play(); return; } else { for (q = step + 1; q < StepsTrueLength; q++) if (OP._.steps[q].simulate) { setStep(q); activeTimer = (activeTimer == 0) ? 1 : 0; play(); return; } paused_fr = 1; phase = paused_fr; } } } else { substepfinish(); substep++; setOldValues(); paused_fr = 0; phase = paused_fr; activeTimer = (activeTimer == 0) ? 1 : 0; play(); return; } } else { if (substep <= 0) { if (step <= 0) { paused_fr = 0; phase = paused_fr; } else { substepfinish(); step--; substep = OP._.steps[step].substeps.length - 1; setOldValues(); paused_fr = 1; phase = paused_fr; activeTimer = (activeTimer == 0) ? 1 : 0; presetSubstep(); play(); return; } } else { substepfinish(); substep--; setOldValues(); paused_fr = 1; phase = paused_fr; activeTimer = (activeTimer == 0) ? 1 : 0; play(); return; } } substepfinish(); setCondition(0); } } function substepfinish() { var z; var RVal = (isReversed) ? 0 : 1; for (z = 0; z < NCmds; z++) { OP._.steps[step].substeps[substep].commands[z].time_fraction = RVal; } setSlidersPos(1); } function play() { if (!Timers[activeTimer].isActive) { presetSubstep(); play2(); } } function cycleTimeFast() { if ((CSteps[0] == 1) && (CSteps[1] == step) && (CSteps[2] == substep)) { Timers[4].enabled = false; CSteps[0] = 0; paused_fr = (isReversed) ? 0 : 1; phase = paused_fr; setSlidersPos(paused_fr); cycleTime(false); } } function play2() { OutSubstep(); OutID(); val = paused_fr; setCondition(1); isDelay = 1; Timers[5].enabled = true; } function cycleTimeDelay() { if (isDelay == 1) { Timers[5].enabled = false; isDelay = 0; play3(); } } function play3() { if (totalStop == 0) { presetSubstep(); CheckEventOnPlay(); var timetmp = 0; timetmp = (isReversed) ? cycleInterval * paused_fr : cycleInterval * (1 - paused_fr); if (timetmp < .4) { CSteps[0] = 1; CSteps[1] = step; CSteps[2] = substep; Timers[4].enabled = true; } else { currentTime = STime.time; Timers[activeTimer].cycleInterval = cycleInterval; Timers[activeTimer].startTime = currentTime; Timers[activeTimer].stopTime = currentTime + cycleInterval * timetmp; } } else { setCondition(0); } } function now_step_substep_fraction(value) { stop(); overlap_flag = false; on_load(); step = value[0]; substep = value[1]; paused_fr = value[2]; presetSubstep(); setOldValues(); } function set_step_substep_fraction(value) { stop(); step = value[0]; substep = value[1]; paused_fr = value[2]; presetSubstep(); setPhase(); } function setStep(value) { substep = 0; step = value; paused_fr = 0; presetSubstep(); setPhase(); } function setSubStep(value) { substep = value; paused_fr = 0; presetSubstep(); setPhase(); } function setPhase() {} function setOldValues() { oldstep = step; oldsubstep = substep; } function OutSubstep() { if ((alertSubStep != substep) || (alertStep != step)) { if ((fragment_type == 1) && (OP._.steps[step].id != \'\')) lastID = OP._.steps[step].id; on_start_new_substep = new MFString(OP._.id, OP._.steps[step].id, OP._.steps[step].substeps[substep].id); on_start_substep = new MFString(OP._.id, OP._.steps[step].id, OP._.steps[step].substeps[substep].id); alertSubStep = substep; alertStep = step; alertOut = 0; OldEventFraction = -1; } } function CheckEventOnPlay() { var z, t; if (OldEventFraction == val) return; var CountEvents = 0; for (z = 0; z <= EventsCount; z++) if (EventsFraction[z] == val) { CountEvents++; CommandsSetID.length = CountEvents; CommandsSetID[CountEvents - 1] = OP._.steps[step].substeps[substep].commands[EventsNum[z]]; } if (CountEvents > 0) { OldEventFraction = val; OutEventID(); NextEventNum = -1; NextEventFraction = 100; for (t = 0; t <= EventsCount; t++) { if ((EventsFraction[t] > val) && (NextEventFraction > EventsFraction[t])) { NextEventFraction = EventsFraction[t]; NextEventNum = t; } } } else OldEventFraction = -1; } function CheckEventOnCycle() { var z, t; if (NextEventNum > 0) { var MFStr = new MFString(OP._.steps[step].substeps[substep].commands[EventsNum[NextEventNum]].ID); CommandsSetID.length = 1; CommandsSetID[0] = OP._.steps[step].substeps[substep].commands[EventsNum[NextEventNum]]; var TmpFraction = 1000; var TmpEventNum = -1; for (z = 0; z <= EventsCount; z++) { TmpEventNum = -1; for (t = 0; t <= EventsCount; t++) if ((EventsFraction[t] <= 1) && (EventsFraction[t] > NextEventFraction) && (TmpFraction > EventsFraction[t]) && (t != NextEventNum)) { TmpFraction = EventsFraction[t]; TmpEventNum = t; } if (TmpEventNum < 0) { z = EventsCount; } else { var ln000 = MFStr.length; MFStr.length = ln000 + 1; CommandsSetID.length = ln000 + 1; MFStr[ln000] = OP._.steps[step].substeps[substep].commands[EventsNum[TmpEventNum]].ID; CommandsSetID[ln000] = OP._.steps[step].substeps[substep].commands[EventsNum[TmpEventNum]]; } } OutEventID(); } } function OutEventID() { var OutIDMFStr = new MFString(); var z; for (z = 0; z < CommandsSetID.length; z++) OutIDMFStr[z] = CommandsSetID[z].ID; on_event_out = OutIDMFStr; } function OutID() { if ((WrnNum != -1) && (alertOut == 0)) { if (OP._.steps[step].id != OP._.steps[step].substeps[substep].commands[WrnNum].ID) on_start_substep = new MFString(OP._.id, OP._.steps[step].id, OP._.steps[step].substeps[substep].commands[WrnNum].ID); alertOut = 1; } } " } ] } ] whichChoice IS whichChoice } ROUTE PSens.orientation_changed TO VCR_CONTROL_SCRIPT.PS_rot ROUTE PSens.orientation_changed TO ControlBar.rotation ROUTE PSens.orientation_changed TO XYZScript.set_orientation ROUTE ZoomSence.enabled TO ZoomClick.enabled ROUTE ZoomSence.enabled TO XYZScript.activeZoom ROUTE ZoomSence.isActive TO VCR_CONTROL_SCRIPT.slActive ROUTE AnimationTimer2.fraction_changed TO VCR_CONTROL_SCRIPT.time_fraction2 ROUTE AnimationTimer2.isActive TO VCR_CONTROL_SCRIPT.cycleTime2 ROUTE VPTimer1.isActive TO VCR_CONTROL_SCRIPT.cycleTimeVP1 ROUTE ExtraFastTimer.cycleTime TO VCR_CONTROL_SCRIPT.cycleTimeFast ROUTE VPTimer2.isActive TO VCR_CONTROL_SCRIPT.cycleTimeVP2 ROUTE DelayTimer.cycleTime TO VCR_CONTROL_SCRIPT.cycleTimeDelay ROUTE VCRTimer.cycleTime TO VCR_CONTROL_SCRIPT.onVCRTimer ROUTE AnimationTimer1.fraction_changed TO VCR_CONTROL_SCRIPT.time_fraction1 ROUTE AnimationTimer1.isActive TO VCR_CONTROL_SCRIPT.cycleTime1 ROUTE ZoomSence.translation_changed TO VCR_CONTROL_SCRIPT.PosZoomSlider ROUTE ZoomClick.isActive TO XYZScript.pressedZoom ROUTE ZoomClick.isOver TO XYZScript.overZoom ROUTE PSens.position_changed TO VCR_CONTROL_SCRIPT.PS_pos ROUTE PSens.position_changed TO ControlBar.translation } ';
},function(e,t,i){var n=i(39).defineClass,o=i(44),r=i(43);e.exports=new(n(o,function(){this.constructor.superClass.call(this,"fps",["OnFrameRateMeasured"])},{create:function(e){return new(n(r,function(e,t){this.constructor.superClass.call(this,e);var i=document.createElement("div");i.setAttribute("id",e.getNextId()),i.style.position="absolute",i.style.bottom=0,i.style.right=0,i.style.fontSize="4em",i.style.fontWeight="bold",i.style.width="4em",i.style.height="2em",i.style.zIndex="100",this.instance=i,this.hide(),t.appendChild(i),this.fps=0;this.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.ieRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)}}(),this.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.ieCancelAnimationFrame||window.clearTimeout}(),this.now=function(){return Date.now()/1e3}},{attach:function(e){var t=this;this.then=this.now(),this.fpsAcc=0,this.fpsCount=0,this.fpsTime=this.then;var i=function(){var e=t.now(),n=e-t.then;t.then=e,0!==n&&(t.fpsAcc+=1/n,t.fpsCount++,e-t.fpsTime>.5&&(t.fps=(t.fpsAcc/t.fpsCount).toFixed(2),t.instance.innerHTML=t.fps,t.trigger("OnFrameRateMeasured",{raw:[t.fps],src:t}),t.fpsTime=e,t.fpsCount=0,t.fpsAcc=0)),t.requestAnimFrame.call(window,i)};return this.requestId=this.requestAnimFrame.call(window,i),this},detach:function(){return this.requestId&&(this.cancelAnimFrame.call(window,this.requestId),delete this.requestId),this},show:function(){return this.instance.style.display="block",this},hide:function(){return this.instance.style.display="none",this}}))(this,e.container).attach()}}))},function(e,t,i){var n=i(39).defineClass,o=i(44),r=i(43);e.exports=new(n(o,function(){this.constructor.superClass.call(this,"error",[])},{create:function(e){return new(n(r,function(e,t){this.constructor.superClass.call(this,e);var i=document.createElement("div");i.setAttribute("id",e.getNextId()),i.className="error-message",i.appendChild(document.createElement("div")).className="error-message-body",t.appendChild(i),this.instance=i,this.body=this.instance.firstChild,this.container=t},{attach:function(){return this.container.classList.add("error"),this},detach:function(){return this.container.classList.remove("error"),this},message:function(e){this.body.innerHTML="";for(var t=0;t<arguments.length;t++){var i=arguments[t].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\[([^\[\]]*)]/g,function(e,t){var i=t.split("|");return'<a href="'+(i.length>1?i[1]:i[0])+'">'+i[0]+"</a>"});this.body.appendChild(document.createElement("div")).innerHTML=i}return this}}))(this,e.container).attach()}}))},function(e,t,i){var n=i(39).defineClass,o=i(44),r=i(43);e.exports=new(n(o,function(){this.constructor.superClass.call(this,"loading",[])},{create:function(e){return new(n(r,function(e,t){this.constructor.superClass.call(this,e),i(53);var n=document.createElement("div");n.innerHTML=i(55)();var o=n.firstChild;o.setAttribute("id",e.getNextId()),o.classList.add("loading-indicator"),t.appendChild(o),this.instance=o,this.container=t},{attach:function(){return this.container.classList.add("wait"),this},detach:function(){return this.container.classList.remove("wait"),this},show:function(){return this.container.classList.add("wait"),this},hide:function(){return this.container.classList.remove("wait"),this}}))(this,e.container).attach()}}))},function(e,t,i){var n=i(54);"string"==typeof n&&(n=[[e.id,n,""]]);i(36)(n,{});n.locals&&(e.exports=n.locals)},function(e,t,i){t=e.exports=i(8)(),t.push([e.id,".loading-indicator{position:relative;width:40mm;height:40mm;text-align:center}.loading-indicator div{width:40mm;height:40mm;margin:0 auto;border:2mm solid #ebebeb;border-radius:50%;border-left-color:transparent;border-right-color:transparent;animation:cssload-spin .7s infinite linear;-o-animation:cssload-spin .7s infinite linear;-ms-animation:cssload-spin .7s infinite linear;-webkit-animation:cssload-spin .7s infinite linear;-moz-animation:cssload-spin .7s infinite linear}@keyframes cssload-spin{to{transform:rotate(1turn)}}@-webkit-keyframes cssload-spin{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""])},function(e,t,i){function n(e){var t="";return t+='<div class="loading-indicator"><div></div></div>'}i(56);e.exports=n},function(e,t,i){"use strict";function n(e,t){if(1===arguments.length){for(var i=e[0],o=1;o<e.length;o++)i=n(i,e[o]);return i}for(var r in t)if("class"===r){var s=e[r]||[];e[r]=(Array.isArray(s)?s:[s]).concat(t[r]||[])}else if("style"===r){var s=a(e[r]),l=a(t[r]);e[r]=s+l}else e[r]=t[r];return e}function o(e,t){for(var i,n="",o="",r=Array.isArray(t),a=0;a<e.length;a++)i=s(e[a]),i&&(r&&t[a]&&(i=d(i)),n=n+o+i,o=" ");return n}function r(e){var t="",i="";for(var n in e)n&&e[n]&&p.call(e,n)&&(t=t+i+n,i=" ");return t}function s(e,t){return Array.isArray(e)?o(e,t):e&&"object"==typeof e?r(e):e||""}function a(e){if(!e)return"";if("object"==typeof e){var t="";for(var i in e)p.call(e,i)&&(t=t+i+":"+e[i]+";");return t}return e+="",";"!==e[e.length-1]?e+";":e}function l(e,t,i,n){return t!==!1&&null!=t&&(t||"class"!==e&&"style"!==e)?t===!0?" "+(n?e:e+'="'+e+'"'):("function"==typeof t.toJSON&&(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),i||t.indexOf('"')===-1)?(i&&(t=d(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"):""}function c(e,t){var i="";for(var n in e)if(p.call(e,n)){var o=e[n];if("class"===n){o=s(o),i=l(n,o,!1,t)+i;continue}"style"===n&&(o=a(o)),i+=l(n,o,!1,t)}return i}function d(e){var t=""+e,i=h.exec(t);if(!i)return e;var n,o,r,s="";for(n=i.index,o=0;n<t.length;n++){switch(t.charCodeAt(n)){case 34:r="&quot;";break;case 38:r="&amp;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}o!==n&&(s+=t.substring(o,n)),o=n+1,s+=r}return o!==n?s+t.substring(o,n):s}function u(e,t,n,o){if(!(e instanceof Error))throw e;if(!("undefined"==typeof window&&t||o))throw e.message+=" on line "+n,e;try{o=o||i(57).readFileSync(t,"utf8")}catch(t){u(e,null,n)}var r=3,s=o.split("\n"),a=Math.max(n-r,0),l=Math.min(s.length,n+r),r=s.slice(a,l).map(function(e,t){var i=t+a+1;return(i==n?"  > ":"    ")+i+"| "+e}).join("\n");throw e.path=t,e.message=(t||"Pug")+":"+n+"\n"+r+"\n\n"+e.message,e}var p=Object.prototype.hasOwnProperty;t.merge=n,t.classes=s,t.style=a,t.attr=l,t.attrs=c;var h=/["&<>]/;t.escape=d,t.rethrow=u},function(e,t){},function(e,t,i){var n=i(39).defineClass,o=i(44),r=i(43),s="http://www.w3.org/2000/svg",a="http://www.w3.org/1999/xlink",l="1.2";e.exports=new(n(o,function(){this.constructor.superClass.call(this,"svg",["HotspotHit","HotspotEnter","HotspotLeave","DocumentComplete","DocumentLoadingError","ContextMenu"])},{create:function(e){return new(n(r,function(e,t){function n(e){for(var t=e;t&&"a"!=t.nodeName.toLowerCase();)t=t.parentNode;return t}function o(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function r(e){var t="touch"===e.pointerType;if(f.length<2&&(d.setOriginBy(e.screenX-u,e.screenY-p),u=e.screenX,p=e.screenY,d.applyTransform()),t){for(var i=-1,n=0;n<f.length;n++)if(f[n].id===e.pointerId){i=n;break}if(i>=0&&(f[i].x=e.screenX,f[i].y=e.screenY,f[i].clientX=e.clientX,f[i].clientY=e.clientY),2===f.length){var r=d.view.clientWidth,s=d.view.clientHeight,a=d.getViewBoxDimensions(),l=a.w,c=a.h,m=h-o(f[0],f[1]);h=o(f[0],f[1]);var v=Math.max(d.minScale,Math.min(d.maxScale,(1-m/100)*d.zoom))/d.zoom,_=d.view.getBoundingClientRect(),g=(f[1].clientX-f[0].clientX)/2+f[0].clientX,C=(f[1].clientY-f[0].clientY)/2+f[0].clientY,I=g-_.left,y=C-_.top,b=(I-(r-l)/2-d.originX/a.scale)/d.zoom*a.scale,S=(y-(s-c)/2-d.originY/a.scale)/d.zoom*a.scale,w=d.originX+b*(1-v)*d.zoom,T=d.originY+S*(1-v)*d.zoom;v>1?d.setTransform(w,T,d.zoom*v):(d.zoom*=v,d.setOrigin(w,T),d.applyTransform())}}e.preventDefault()}function l(e){var t="touch"===e.pointerType;t&&(f=f.filter(function(t){return t.id!==e.pointerId}),h=2===f.length?o(f[0],f[1]):0,1===f.length&&(u=f[0].x,p=f[0].y)),0===e.button&&0===f.length&&(document.removeEventListener("pointermove",r),document.removeEventListener("pointerup",l),d.view.style.cursor="default")}this.constructor.superClass.call(this,e),i(59);var c=document.createElementNS(s,"svg");c.setAttribute("id",e.getNextId()),this.instance=c,this.view=t,t.setAttribute("touch-action","none"),this.zoom=1,this.originX=0,this.originY=0,this.maxScale=10,this.minScale=1,this.isHidden=!0,this.image=new Image;var d=this;this.image.onload=function(e){e=e||window.event;var t=d.image,i=d.instance.ownerDocument.createElementNS(s,"image");i.setAttribute("image-rendering","optimizeQuality"),i.setAttribute("width",t.width),i.setAttribute("height",t.height),d.instance.setAttribute("viewBox","0 0 "+t.width+" "+t.height),i.setAttributeNS(a,"href",t.src),d.viewBox={x:0,y:0,width:t.width,height:t.height},d.viewport=document.createElementNS(s,"g");var n=d.viewport.transform.baseVal;n.initialize(d.instance.createSVGTransform()),n.appendItem(d.instance.createSVGTransform()),d.viewport.appendChild(i),d.instance.appendChild(d.viewport),d.trigger("DocumentComplete",{raw:[t.src],src:e}),d.isHidden||d.attach()},this.eventHandlersA={click:function(e){e=e||window.event;var t=+(e.shiftKey&&1)|+(e.ctrlKey&&2)|+(e.altKey&&4),i=n(e.target||e.srcElement),o=i?i.getAttribute("name"):"";d.trigger("HotspotHit",{raw:[o,t],src:e}),e.preventDefault()},pointerover:function(e){e=e||window.event;var t=n(e.target||e.srcElement),i=t?t.getAttribute("name"):"";d.trigger("HotspotEnter",{raw:[i],src:e}),e.preventDefault()},pointerout:function(e){e=e||window.event;var t=n(e.target||e.srcElement),i=t?t.getAttribute("name"):"";d.trigger("HotspotLeave",{raw:[i],src:e}),e.preventDefault()},contextmenu:function(e){e=e||window.event;var t=e.target||e.srcElement,i=n(t),o=i?i.getAttribute("name"):"",r=d.view.getBoundingClientRect(),s=e.clientX-r.left,a=e.clientY-r.top;return d.trigger("ContextMenu",{raw:[o,s,a],src:e}),e.preventDefault(),e.stopPropagation(),!1}};var u,p,h,f=[];this.eventHandlers={contextmenu:this.eventHandlersA.contextmenu,wheel:function(e){e=e||window.event;var t=e.deltaY<0?-10:10,i=d.view.clientWidth,n=d.view.clientHeight,o=d.getViewBoxDimensions(),r=o.w,s=o.h,a=Math.max(d.minScale,Math.min(d.maxScale,(1-t/100)*d.zoom))/d.zoom,l=d.view.getBoundingClientRect(),c=e.clientX-l.left,u=e.clientY-l.top,p=(c-(i-r)/2-d.originX/o.scale)/d.zoom*o.scale,h=(u-(n-s)/2-d.originY/o.scale)/d.zoom*o.scale,f=d.originX+p*(1-a)*d.zoom,m=d.originY+h*(1-a)*d.zoom;return a>1?d.setTransform(f,m,d.zoom*a):(d.zoom*=a,d.setOrigin(f,m),d.applyTransform()),e.preventDefault(),!1},dblclick:function(e){return f=[],d.reset(),e.preventDefault(),!1},pointerdown:function(e){e=e||window.event;var t="touch"===e.pointerType;t&&(f.push({id:e.pointerId,x:e.screenX,y:e.screenY,clientX:e.clientX,clientY:e.clientY}),h=2===f.length?o(f[0],f[1]):0),0===e.button&&f.length<2&&(u=e.screenX,p=e.screenY,document.addEventListener("pointermove",r),document.addEventListener("pointerup",l),d.view.style.cursor="move")}},this.hide(),t.appendChild(c)},{getViewBoxDimensions:function(){var e=this.view.clientWidth,t=this.view.clientHeight,i=this.viewBox.width,n=this.viewBox.height,o=e/t,r=i/n;return o>r?(n=t,i=n*r):o<r?(i=e,n=i/r):(n=t,i=e),{h:n,w:i,scale:this.viewBox.width/i}},setOriginBy:function(e,t){var i=this.getViewBoxDimensions();this.setOrigin(this.originX+e*i.scale,this.originY+t*i.scale)},setOrigin:function(e,t){var i=this.view.clientWidth,n=this.view.clientHeight,o=this.getViewBoxDimensions(),r=o.w,s=o.h,a=o.scale,l=r*this.zoom,c=s*this.zoom,d=-Math.abs(i-r)/2,u=-Math.abs(n-s)/2;l<=i?this.originX=Math.max(Math.min(e,(d+i-l)*a),d*a):this.originX=Math.max(Math.min(e,d*a),(d+i-l)*a),c<=n?this.originY=Math.max(Math.min(t,(u+n-c)*a),u*a):this.originY=Math.max(Math.min(t,u*a),(u+n-c)*a)},setTransform:function(e,t,i){this.originX=e,this.originY=t,this.zoom=i,this.applyTransform()},applyTransform:function(){var e=this.viewport.transform.baseVal;e.getItem(0).setTranslate(this.originX,this.originY),e.getItem(1).setScale(this.zoom,this.zoom)},getSVGSource:function(){var e=document.createElement("div");return e.appendChild(this.instance.cloneNode(!0)),e.firstChild.removeAttribute("id"),e.firstChild.removeAttribute("style"),e.innerHTML},version:function(){if(this.isValid())return"HTML5 SVG Component ver. "+l},attach:function(){for(var e=this,t=this.instance,i=t.getElementsByTagName("a"),n=0;n<i.length;n++)!function(t){var i=t.getAttribute("name");i||(console.log('WARNING: Element "'+t.tagName+'" has no "name" attribute. It uses text content instead'),i=t.textContent.trim(),t.setAttribute("name",i));for(var n in e.eventHandlersA)t.addEventListener(n,e.eventHandlersA[n],!1)}(i[n]);for(var o in e.eventHandlers)e.view.addEventListener(o,e.eventHandlers[o],!1);return this},detach:function(){for(var e=this,t=this.instance,i=t.getElementsByTagName("a"),n=0;n<i.length;n++){var o=i[n];for(var r in e.eventHandlers)o.removeEventListener(r,e.eventHandlers[r],!1)}for(var r in e.eventHandlers)e.view.removeEventListener(r,e.eventHandlers[r],!1);return this.zoom=1,this.originX=0,this.originY=0,this},load:function(e,t){if(t||/\.(png|jpe?g|jpe|gif)$/i.test(e)){this.detach();for(var i=this.instance;i.firstChild;)i.removeChild(i.firstChild);this.image.src=e}else{var n=new window.XMLHttpRequest;n.overrideMimeType&&n.overrideMimeType("image/svg+xml");try{var o=this;n.open("GET",e,!0),n.onerror=function(t){o.trigger("DocumentLoadingError",{raw:[e,n.status],src:t||window.event})},n.onload=function(t){if(t=t||window.event,n.responseXML){var i=document.createElement("div");i.innerHTML=n.response;var r=i.querySelector("svg");if(r){o.detach();var a=o.instance.style.cssText,l=o.instance.getAttribute("class");o.view.replaceChild(r,o.instance),o.instance=r;var c=r.getElementsByTagName("title")[0];c&&r.removeChild(c);var d=Array.prototype.slice.call(r.childNodes||r.children).filter(function(e){var t=e.nodeName;return"#text"!==t&&"title"!==t&&"defs"!==t&&"desc"!=t});o.viewport=document.createElementNS(s,"g");var u=o.viewport.transform.baseVal;u.initialize(r.createSVGTransform()),u.appendItem(r.createSVGTransform()),d.forEach(function(e){o.viewport.appendChild(e)}),r.appendChild(o.viewport),r.getAttribute("viewBox")||r.setAttribute("viewBox","0 0 "+r.getAttribute("width")+" "+r.getAttribute("height")),o.viewBox=r.getBBox(),r.style.cssText=a,r.setAttribute("class",l),o.trigger("DocumentComplete",{raw:[e],src:t}),o.isHidden||o.attach()}}},n.send(null)}catch(t){this.trigger("DocumentLoadingError",{raw:[e],src:t})}}return this},unload:function(){var e=this.instance;for(this.detach();e.firstChild;)e.removeChild(e.firstChild);return this},highlight:function(e,t){var i=this.instance;Array.prototype.slice.call(i.getElementsByTagName("a")).forEach(function(i){i.getAttribute("name")===e&&Array.prototype.slice.call(i.getElementsByTagName("path")).forEach(function(e){e.style.stroke=t})})},unhighlight:function(e,t){var i=this.instance;Array.prototype.slice.call(i.getElementsByTagName("a")).forEach(function(t){t.getAttribute("name")===e&&Array.prototype.slice.call(t.getElementsByTagName("path")).forEach(function(e){e.style.stroke=""})})},select:function(e,t){var i=this.instance;Array.prototype.slice.call(i.getElementsByTagName("a")).forEach(function(i){i.getAttribute("name")===e&&Array.prototype.slice.call(i.getElementsByTagName("path")).forEach(function(e){e.style.fill=t,e.style.fillOpacity=1})})},unselect:function(e,t){var i=this.instance;Array.prototype.slice.call(i.getElementsByTagName("a")).forEach(function(t){t.getAttribute("name")===e&&Array.prototype.slice.call(t.getElementsByTagName("path")).forEach(function(e){e.style.fill="",e.style.fillOpacity=0})})},reset:function(){var e=1;return this.setTransform(0,0,e),this},scaleBy:function(e){var t=this.view.clientWidth,i=this.view.clientHeight,n=this.viewBox.width,o=this.viewBox.height,r=t/i,s=n/o;r>s?(o=i*this.zoom,n=o*s):r<s?(n=t*this.zoom,o=n/s):(o=i*this.zoom,n=t*this.zoom);var a=Math.max(this.minScale,Math.min(this.maxScale,this.zoom+e)),l=(this.zoom-a)/2;return this.zoom=a,this.setOriginBy(n*l,o*l),this.applyTransform(),this},hide:function(){return this.constructor.superClass.prototype.hide.call(this),this.detach(),this.isHidden=!0,this},show:function(){return this.constructor.superClass.prototype.show.call(this),this.attach(),this.isHidden=!1,this}}))(this,e.container).attach()}}))},function(e,t,i){/*!
	 * PEP v0.4.3-pre | https://github.com/jquery/PEP
	 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
	 */
!function(t,i){e.exports=i()}(this,function(){"use strict";function e(e,t){t=t||Object.create(null);var i=document.createEvent("Event");i.initEvent(e,t.bubbles||!1,t.cancelable||!1);for(var n,o=2;o<p.length;o++)n=p[o],i[n]=t[n]||h[o];i.buttons=t.buttons||0;var r=0;return r=t.pressure&&i.buttons?t.pressure:i.buttons?.5:0,i.x=i.clientX,i.y=i.clientY,i.pointerId=t.pointerId||0,i.width=t.width||0,i.height=t.height||0,i.pressure=r,i.tiltX=t.tiltX||0,i.tiltY=t.tiltY||0,i.pointerType=t.pointerType||"",i.hwTimestamp=t.hwTimestamp||0,i.isPrimary=t.isPrimary||!1,i}function t(){this.array=[],this.size=0}function i(e,t,i,n){this.addCallback=e.bind(n),this.removeCallback=t.bind(n),this.changedCallback=i.bind(n),P&&(this.observer=new P(this.mutationWatcher.bind(this)))}function n(e){return"body /shadow-deep/ "+o(e)}function o(e){return'[touch-action="'+e+'"]'}function r(e){return"{ -ms-touch-action: "+e+"; touch-action: "+e+"; }"}function s(){if(x){A.forEach(function(e){String(e)===e?(D+=o(e)+r(e)+"\n",O&&(D+=n(e)+r(e)+"\n")):(D+=e.selectors.map(o)+r(e.rule)+"\n",O&&(D+=e.selectors.map(n)+r(e.rule)+"\n"))});var e=document.createElement("style");e.textContent=D,document.head.appendChild(e)}}function a(){if(!window.PointerEvent){if(window.PointerEvent=e,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0}),I.registerSource("ms",q)}else I.registerSource("mouse",R),void 0!==window.ontouchstart&&I.registerSource("touch",X);I.register(document)}}function l(e){if(!I.pointermap.has(e)){var t=new Error("InvalidPointerId");throw t.name="InvalidPointerId",t}}function c(e){if(!e.ownerDocument.contains(e)){var t=new Error("InvalidStateError");throw t.name="InvalidStateError",t}}function d(e){var t=I.pointermap.get(e);return 0!==t.buttons}function u(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:W},releasePointerCapture:{value:Z}})}var p=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],h=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],f=window.Map&&window.Map.prototype.forEach,m=f?Map:t;t.prototype={set:function(e,t){return void 0===t?this.delete(e):(this.has(e)||this.size++,void(this.array[e]=t))},has:function(e){return void 0!==this.array[e]},delete:function(e){this.has(e)&&(delete this.array[e],this.size--)},get:function(e){return this.array[e]},clear:function(){this.array.length=0,this.size=0},forEach:function(e,t){return this.array.forEach(function(i,n){e.call(t,i,n,this)},this)}};var v=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],_=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],g={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},C="undefined"!=typeof SVGElementInstance,I={pointermap:new m,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(e,t){var i=t,n=i.events;n&&(n.forEach(function(e){i[e]&&(this.eventMap[e]=i[e].bind(i))},this),this.eventSources[e]=i,this.eventSourceList.push(i))},register:function(e){for(var t,i=this.eventSourceList.length,n=0;n<i&&(t=this.eventSourceList[n]);n++)t.register.call(t,e)},unregister:function(e){for(var t,i=this.eventSourceList.length,n=0;n<i&&(t=this.eventSourceList[n]);n++)t.unregister.call(t,e)},contains:function(e,t){try{return e.contains(t)}catch(e){return!1}},down:function(e){e.bubbles=!0,this.fireEvent("pointerdown",e)},move:function(e){e.bubbles=!0,this.fireEvent("pointermove",e)},up:function(e){e.bubbles=!0,this.fireEvent("pointerup",e)},enter:function(e){e.bubbles=!1,this.fireEvent("pointerenter",e)},leave:function(e){e.bubbles=!1,this.fireEvent("pointerleave",e)},over:function(e){e.bubbles=!0,this.fireEvent("pointerover",e)},out:function(e){e.bubbles=!0,this.fireEvent("pointerout",e)},cancel:function(e){e.bubbles=!0,this.fireEvent("pointercancel",e)},leaveOut:function(e){this.out(e),this.propagate(e,this.leave,!1)},enterOver:function(e){this.over(e),this.propagate(e,this.enter,!0)},eventHandler:function(e){if(!e._handledByPE){var t=e.type,i=this.eventMap&&this.eventMap[t];i&&i(e),e._handledByPE=!0}},listen:function(e,t){t.forEach(function(t){this.addEvent(e,t)},this)},unlisten:function(e,t){t.forEach(function(t){this.removeEvent(e,t)},this)},addEvent:function(e,t){e.addEventListener(t,this.boundHandler)},removeEvent:function(e,t){e.removeEventListener(t,this.boundHandler)},makeEvent:function(t,i){this.captureInfo[i.pointerId]&&(i.relatedTarget=null);var n=new e(t,i);return i.preventDefault&&(n.preventDefault=i.preventDefault),n._target=n._target||i.target,n},fireEvent:function(e,t){var i=this.makeEvent(e,t);return this.dispatchEvent(i)},cloneEvent:function(e){for(var t,i=Object.create(null),n=0;n<v.length;n++)t=v[n],i[t]=e[t]||_[n],!C||"target"!==t&&"relatedTarget"!==t||i[t]instanceof SVGElementInstance&&(i[t]=i[t].correspondingUseElement);return e.preventDefault&&(i.preventDefault=function(){e.preventDefault()}),i},getTarget:function(e){var t=this.captureInfo[e.pointerId];return t?e._target!==t&&e.type in g?void 0:t:e._target},propagate:function(e,t,i){for(var n=e.target,o=[];!n.contains(e.relatedTarget)&&n!==document;)o.push(n),n=n.parentNode;i&&o.reverse(),o.forEach(function(i){e.target=i,t.call(this,e)},this)},setCapture:function(t,i){this.captureInfo[t]&&this.releaseCapture(t),this.captureInfo[t]=i;var n=new e("gotpointercapture");n.pointerId=t,this.implicitRelease=this.releaseCapture.bind(this,t),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease),n._target=i,this.asyncDispatchEvent(n)},releaseCapture:function(t){var i=this.captureInfo[t];if(i){var n=new e("lostpointercapture");n.pointerId=t,this.captureInfo[t]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease),n._target=i,this.asyncDispatchEvent(n)}},dispatchEvent:function(e){var t=this.getTarget(e);if(t)return t.dispatchEvent(e)},asyncDispatchEvent:function(e){requestAnimationFrame(this.dispatchEvent.bind(this,e))}};I.boundHandler=I.eventHandler.bind(I);var y={shadow:function(e){if(e)return e.shadowRoot||e.webkitShadowRoot},canTarget:function(e){return e&&Boolean(e.elementFromPoint)},targetingShadow:function(e){var t=this.shadow(e);if(this.canTarget(t))return t},olderShadow:function(e){var t=e.olderShadowRoot;if(!t){var i=e.querySelector("shadow");i&&(t=i.olderShadowRoot)}return t},allShadows:function(e){for(var t=[],i=this.shadow(e);i;)t.push(i),i=this.olderShadow(i);return t},searchRoot:function(e,t,i){if(e){var n,o,r=e.elementFromPoint(t,i);for(o=this.targetingShadow(r);o;){if(n=o.elementFromPoint(t,i)){var s=this.targetingShadow(n);return this.searchRoot(s,t,i)||n}o=this.olderShadow(o)}return r}},owner:function(e){for(var t=e;t.parentNode;)t=t.parentNode;return t.nodeType!==Node.DOCUMENT_NODE&&t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(t=document),t},findTarget:function(e){var t=e.clientX,i=e.clientY,n=this.owner(e.target);return n.elementFromPoint(t,i)||(n=document),this.searchRoot(n,t,i)}},b=Array.prototype.forEach.call.bind(Array.prototype.forEach),S=Array.prototype.map.call.bind(Array.prototype.map),w=Array.prototype.slice.call.bind(Array.prototype.slice),T=Array.prototype.filter.call.bind(Array.prototype.filter),P=window.MutationObserver||window.WebKitMutationObserver,E="[touch-action]",F={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};i.prototype={watchSubtree:function(e){this.observer&&y.canTarget(e)&&this.observer.observe(e,F)},enableOnSubtree:function(e){this.watchSubtree(e),e===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(e)},installNewSubtree:function(e){b(this.findElements(e),this.addElement,this)},findElements:function(e){return e.querySelectorAll?e.querySelectorAll(E):[]},removeElement:function(e){this.removeCallback(e)},addElement:function(e){this.addCallback(e)},elementChanged:function(e,t){this.changedCallback(e,t)},concatLists:function(e,t){return e.concat(w(t))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(e){return e.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(e){var t=S(e,this.findElements,this);return t.push(T(e,this.isElement)),t.reduce(this.concatLists,[])},mutationWatcher:function(e){e.forEach(this.mutationHandler,this)},mutationHandler:function(e){if("childList"===e.type){var t=this.flattenMutationTree(e.addedNodes);t.forEach(this.addElement,this);var i=this.flattenMutationTree(e.removedNodes);i.forEach(this.removeElement,this)}else"attributes"===e.type&&this.elementChanged(e.target,e.oldValue)}};var A=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],D="",x=window.PointerEvent||window.MSPointerEvent,O=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,N=I.pointermap,M=25,V=[1,4,2,8,16],k=!1;try{k=1===new MouseEvent("test",{buttons:1}).buttons}catch(e){}var B,R={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(e){I.listen(e,this.events)},unregister:function(e){I.unlisten(e,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(e){for(var t,i=this.lastTouches,n=e.clientX,o=e.clientY,r=0,s=i.length;r<s&&(t=i[r]);r++){var a=Math.abs(n-t.x),l=Math.abs(o-t.y);if(a<=M&&l<=M)return!0}},prepareEvent:function(e){var t=I.cloneEvent(e),i=t.preventDefault;return t.preventDefault=function(){e.preventDefault(),i()},t.pointerId=this.POINTER_ID,t.isPrimary=!0,t.pointerType=this.POINTER_TYPE,t},prepareButtonsForMove:function(e,t){var i=N.get(this.POINTER_ID);0!==t.which&&i?e.buttons=i.buttons:e.buttons=0,t.buttons=e.buttons},mousedown:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=N.get(this.POINTER_ID),i=this.prepareEvent(e);k||(i.buttons=V[i.button],t&&(i.buttons|=t.buttons),e.buttons=i.buttons),N.set(this.POINTER_ID,e),t&&0!==t.buttons?I.move(i):I.down(i)}},mousemove:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);k||this.prepareButtonsForMove(t,e),t.button=-1,N.set(this.POINTER_ID,e),I.move(t)}},mouseup:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=N.get(this.POINTER_ID),i=this.prepareEvent(e);if(!k){var n=V[i.button];i.buttons=t?t.buttons&~n:0,e.buttons=i.buttons}N.set(this.POINTER_ID,e),i.buttons&=~V[i.button],0===i.buttons?I.up(i):I.move(i)}},mouseover:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);k||this.prepareButtonsForMove(t,e),t.button=-1,N.set(this.POINTER_ID,e),I.enterOver(t)}},mouseout:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);k||this.prepareButtonsForMove(t,e),t.button=-1,I.leaveOut(t)}},cancel:function(e){var t=this.prepareEvent(e);I.cancel(t),this.deactivateMouse()},deactivateMouse:function(){N.delete(this.POINTER_ID)}},L=I.captureInfo,H=y.findTarget.bind(y),z=y.allShadows.bind(y),j=I.pointermap,G=2500,U=200,Y="touch-action",X={events:["touchstart","touchmove","touchend","touchcancel"],register:function(e){B.enableOnSubtree(e)},unregister:function(){},elementAdded:function(e){var t=e.getAttribute(Y),i=this.touchActionToScrollType(t);i&&(e._scrollType=i,I.listen(e,this.events),z(e).forEach(function(e){e._scrollType=i,I.listen(e,this.events)},this))},elementRemoved:function(e){e._scrollType=void 0,I.unlisten(e,this.events),z(e).forEach(function(e){e._scrollType=void 0,I.unlisten(e,this.events)},this)},elementChanged:function(e,t){var i=e.getAttribute(Y),n=this.touchActionToScrollType(i),o=this.touchActionToScrollType(t);n&&o?(e._scrollType=n,z(e).forEach(function(e){e._scrollType=n},this)):o?this.elementRemoved(e):n&&this.elementAdded(e)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(e){var t=e,i=this.scrollTypes;return"none"===t?"none":t===i.XSCROLLER?"X":t===i.YSCROLLER?"Y":i.SCROLLER.exec(t)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(e){return this.firstTouch===e.identifier},setPrimaryTouch:function(e){(0===j.size||1===j.size&&j.has(1))&&(this.firstTouch=e.identifier,this.firstXY={X:e.clientX,Y:e.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(e){e.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var e=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(e,U)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(e){var t=0;return"touchstart"!==e&&"touchmove"!==e||(t=1),t},touchToPointer:function(e){var t=this.currentTouchEvent,i=I.cloneEvent(e),n=i.pointerId=e.identifier+2;i.target=L[n]||H(i),i.bubbles=!0,i.cancelable=!0,i.detail=this.clickCount,i.button=0,i.buttons=this.typeToButtons(t.type),i.width=e.radiusX||e.webkitRadiusX||0,i.height=e.radiusY||e.webkitRadiusY||0,i.pressure=e.force||e.webkitForce||.5,i.isPrimary=this.isPrimaryTouch(e),i.pointerType=this.POINTER_TYPE,i.altKey=t.altKey,i.ctrlKey=t.ctrlKey,i.metaKey=t.metaKey,i.shiftKey=t.shiftKey;var o=this;return i.preventDefault=function(){o.scrolling=!1,o.firstXY=null,t.preventDefault()},i},processTouches:function(e,t){var i=e.changedTouches;this.currentTouchEvent=e;for(var n,o=0;o<i.length;o++)n=i[o],t.call(this,this.touchToPointer(n))},shouldScroll:function(e){if(this.firstXY){var t,i=e.currentTarget._scrollType;if("none"===i)t=!1;else if("XY"===i)t=!0;else{var n=e.changedTouches[0],o=i,r="Y"===i?"X":"Y",s=Math.abs(n["client"+o]-this.firstXY[o]),a=Math.abs(n["client"+r]-this.firstXY[r]);t=s>=a}return this.firstXY=null,t}},findTouch:function(e,t){for(var i,n=0,o=e.length;n<o&&(i=e[n]);n++)if(i.identifier===t)return!0},vacuumTouches:function(e){var t=e.touches;if(j.size>=t.length){var i=[];j.forEach(function(e,n){if(1!==n&&!this.findTouch(t,n-2)){var o=e.out;i.push(o)}},this),i.forEach(this.cancelOut,this)}},touchstart:function(e){this.vacuumTouches(e),this.setPrimaryTouch(e.changedTouches[0]),this.dedupSynthMouse(e),this.scrolling||(this.clickCount++,this.processTouches(e,this.overDown))},overDown:function(e){j.set(e.pointerId,{target:e.target,out:e,outTarget:e.target}),I.enterOver(e),I.down(e)},touchmove:function(e){this.scrolling||(this.shouldScroll(e)?(this.scrolling=!0,this.touchcancel(e)):(e.preventDefault(),this.processTouches(e,this.moveOverOut)))},moveOverOut:function(e){var t=e,i=j.get(t.pointerId);if(i){var n=i.out,o=i.outTarget;I.move(t),n&&o!==t.target&&(n.relatedTarget=t.target,t.relatedTarget=o,n.target=o,t.target?(I.leaveOut(n),I.enterOver(t)):(t.target=o,t.relatedTarget=null,this.cancelOut(t))),i.out=t,i.outTarget=t.target}},touchend:function(e){this.dedupSynthMouse(e),this.processTouches(e,this.upOut)},upOut:function(e){this.scrolling||(I.up(e),I.leaveOut(e)),this.cleanUpPointer(e)},touchcancel:function(e){this.processTouches(e,this.cancelOut)},cancelOut:function(e){I.cancel(e),I.leaveOut(e),this.cleanUpPointer(e)},cleanUpPointer:function(e){j.delete(e.pointerId),this.removePrimaryPointer(e)},dedupSynthMouse:function(e){var t=R.lastTouches,i=e.changedTouches[0];if(this.isPrimaryTouch(i)){var n={x:i.clientX,y:i.clientY};t.push(n);var o=function(e,t){var i=e.indexOf(t);i>-1&&e.splice(i,1)}.bind(null,t,n);setTimeout(o,G)}}};B=new i(X.elementAdded,X.elementRemoved,X.elementChanged,X);var W,Z,K=I.pointermap,$=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,q={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(e){I.listen(e,this.events)},unregister:function(e){I.unlisten(e,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(e){var t=e;return $&&(t=I.cloneEvent(e),t.pointerType=this.POINTER_TYPES[e.pointerType]),t},cleanup:function(e){K.delete(e)},MSPointerDown:function(e){K.set(e.pointerId,e);var t=this.prepareEvent(e);I.down(t)},MSPointerMove:function(e){var t=this.prepareEvent(e);I.move(t)},MSPointerUp:function(e){var t=this.prepareEvent(e);I.up(t),this.cleanup(e.pointerId)},MSPointerOut:function(e){var t=this.prepareEvent(e);I.leaveOut(t)},MSPointerOver:function(e){var t=this.prepareEvent(e);I.enterOver(t)},MSPointerCancel:function(e){var t=this.prepareEvent(e);I.cancel(t),this.cleanup(e.pointerId)},MSLostPointerCapture:function(e){var t=I.makeEvent("lostpointercapture",e);I.dispatchEvent(t)},MSGotPointerCapture:function(e){var t=I.makeEvent("gotpointercapture",e);I.dispatchEvent(t)}},J=window.navigator;J.msPointerEnabled?(W=function(e){l(e),c(this),d(e)&&this.msSetPointerCapture(e)},Z=function(e){l(e),this.msReleasePointerCapture(e)}):(W=function(e){l(e),c(this),d(e)&&I.setCapture(e,this)},Z=function(e){l(e),I.releaseCapture(e,this)}),s(),a(),u();var Q={dispatcher:I,Installer:i,PointerEvent:e,PointerMap:m,targetFinding:y};return Q})},function(e,t,i){var n=i(39).defineClass,o=i(44),r=i(43);i(61),i(62),i(63);var s="1.2";e.exports=new(n(o,function(){this.constructor.superClass.call(this,"solo",["OnReady","OnSoloLoadComplete","OnObjectVMEnter","OnObjectVMOut","OnObjectVMMove","OnObjectVMHit","Click","DblClick","MouseDown","MouseMove","OnMouseEnter","MouseUp","OnMouseOut","OnSceneLoaded","OnSceneUnloaded","OnAnchor","OnSeekChanged"])},{create:function(e){var t=this;return e[this.type]=new(n(r,function(n,o){this.constructor.superClass.call(this,n),i(59);var r=document.createElement("div"),s="";s+='<div style="height: 100%;">',s+='<canvas oncontextmenu="event.preventDefault()" touch-action="none"></canvas>',s+='<input type="range" min="0" max="100" value="0" step="0.1" style="width:99%; margin:0 1mm; height:7mm; padding:0; position: absolute; bottom: 0;">',s+="</div>",r.innerHTML=s;var a=r.firstChild,l=a.firstChild;a.setAttribute("id",n.getNextId()),this.instance=a,this.canvas=l,this.range=l.nextSibling,this.range.style.display="none",this.canvas.style.display="none",this.hide(),o.appendChild(a);var c=[0,1,4,2],d=[1,4,2,8,16],u=function(e,t){var i,n=+(e.shiftKey&&1)|+(e.ctrlKey&&2)|+(e.altKey&&4);i=t&&void 0!==e.buttons?e.buttons:void 0!==e.which?c[e.which]:d[e.button];var o=e.target||e.srcElement,r=o.getBoundingClientRect(),s=e.clientX-r.left,a=e.clientY-r.top,l=[i,n,s,a];return l},p=function(i,n,o,r){e[t.type].trigger(i,{raw:o||[],src:n},r)},h=function(e,t){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},f=3,m=function(e,t){return!(!e||!t)&&h(e.slice(2),t.slice(2))>f},v=this,_=a.clientWidth,g=a.clientHeight;l.height=g,l.width=_,this.overObject=null;var C=null,I=navigator.userAgent.lastIndexOf("Firefox")>0,y=function(){I&&(C=document.createElement("div"),C.style.position="absolute",C.style.top="0",C.style.bottom="0",C.style.left="0",C.style.right="0",C.style.zIndex=1e4,C.onmousemove=function(e){return e=e||window.event,document.body.removeChild(e.target),C=null,e.preventDefault(),e.stopPropagation(),!1},setTimeout(function(){C&&(document.body.removeChild(C),C=null)},100),document.body.appendChild(C))};if(this.eventHandlers={webglcontextlost:function(e){alert("WebGL context lost. You will need to reload the page."),e.preventDefault()},pointermove:function(e){var t=e.target||e.srcElement,i=t.getBoundingClientRect(),n=e.clientX-i.left,o=e.clientY-i.top,r=u(e,!0),s=v.overObject?v.overObject.handle:null;if(0===r[0]){var a=v.solo.app.pickObject(n,o,v.FEATURE_PICK_TOPMOST);a&&p("OnObjectVMMove",e,[a.handle,a.name],e.target);var l=a?a.handle:null;s!==l&&(v.overObject&&(y(),p("OnObjectVMOut",e,[s,v.overObject.name],e.target)),a&&p("OnObjectVMEnter",e,[l,a.name],e.target)),v.overObject=a}else v.overObject&&(y(),p("OnObjectVMOut",e,[s,v.overObject.name],e.target),v.overObject=null);p("MouseMove",e,r)},pointerenter:function(e){C||p("OnMouseEnter",e)},pointerout:function(e){C||(v.overObject&&(p("OnObjectVMOut",e,[v.overObject.handle,v.overObject.name],e.target),v.overObject=null,y()),p("OnMouseOut",e))},pointerdown:function(e){this.lastMouseArguments=u(e),p("MouseDown",e,this.lastMouseArguments)},pointerup:function(e){var t=e.target||e.srcElement,i=t.getBoundingClientRect(),n=e.clientX-i.left,o=e.clientY-i.top,r=u(e),s=v.solo.app.pickObject(n,o,v.FEATURE_PICK_TOPMOST);m(this.lastMouseArguments,r)||s&&p("OnObjectVMHit",e,[s.handle,s.name].concat(r),e.target);var a=v.overObject?v.overObject.handle:null,l=s?s.handle:null;a!==l&&(v.overObject&&(y(),p("OnObjectVMOut",e,[a,v.overObject.name],e.target)),s&&p("OnObjectVMEnter",e,[l,s.name],e.target)),v.overObject=s,p("MouseUp",e,r),delete this.lastMouseArguments},click:function(e){p("Click",e)},dblclick:function(e){p("DblClick",e)}},navigator.pointerEnabled===!1)for(var b in this.eventHandlers)0===b.indexOf("pointer")&&(this.eventHandlers[b.replace(/^pointer/,"mouse")]=this.eventHandlers[b],delete this.eventHandlers[b]);this.attach()},{version:function(){if(this.isValid()&&this.solo)return"Cortona3D Solo ver. "+this.solo.app.version()+",  Component ver. "+s},attach:function(){var e,t=this.canvas;if(t)for(e in this.eventHandlers)t.addEventListener(e,this.eventHandlers[e],!1);return this},detach:function(){var e,t=this.canvas;if(t)for(e in this.eventHandlers)t.removeEventListener(e,this.eventHandlers[e],!1);this.didChangeLayout&&window.removeEventListener("resize",this.didChangeLayout,!1);try{this.solo.core.abort()}catch(e){}return this},load:function(e){var t=this,n=i(64);return n.path(i.p),n("Cortona3DSolo.js",function(){function n(e){this.name="LoadingError",this.message=e||""}var o=t.solo=window.Cortona3DSolo;if(!o||!o.app)throw n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,new n("Unable to load "+(i.p?i.p:".")+"Cortona3DSolo.js");t.trigger("OnSoloLoadComplete");var r=0;"object"==typeof window.chrome&&"win"===window.navigator.platform.substr(0,3).toLowerCase()&&(r|=o.app.DISABLE_VERTEX_ARRAY_OBJECT_OES),o.app.initialize(t.canvas,e),o.app.onReady=function(){o.app.configureInstance(r),t.trigger("OnReady")};var s;o.app.firstFrameDidArrive=function(){return s?(o.app.ui.showPanels(!0),t.defaultBackgroundColors&&o.app.setDefaultBackgroundColors(t.defaultBackgroundColors),void t.trigger("OnSceneLoaded",{raw:[!0],src:s})):void(s=null)},o.app.didFinishLoadDocument=function(e){function i(e){var i=this.value/100;t.trigger("OnSeekChanged",{raw:[i,"change"==e.type],src:e})}t.attach();var n=null===s;s=e,n&&o.app.firstFrameDidArrive.call(o.app),o.core.canvas.style.display="block",o.app.ui.showPanels(!1),t.didChangeLayout=function(){if(o.core.isRuntimeReady()){var e=t.instance,i=e.clientWidth,n=Math.max(0,e.clientHeight-t.range.offsetHeight);o.app.resize(i,n)}},window.addEventListener("resize",t.didChangeLayout,!1),t.range.value=0,t.range.addEventListener("input",i,!1),t.range.addEventListener("change",i,!1),t.didChangeLayout()},o.app.didFailLoadDocument=function(e){o.core.printErr(e),t.reason=e,t.trigger("OnSceneLoaded",{raw:[!1],src:e})}}),this},unload:function(){return this},hide:function(){this.instance&&(this.instance.style.display="none"),this.solo&&this.solo.app.ui.showPanels(!1)},show:function(){this.instance&&(this.instance.style.display="block"),this.solo&&this.solo.app.ui.showPanels(!0);var e=this.instance,t=this.canvas;return t.height=e.clientHeight,t.width=e.clientWidth,this.didChangeLayout&&this.didChangeLayout(),this},toggleRangeControl:function(e){"undefined"==typeof e&&(e="none"==this.range.style.display),this.range.style.display=e?"block":"none",this.didChangeLayout&&this.didChangeLayout()}}))(this,e.container),e[this.type]}}))},function(e,t,i){e.exports=i.p+"../solo/Cortona3DSolo.js"},function(e,t,i){e.exports=i.p+"../solo/Cortona3DSoloCore.js"},function(e,t,i){e.exports=i.p+"../solo/Cortona3DSolo.js.mem"},function(e,t,i){var n,o;!function(r,s){"undefined"!=typeof e&&e.exports?e.exports=s():(n=s,o="function"==typeof n?n.call(t,i,t,e):n,!(void 0!==o&&(e.exports=o)))}("$script",function(){function e(e,t){for(var i=0,n=e.length;i<n;++i)if(!t(e[i]))return l;return 1}function t(t,i){e(t,function(e){return!i(e)})}function i(r,s,a){function l(e){return e.call?e():p[e]}function d(){if(!--g){p[_]=1,v&&v();for(var i in f)e(i.split("|"),l)&&!t(f[i],l)&&(f[i]=[])}}r=r[c]?r:[r];var u=s&&s.call,v=u?s:a,_=u?r.join(""):s,g=r.length;return setTimeout(function(){t(r,function e(t,i){return null===t?d():(i||/^https?:\/\//.test(t)||!o||(t=t.indexOf(".js")===-1?o+t+".js":o+t),m[t]?(_&&(h[_]=1),2==m[t]?d():setTimeout(function(){e(t,!0)},0)):(m[t]=1,_&&(h[_]=1),void n(t,d)))})},0),i}function n(e,t){var i,n=s.createElement("script");n.onload=n.onerror=n[u]=function(){n[d]&&!/^c|loade/.test(n[d])||i||(n.onload=n[u]=null,i=1,m[e]=2,t())},n.async=1,n.src=r?e+(e.indexOf("?")===-1?"?":"&")+r:e,a.insertBefore(n,a.lastChild)}var o,r,s=document,a=s.getElementsByTagName("head")[0],l=!1,c="push",d="readyState",u="onreadystatechange",p={},h={},f={},m={};return i.get=n,i.order=function(e,t,n){!function o(r){r=e.shift(),e.length?i(r,o):i(r,t,n)}()},i.path=function(e){o=e},i.urlArgs=function(e){r=e},i.ready=function(n,o,r){n=n[c]?n:[n];var s=[];return!t(n,function(e){p[e]||s[c](e)})&&e(n,function(e){return p[e]})?o():!function(e){f[e]=f[e]||[],f[e][c](o),r&&r(s)}(n.join("|")),i},i.done=function(e){i([null],e)},i})},function(e,t,i){var n=i(39).defineClass,o=i(39).fromHTMLColor,r=i(44),s=i(66);e.exports=new(n(r,function(){this.constructor.superClass.call(this,"viewer2d",["HotspotHit","HotspotEnter","HotspotLeave","HotspotMenu","HotspotMenuSelect","DocumentComplete"])},{create:function(e){return new(n(s,function(e,t){this.constructor.superClass.call(this,e,t,"CLSID:1D4A81CB-25A3-4EB7-A75E-4F8A5386D8F8","application/x-rapidview",e.events)},{getSVGSource:function(){var e="";return this.isValid()&&(e=this.instance.getSVGSource()),e},version:function(){if(this.isValid())return"Cortona2D Viewer "+this.instance.GetVersion()},highlight:function(e,t){var i=[],n=this.instance;try{i=n.GetHotspotIDs(e).toArray()}catch(e){}return i.forEach(function(e){n.HighlightHotspot(e,!0,o(t))}),this},unhighlight:function(e,t){var i=[],n=this.instance;try{i=n.GetHotspotIDs(e).toArray()}catch(e){}return i.forEach(function(e){n.HighlightHotspot(e,!1,o(t))}),this},select:function(e,t){return this.highlight(e,t),this},unselect:function(e,t){return this.unhighlight(e,t),this},reset:function(){return this.instance.ResetView(),this},scaleBy:function(e){return this}}))(this,e.container).attach()}}))},function(e,t,i){var n=i(39).defineClass,o=i(43),r=n(o,function(e,t,i,n,o){r.superClass.call(this,e);var s=!1,a=document.createElement("div");a.innerHTML='<object type="application/x-oleobject" classid="'+i+'"><embed type="'+n+'"></object><div class="cortona3d-plugin-disabled">Plugin "'+n+'" not installed or disabled</div>',a.style.position="absolute",a.style.width=a.style.height="1px",a.style.marginLeft="-10000px",t.appendChild(a);var l=a.firstChild;void 0===l.BackColor&&(l=l.firstChild),void 0===l.BackColor&&(l=a.lastChild,s=!0),t.removeChild(a),l.id=e.getNextId(),l.style.position="absolute",this.invalid=s,this.instance=l,this.events=s?[]:o,this.hide(),t.appendChild(l)},{attach:function(){var e=this.instance,t=this,i=e.getAttribute("id");return this.events.forEach(function(n){var o=i+"_"+n;if("function"!=typeof window[o]&&(window[o]=function(){return t.trigger(n,{raw:Array.prototype.slice.call(arguments),src:window.event})}),"OBJECT"===e.tagName&&!document.getElementById(o)){var r=document.createElement("script");r.htmlFor=e.getAttribute("id"),r.event=n+"()",r.id=o,r.text="return "+o+".apply(this, arguments)";var s=document.getElementsByTagName("head")[0];s.appendChild(r)}}),this},detach:function(){var e=this.instance,t=e.getAttribute("id");return this.events.forEach(function(i){var n=t+"_"+i;if("function"==typeof window[n]&&delete window[n],"OBJECT"===e.tagName){var o=document.getElementById(n);o&&o.parentNode.removeChild(o)}}),this},load:function(e){return this.isValid()&&(this.instance.src=e),this},unload:function(){return this.isValid()&&(this.instance.src="",this.trigger("OnSceneUnloaded")),this}});e.exports=r},function(e,t,i){var n=i(39).defineClass,o=(i(39).fromHTMLColor,i(44)),r=i(66);e.exports=new(n(o,function(){this.constructor.superClass.call(this,"viewer3d",["Click","DblClick","MouseDown","MouseMove","OnMouseEnter","MouseUp","OnMouseOut","OnDrag","OnDrop","OnKeyDown","OnKeyUp","OnSceneLoaded","OnSceneUnloaded","OnAnchor","OnCameraMove","OnFrameRateMeasured"]),this.skins={default:"{1706B265-E103-4332-9871-7FEE6C37C699}","default-5.1":"{04B2095C-3E09-4519-B5D4-838BDC622661}","default-orange":"{0009E838-FFDF-4f38-94DB-A2449FB3FB3C}","default-gray":"{0413045F-CE7E-4cc6-9D30-94DF4BF8AA9A}",cad:"{46BB95BF-8EB4-481a-A1EF-50D43FC32B9D}","examine-tilt":"{75B359F4-C1D2-4E21-BC36-F699BD1792BA}","examine-nontilt":"{0650E9E3-1999-45C1-A24F-50BBE472326B}",review:"{7F82003E-34AE-4F5A-9470-4891DC8FDFCB}"}},{create:function(e){return new(n(r,function(e,t){this.constructor.superClass.call(this,e,t,"CLSID:86A88967-7A20-11D2-8EDA-00600818EDB1","application/x-cortona",e.events)},{version:function(){if(this.isValid())return"Cortona3D Viewer "+(this.instance.Version||6)},unload:function(){this.isValid()&&(this.instance.Engine.RootNodes.Clear(),this.trigger("OnSceneUnloaded",[]))}}))(this,e.container).attach()}}))},function(module,exports,__webpack_require__){function IPCTable(e){this.HIDE_UNUSED_ROWS=!("undefined"!=typeof trueFullTable&&trueFullTable),this.block_fit=!1,this.unused_rows_processed=!1,this.isBlocked=!0,this.table=e,this.items=null,this.selectedItems=[],this.hiddenItems=[],this.changedMaterials={items:{},list:[]},this.cMenu=new ContextMenu(document.getElementById("menu_container")),this._last_over_node=null,this._last_over=null,this._last_clicked_row=0,this._last3Dclicked=null,this.isFullTable=!1,this.isTransferedIPCData=!1,this.attachingRows=[]}function IPCTable_multifilter(e,t,i){function n(e,t){for(var i=0;i<e.length;i++)for(var n=0;n<t.length;n++)if(e[i]==t[n])return!0;return!1}var o,r=e.length>0,s=t.length>0,a=i.length>0;for(a?ipcApi.hide_background_geometry():ipcApi.show_background_geometry(),ipcApi.setAutoRefreshOff(),o=0;o<this.items.length;o++)this.items[o].setFilteredWithoutChildren(!1);if(ipcApi.restoreAutoRefresh(),r||s||a){ipcApi.setAutoRefreshOff();var l=[],c=[],d=[];for(o=0;o<e.length;o++)l.push(modelsList[e[o]]);for(o=0;o<t.length;o++)c.push(usageList[t[o]]);for(o=0;o<i.length;o++)d.push(sbList[i[o]]);var u,p=ipc_data.dplist;if(a)for(o=0;o<p.length;o++)if(u=n(p[o].filter.sb,d),u&&r&&p[o].filter.modelapply.length>0&&(u=n(p[o].filter.modelapply,l)),u&&s&&p[o].filter.usage.length>0&&(u=n(p[o].filter.usage,c)),u)this.items[o].setFiltered(!1);else{for(var h=!1,f=0;f<this.items[o].parents.length;f++)if(!this.items[o].parents[f].filtered){h=!0;break}h?(this.items[o].filtered=!0,this.items[o].setRowVisibility(!1)):this.items[o].setFilteredWithoutChildren(!0)}else for(o=0;o<p.length;o++)u=!0,r&&p[o].filter.modelapply.length>0&&(u=n(p[o].filter.modelapply,l)),u&&s&&p[o].filter.usage.length>0&&(u=n(p[o].filter.usage,c)),this.items[o].setFilteredWithoutChildren(!u);this._updAttRows(),ipcApi.restoreAutoRefresh()}}function IPCTable_filter(e,t,i){var n,o;for(0===i?ipcApi.show_background_geometry():ipcApi.hide_background_geometry(),ipcApi.setAutoRefreshOff(),n=0;n<this.items.length;n++)this.items[n].setFilteredWithoutChildren(!1);if(ipcApi.setAutoRefreshOn(),0!==e||0!==t||0!==i){ipcApi.setAutoRefreshOff();
var r,s,a,l,c=e>0?modelsList[e-1]:0,d=t>0?usageList[t-1]:0,u=i>0?sbList[i-1]:0,p=ipc_data.dplist;if(i>0)for(n=0;n<p.length;n++){for(l=p[n].filter.sb,r=!0,o=0;o<l.length;o++)if(l[o]==u){r=!1;break}if(r){for(var h=!1,f=0;f<this.items[n].parents.length;f++)if(!this.items[n].parents[f].filtered){h=!0;break}h?(this.items[n].filtered=!0,this.items[n].setRowVisibility(!1)):this.items[n].setFilteredWithoutChildren(!0)}else this.items[n].setFiltered(!1)}else for(n=0;n<p.length;n++){if(r=!1,!r){if(t>0)for(s=p[n].filter.usage,o=0;o<s.length;o++){if(s[o]==d){r=!1;break}r=!0}if(e>0&&!r)for(a=p[n].filter.modelapply,o=0;o<a.length;o++){if(a[o]==c){r=!1;break}r=!0}}this.items[n].setFilteredWithoutChildren(r)}this._updAttRows(),ipcApi.setAutoRefreshOn()}}function IPCTable_fitToItems(e){if(!this.block_fit){for(var t=[],i=0;i<e.length;i++){t.push(e[i].part);for(var n=0;n<e[i].allChildren.length;n++)t.push(e[i].allChildren[n].part)}ipcApi.fitToParts(t,"")}}function IPCTable__onSelectionChanged(){if("on_selection_changed"in workTable){for(var e=[],t=0;t<this.selectedItems.length;t++)e.push(this.selectedItems[t]);workTable.on_selection_changed(e)}}function IPCTable__transformIPCDataToIndexedFormat(){var e,t;if(!this.isTransferedIPCData){this.isTransferedIPCData=!0,t=ipc_data.dplist;var i=ipc_data.views,n={};for(e=0;e<t.length;e++)""!==t[e].id&&(n[t[e].id]=e);for(e=0;e<t.length;e++)t[e].parent=t[e].parent in n?n[t[e].parent]:-1;for(var o=0;o<i.length;o++)for(t=i[o].items,e=0;e<t.length;e++)t[e]=t[e]in n?n[t[e]]:-1}}function IPCTable_generateItems(){if(!this.items){this._transformIPCDataToIndexedFormat(),this.items=[];var e,t,i=function(e){e=e||window.event,workTable._onItemClick(this.sectionRowIndex,e)},n=function(){workTable._onItemDblClick(this.sectionRowIndex)},o=function(){workTable._onItemOver(this.sectionRowIndex)},r=function(){workTable._onItemOut(this.sectionRowIndex)},s=function(){workTable._onChkBox(this.parentNode.parentNode.sectionRowIndex)},a=function(){workTable._onCancelEvent()},l=function(e){return e=e||window.event,workTable._onTableContextMenu(this.sectionRowIndex,e),!1},c=ipc_data.dplist;if(options.multiLink){var d={};for(e=0;e<c.length;e++)for(c[e].dbls={},t=0;t<c[e].vrmlnodes.length;t++){var u=c[e].vrmlnodes[t];u in d?d[u].push(e):d[u]=[e]}for(e=0;e<c.length;e++)for(t=0;t<c[e].vrmlnodes.length;t++){var p=d[c[e].vrmlnodes[t]];if(p.length>1)for(var h=0;h<p.length;h++)p[h]!=e&&(c[e].dbls[p[h]]=1)}}for(e=0;e<c.length;e++){var f=new IPCItem(this,e);this.items.push(f),f.tr.onclick=i,f.tr.ondblclick=n,f.tr.onmouseover=o,f.tr.onmouseout=r,f.chkBox.onclick=s,f.chkBox.ondblclick=a,f.tr.oncontextmenu=l,this._checkUnusedItem(f),f.isAttachingKeyword&&(f.unused=!1,this.attachingRows.push(f))}}}function IPCTable_setBlock(e){this.isBlocked=e}function IPCTable_onOver3D(e){if(this.items&&!this.isBlocked&&!this.cMenu.checkIsOpen()&&this._last_over_node!=e){if(e){var t=this.getItem(e.tag);if(!t.presentInSheet||t.filtered)for(var i=0;i<t.parents.length&&(!(t.parents[i].presentInSheet&&t.parents[i].state>0)||t.parents[i].filtered||(t=t.parents[i],options.multiLink));i++);this._onItemOver(t.index),ipcApi.tooltipOver3D.setTooltipHTML(t.getTooltipText())}else this._onItemOver(null),ipcApi.tooltipOver3D.setTooltipHTML("");this._last_over_node=e}}function IPCTable_onClick3D(e,t,i,n,o){var r,s;if(this.items&&!this.isBlocked&&!this.cMenu.checkIsOpen())if(2==t&&i<4){if(s=null,this.cMenu.close(),this.onOver3D(e),e){if(s=this.getItem(e.tag),!s.presentInSheet||s.filtered)for(r=0;r<s.parents.length&&(!(s.parents[r].presentInSheet&&s.parents[r].state>0)||s.parents[r].filtered||(s=s.parents[r],options.multiLink));r++);document.getElementById("tbdContainer").scrollTop=s.tr.offsetTop}ipcApi.tooltipOver3D.hide(),this.cMenu.show(s,n,o,viewer3DNode,!0)}else if(e){if(i<4){if(s=this.getItem(e.tag),!s.presentInSheet||s.filtered)for(r=0;r<s.parents.length&&(!(s.parents[r].presentInSheet&&s.parents[r].state>0)||s.parents[r].filtered||(s=s.parents[r],options.multiLink));r++);if(1==i&&this._last3Dclicked&&this._last3Dclicked.item==s&&(s.selected||s.subselected)){for(var a=null;s.parents.length>this._last3Dclicked.n&&!a;){this._last3Dclicked.n++;var l=s.parents[this._last3Dclicked.n];l&&l.state>0&&l.presentInSheet&&!l.filtered&&(s=l,a=l)}if(!a)return}else this._last3Dclicked={item:s,n:-1};document.getElementById("tbdContainer").scrollTop=s.tr.offsetTop,this._onClick(s,2==i,!1,!0)}}else 0===i&&this.clearSelection()}function IPCTable_onOver2D(e){for(var t=0;t<this.items.length;t++)if(this.items[t].isEqual(e)&&!this.items[t].filtered&&!this.items[t].unused&&(this.items[t].presentInSheet||this.isFullTable))return this._onItemOver(t),void C2D_setTooltip(e,this.items[t].getTooltipText().replace(/<br>/g,"\n"));document.getElementById("cContainer").removeAttribute("title"),this._onItemOver(null)}function IPCTable_getItemBy2DHotspot(e){for(var t=0;t<this.items.length;t++)if(this.items[t].isEqual(e)&&!this.items[t].unused)return this.items[t];return null}function IPCTable_onClick2D(e,t){for(var i=0;i<this.items.length;i++)if(this.items[i].isEqual(e)&&!this.items[i].filtered)return document.getElementById("tbdContainer").scrollTop=this.items[i].tr.offsetTop,this._onClick(this.items[i],t>1,!1,!1),!0;return this._onItemOver(null),t<2&&this.clearSelection(),!1}function IPCTable__onItemClick(e,t){if(this.items&&!this.isBlocked){try{var i=isMSIE?t.srcElement:t.target;if("a"==i.nodeName.toLowerCase()&&i.href.length>0)return void(""!==i.hash&&setTimeout(function(){workTable.gotoItem(i.hash.substring(1))},100))}catch(e){}var n=this.getItem(e),o=t.ctrlKey,r=t.shiftKey;if(!n.presentInSheet)return void(o||this.clearSelection());this._last3Dclicked=null,r||(this._last_clicked_row=e),this._onClick(n,o,r,!1)}}function IPCTable__onClick(e,t,i,n){if(e.presentInSheet)if(t)ipcApi.setAutoRefreshOff(),e.selected?e.select(!1):e.subselected?e.select(!n):e.select(!0),ipcApi.setAutoRefreshOn();else if(i){var o=e.index;if(o!=this._last_clicked_row){this.clearSelection();var r=this._last_clicked_row,s=o;r>s&&(r=o,s=this._last_clicked_row),ipcApi.setAutoRefreshOff();for(var a=r;a<=s;a++){var l=this.getItem(a);l.presentInSheet&&l.isRowVisible&&l.select(!0)}ipcApi.setAutoRefreshOn()}}else e.selected&&1==this.selectedItems.length?this.clearSelection():(this.clearSelection(),ipcApi.setAutoRefreshOff(),e.select(!0),ipcApi.setAutoRefreshOn())}function IPCTable__onItemDblClick(e){if(!this.isBlocked&&!this.block_fit){var t=this.getItem(e);t.state>0&&t.presentInSheet&&t.fit();try{window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}catch(e){}}}function IPCTable__onItemOver(e){if(!this.isBlocked&&!this.cMenu.checkIsOpen()&&this._last_over!=e){var t=this._last_over;if(null!==t){ipcApi.setAutoRefreshOff();try{this.getItem(t).hlight(!1)}catch(e){}ipcApi.setAutoRefreshOn(),ipcApi.doRefresh()}null!==e&&(ipcApi.setAutoRefreshOff(),this.getItem(e).hlight(!0),ipcApi.setAutoRefreshOn()),this._last_over=e}}function IPCTable__onItemOut(e){this.isBlocked||this.cMenu.checkIsOpen()||this._last_over==e&&this._onItemOver(null)}function IPCTable__clearOverItem(){this.isBlocked||(ipcApi.setAutoRefreshOff(),null!==this._last_over&&this.getItem(this._last_over).hlight(!1),ipcApi.setAutoRefreshOn())}function IPCTable__onChkBox(e){if(!this.isBlocked){ipcApi.setAutoRefreshOff();var t=this.getItem(e);t.state>=0&&t.presentInSheet&&t.show(t.state<=0),window.event&&(window.event.cancelBubble=!0),ipcApi.setAutoRefreshOn()}}function IPCTable__onCancelEvent(){if(isMSIE){try{document.selection.empty()}catch(e){}window.event&&(window.event.cancelBubble=!0)}}function IPCTable__onTableContextMenu(e,t){var i=t.clientX,n=t.clientY;this.cMenu.close(),this._onItemOver(e);var o=this.getItem(e);ipcApi.tooltipOver3D.hide(),this.cMenu.show(o,i,n,document.body,!1)}function IPCTable__onContextMenuClose(){this.clearHighlight(),this.cMenu.isOver3D&&viewer3DNode.focus()}function IPCTable_contextMenuClose(){this.cMenu.close()}function IPCTable__checkUnusedItem(e){if(!this.HIDE_UNUSED_ROWS)return!1;if(e.__processed)return e.unused;for(var t=rightViews,i=e.index,n=0;n<t.length;n++)if(!t[n].hidden)for(var o=t[n],r=0;r<o.items.length;r++)if(o.items[r]==i)return e.__processed=!0,e.unused=!1,!1;return e.__processed=!0,e.unused=!0,!0}function IPCTable_setFullTable(e){this.isFullTable=e;for(var t=0;t<this.items.length;t++)this.items[t].filtered||this.items[t].unused||this.items[t].setRowVisibility(this.isFullTable||this.items[t].presentInSheet),this.items[t].updateCheckBox();this._updAttRows()}function IPCTable_update(){this.generateItems();for(var e=rightViews,t={},i=0;i<e.length;i++)if(e[i].id==current_view)for(var n=0;n<e[i].items.length;n++)t[e[i].items[n]]=!0;for(i=0;i<this.items.length;i++)this.items[i].presentInSheet=i in t||this.items[i].isAttachingKeyword,this.items[i].filtered||this.items[i].setRowVisibility(this.isFullTable||this.items[i].presentInSheet),this.items[i].update();for(i=0;i<this.items.length;i++)this.items[i].update2(),this.items[i].updateCheckBox();this._updAttRows(),this.hideSecondary()}function IPCTable_getItem(e){var t=this.items[e];if(options.multiLink&&!t.isRowVisible)for(var i in t.dpl_item.dbls)try{if(this.items[i].isRowVisible)return this.items[i]}catch(e){}return t}function IPCTable_clearSelection(){ipcApi.doRefresh(),ipcApi.setAutoRefreshOff(),this._sortSelection();for(var e=this.selectedItems,t=e.length-1;t>=0;t--)e[t].select(!1);ipcApi.restoreAutoRefresh()}function IPCTable_hideSecondary(){ipcApi.doRefresh(),ipcApi.setAutoRefreshOff();for(var e=0;e<this.items.length;e++)this.items[e].presentInSheet&&this.items[e].dpl_item.secondary&&this.items[e].show(!1);ipcApi.restoreAutoRefresh()}function IPCTable_showAll(){for(var e=[].concat(this.hiddenItems),t=0;t<e.length;t++)e[t].show(!0)}function IPCTable_resetMaterials(){for(var e=this.changedMaterials.list,t=0;t<e.length;t++)e[t].resetMaterial();this.changedMaterials={items:{},list:[]}}function IPCTable_clearHighlight(){this.cMenu.checkIsOpen()||(this._clearOverItem(),this._last_over_node=null,this._last_over=null)}function IPCTable_reset(){this.clearSelection(),this._clearOverItem(),this.filter(0,0,0),this._last_over_node=null,this._last_over=null,this.showAll(),this.resetMaterials()}function IPCTable_toExcel(){function e(e){return e.replace(/(^ +| $)/gm,"")}if(!this.isBlocked)try{var t,i,n,o=new ActiveXObject("Excel.Application");o.Visible=!1;var r=o.Workbooks.Add(),s=r.ActiveSheet,a=M_TITLE;"GENERIC"!=specType&&(a=M_CSN),"ITEM"==specType&&(a=M_TOOLNBR);try{s.Name=a}catch(e){s.Name="ITEM"==specType?"ITEM":"IPC"}var l="undefined"!=typeof iExcelTitle?iExcelTitle:iPrint3DHeaderTitle,c=4;""!==l?(s.Cells(1,2).NumberFormat="@",s.Cells(1,2).Value=l,s.Cells(1,2).Font.Size=10,s.Cells(2,2).NumberFormat="@",s.Cells(2,2).Value=a,s.Cells(2,2).Font.Size=10,s.Cells(2,2).Font.Bold=!0):(s.Cells(1,2).NumberFormat="@",s.Cells(1,2).Value=a,s.Cells(1,2).Font.Size=10,s.Cells(1,2).Font.Bold=!0,c=2);var d=document.getElementById("tableHeader"),u=d.rows[1].cells;if(u.length<2)return;var p=u.length-1,h="undefined"!=typeof iExcelCorrectHeader&&iExcelCorrectHeader;for(t=1;t<=p;t++){if(s.Cells(c,t).NumberFormat="@",h&&"bot"==u[t].className){var f=u[t].innerText;try{f=f.split("\n")[0]}catch(e){}s.Cells(c,t).Value=e(f)}else s.Cells(c,t).Value=e(u[t].innerText);try{s.Cells(c,t).ColumnWidth=100}catch(e){}}s.Cells(c,1).ColumnWidth=2;var m=s.Range(s.Cells(c,1),s.Cells(c,p));m.Font.Bold=!0,m.Font.Size=8,m.VerticalAlignment=-4108,s.Range(s.Cells(c,2),s.Cells(c,p)).Borders.Weight=-4138;var v=c;try{if(d.rows.length>2)for(v++,s.Range(s.Cells(v,1),s.Cells(v,p)).NumberFormat="@",n=d.rows[2].cells,s.Cells(v,1).Value=e(n[0].innerText),i=2;i<=p;i++)s.Cells(v,i).Value=e(n[i].innerText)}catch(e){}this._sortSelection();var _=this.selectedItems;for(0===_.length&&(_=this.items),t=0;t<_.length;t++)if(_[t].isRowVisible)for(v++,s.Range(s.Cells(v,1),s.Cells(v,p)).NumberFormat="@",n=_[t].tr.cells,s.Cells(v,1).Value=e(n[0].innerText),i=2;i<=p;i++)s.Cells(v,i).Value=e(n[i].innerText);if(v>c){var g=s.Range(s.Cells(c+1,2),s.Cells(v,p));g.Borders(7).Weight=-4138,g.Borders(9).Weight=-4138,g.Borders(10).Weight=-4138,g.Borders(11).Weight=-4138,g.VerticalAlignment=-4160;try{s.Range(s.Cells(c+1,1),s.Cells(v,p)).Font.Name="Courier New"}catch(e){}}s.Range(s.Cells(c,1),s.Cells(v,p)).Columns.AutoFit(),o.Visible=!0,o.UserControl=!0}catch(e){alertx("undefined"!=typeof iWarningExcelNotFound?iWarningExcelNotFound:"Cannot create an Excel ActiveX object.")}}function IPCTable_gotoItem(e){var t=null,i=-1,n=[e];if(e.length>0&&"0"==e.charAt(0))for(var o=0;o<e.length&&(n.push(e.substr(o)),"0"==e.charAt(o));o++);for(var r=0;r<this.items.length&&null==t;r++)for(var s=this.items[r].getItemNumber(),a=0;a<n.length;a++)if(n[a]==s){t=this.items[r],i=s;break}if(t){try{location.hash="#"}catch(e){}if(t.presentInSheet)workTable.onClick2D(i,0);else{var l=getDefaultView(i);l&&activateView(l)}}}function IPCTable__updAttRows(){for(var e=0;e<this.attachingRows.length;e++){for(var t=this.attachingRows[e].attparts,i=!1,n=0;n<t.length;n++)if(t[n].isRowVisible){i=!0;break}this.attachingRows[e].setRowVisibility(i)}}function IPCTable__sortSelection(){for(var e=[],t=0;t<this.items.length;t++)this.items[t].selected&&e.push(this.items[t]);this.selectedItems=e}function IPCTable_setPrintMode(e){var t,i,n;if(e){for(i=0;i<this.items.length;i++)if(t=this.items[i],!t.unused)for(t.tr.style.display="",n=0;n<t.tr.cells.length;n++)t.tr.cells[n].style.color=""}else for(i=0;i<this.items.length;i++)if(t=this.items[i],!t.unused)for(t.tr.style.display=t.isRowVisible?"":"none",n=0;n<t.tr.cells.length;n++)t.tr.cells[n].style.color=t.presentInSheet?"":fullTableRowColor}function IPCItem(e,t){this.index=t,this.dpl_item=ipc_data.dplist[t],this.table=e,this.tr=e.table.tBodies[0].rows[t],this.isAttachingKeyword="undefined"!=typeof this.dpl_item.attachingKeyword,this.attparts=[];var i;if(this.isAttachingKeyword&&1==this.dpl_item.attachingKeyword)for(i=t-1;i>0;i--){var n=e.items[i];if(n.isAttachingKeyword){n.attparts=this.attparts;break}this.attparts.push(n)}if(this.state=1,this.chkBox=this.tr.cells[1].firstChild,"span"!=this.chkBox.nodeName.toLowerCase()){var o=this.tr.cells[1].childNodes;for(i=0;i<o.length;i++)"span"==o[i].nodeName.toLowerCase()&&(this.chkBox=o[i])}this.presentInSheet=!0,this.isRowVisible=!1,this.part=ipcApi.getIPCPartByIndex(t),this.part.withoutGeometry?this.state=-2:this.part.checkFullTransparency()&&(this.state=-1),1!=this.state&&this.updateCheckBox(),this.parents=[];for(var r=this.dpl_item.parent;r>=0;){var s=this.table.items[r];this.parents.push(s),1==this.parents.length&&s.children.push(this),s.allChildren.push(this),r=s.dpl_item.parent}this.children=[],this.allChildren=[],this.selected=!1,this.subselected=!1,this.hlighted=!1,this.filtered=!1,this.unused=!1,this.__processed=!1;try{!this.tr.title&&"undefined"!=typeof tblTooltip&&tblTooltip&&"tooltip"in this.dpl_item&&(this.tr.title=this.dpl_item.tooltip)}catch(e){}}function IPCItem_updateDoubles(){if(this.isRowVisible)for(var e in this.dpl_item.dbls)try{var t=this.table.items[e];t.selected=this.selected,t.subselected=this.subselected,t.hlighted=this.hlighted,t.state=this.state,t.tr.style.backgroundColor=this.tr.style.backgroundColor,t.chkBox.style.backgroundPosition=this.chkBox.style.backgroundPosition,t.chkBox.innerHTML=this.chkBox.innerHTML}catch(e){}}function IPCItem_getVisibility(){if(this.part.getVisibility())return!0;for(var e=0;e<this.allChildren.length;e++)if(this.allChildren[e].part.getVisibility())return!0;return!1}function IPCItem_setFiltered(e){if(this.filtered!=e){if(ipcApi.setAutoRefreshOff(),this.filtered=e,this.part.filter(e),this.state>=0)for(var t=0;t<this.allChildren.length;t++)this.allChildren[t].part.filter(e);ipcApi.restoreAutoRefresh(),this.filtered?this.setRowVisibility(!1):this.setRowVisibility(this.table.isFullTable||this.presentInSheet)}}function IPCItem_setFilteredWithoutChildren(e){if(this.filtered!=e){if(this.filtered=e,options.multiLink){var t=e;if(t)for(var i in this.dpl_item.dbls){var n=this.table.items[i];if(n.passed&&n.isRowVisible){t=!1;break}}}this.part.filter(e),this.filtered?this.setRowVisibility(!1):this.setRowVisibility(this.table.isFullTable||this.presentInSheet)}}function IPCItem_updateCheckBox(){var e="";this.presentInSheet?0===this.state?(this.chkBox.style.backgroundPosition="0 0",e="hide"):1==this.state?(this.chkBox.style.backgroundPosition="-12px 0",e="show"):2==this.state?(this.chkBox.style.backgroundPosition="-24px 0",e="partial"):this.state==-1?this.chkBox.style.backgroundPosition="-60px 0":this.state==-2?(this.chkBox.style.backgroundPosition="-48px 0",e="none"):this.state==-3&&(this.chkBox.style.backgroundPosition="-48px 0",e="none"):this.state<=-2?(this.chkBox.style.backgroundPosition="-48px 0",e="none"):this.chkBox.style.backgroundPosition="-60px 0",options.multiLink&&this.updateDoubles()}function IPCItem_setRowVisibility(e){e&&this.unused||(this.tr.style.display=e?"":"none",this.isRowVisible=e)}function IPCItem_update(){this.state>=-1&&(this.part.checkFullTransparency()?this.state=-1:this.state=1);for(var e=0;e<this.tr.cells.length;e++)this.tr.cells[e].style.color=this.presentInSheet?"":fullTableRowColor}function IPCItem_update2(){if(this.state==-1)for(var e=0;e<this.allChildren.length;e++)if(this.allChildren[e].state>0){this.state=1;break}}function IPCItem_show(e){if(!(this.state<0)){e?this.table.hiddenItems.splice(this.table.hiddenItems.indexOf(this),1):this.table.hiddenItems.push(this),ipcApi.setAutoRefreshOff(),this.part.show(e);var t,i,n;if(!isTiramisu)for(t=0;t<this.allChildren.length;t++)this.allChildren[t].part.show(e);ipcApi.restoreAutoRefresh(),ipcApi.doRefresh(),this.state=e?1:0,this.updateCheckBox();var o;for(t=0;t<this.allChildren.length;t++)o=this.allChildren[t],o.state>=0&&o.presentInSheet&&(o.state=this.state,o.updateCheckBox());var r,s=!1;for(t=0;t<this.parents.length;t++)if(r=this.parents[t],r.state>=0&&r.presentInSheet){if(e){if(!s)for(n=r.allChildren,i=0;i<n.length;i++)if(n[i].presentInSheet&&0===n[i].state){s=!0;break}r.state=s?2:1}else{if(!s&&(s=r.getVisibility(),!s))for(n=r.allChildren,i=0;i<n.length&&!(s=n[i].getVisibility());i++);r.state=s?2:0}r.updateCheckBox()}}}function IPCItem_paint3D(e){ipcApi.setAutoRefreshOff();var t;if(e){if(this.part.setDiffuseColor(C_YELLOW),!isTiramisu)for(t=0;t<this.allChildren.length;t++)this.allChildren[t].part.setDiffuseColor(C_YELLOW);this.index in this.table.changedMaterials.items||(this.table.changedMaterials.items[this.index]=0,this.table.changedMaterials.list.push(this))}else if(this.part.restoreVrmlNodesMaterial(),!isTiramisu)for(t=0;t<this.allChildren.length;t++)this.allChildren[t].part.restoreVrmlNodesMaterial();ipcApi.restoreAutoRefresh()}function IPCItem_resetMaterial(){if(ipcApi.setAutoRefreshOff(),this.part.resetVrmlNodesMaterial(),!isTiramisu)for(var e=0;e<this.allChildren.length;e++)this.allChildren[e].part.resetVrmlNodesMaterial();ipcApi.restoreAutoRefresh()}function IPCItem_select(e){if(!this.isAttachingKeyword){if(this.tr.style.backgroundColor=e?selectionColor:"transparent",this.selected!=e&&(e?this.table.selectedItems.push(this):this.table.selectedItems.splice(this.table.selectedItems.indexOf(this),1)),this.selected=e,this.subselected=!1,this.state>=0){this.paint3D(e);for(var t=0;t<this.children.length;t++)this.children[t].subselect(e)}var i=C2D_findHotspot(this.getItemNumber());i&&(e?select_iso(this.getItemNumber()):unselect_iso(this.getItemNumber())),options.multiLink&&this.updateDoubles(),this.table._onSelectionChanged()}}function IPCItem_restore3DSelection(){if(this.state>=0){this.subselected||this.paint3D(this.selected);for(var e=0;e<this.children.length;e++)this.children[e].restore3DSelection()}}function IPCItem_subselect(e){if(this.selected&&!e)ipcApi.doRefresh(),this.restore3DSelection();else{this.selected||(this.tr.style.backgroundColor=e?selectionChildrenColor:"transparent",this.subselected=e);for(var t=0;t<this.children.length;t++)this.children[t].subselect(e)}options.multiLink&&this.updateDoubles()}function IPCItem_hlight(e){if(!this.isAttachingKeyword){var t;if(is2D){var i=C2D_findHotspot(this.getItemNumber());e?(this.tr.style.backgroundColor=i?higlightColor:notfoundColor,i&&hlight_iso(this.getItemNumber())):this.selected?(this.tr.style.backgroundColor=selectionColor,i&&select_iso(this.getItemNumber()),i&&!isCortona3D&&unhlight_iso(this.getItemNumber())):this.subselected?(this.tr.style.backgroundColor=selectionChildrenColor,i&&unhlight_iso(this.getItemNumber())):(this.tr.style.backgroundColor="transparent",i&&unhlight_iso(this.getItemNumber()))}else if(e){if(this.tr.style.backgroundColor=this.state>0?higlightColor:notfoundColor,this.state>=0){if(ipcApi.setAutoRefreshOff(),this.part.setEmissiveColor(C_DARKGREY),!isTiramisu)for(t=0;t<this.allChildren.length;t++)this.allChildren[t].part.setEmissiveColor(C_DARKGREY);ipcApi.restoreAutoRefresh()}}else if(this.selected?this.tr.style.backgroundColor=selectionColor:this.subselected?this.tr.style.backgroundColor=selectionChildrenColor:this.tr.style.backgroundColor="transparent",this.state>=0){if(ipcApi.setAutoRefreshOff(),this.part.setEmissiveColor(C_BLACK),!isTiramisu)for(t=0;t<this.allChildren.length;t++)this.allChildren[t].part.setEmissiveColor(C_BLACK);ipcApi.restoreAutoRefresh()}isMSIE&&(this.tr.style.backgroundColor=this.tr.style.backgroundColor),this.hlighted=e,options.multiLink&&this.updateDoubles()}}function IPCItem_setTransparency(e){if(this.state>=0){if(ipcApi.setAutoRefreshOff(),this.part.setTransparency(e),!isTiramisu)for(var t=0;t<this.allChildren.length;t++)this.allChildren[t].part.setTransparency(e);ipcApi.restoreAutoRefresh(),this.index in this.table.changedMaterials.items||(this.table.changedMaterials.items[this.index]=0,this.table.changedMaterials.list.push(this))}}function IPCItem_getTransparency(){return this.state>=0?this.part.getTransparency():0}function IPCItem_getTooltipText(){var e="";if(this.table._checkUnusedItem(this))for(var t=0;t<this.dpl_item.links.length;t++)e+=this.dpl_item.links[t].description+"<br>";else"tooltip"in this.dpl_item?e=this.dpl_item.tooltip.replace(/\n/g,"<br>"):this.getItemNumber().match(/\S/m)&&(e=iItemNamePrefix+" "+this.getItemNumber());return e}function IPCItem_getItemNumber(){return"itemnumber"in this.dpl_item&&this.dpl_item.itemnumber?this.dpl_item.itemnumber.replace(/\/00A$/,""):this.dpl_item.note?"NOTE":" "}function IPCItem_isEqual(e){return"itemnumber"in this.dpl_item&&(e.indexOf("/")===-1&&this.dpl_item.itemnumber.indexOf("/")!==-1?e+="/00A":e.indexOf("/")!==-1&&this.dpl_item.itemnumber.indexOf("/")===-1&&(e=e.split("/")[0]),this.dpl_item.itemnumber===e)}function IPCItem_getTitle(){var e=this.getItemNumber();return e.match(/\S/m)&&(e=iItemNamePrefix+" "+e),e}function IPCItem_fit(){if(!this.table.block_fit){var e=[];e.push(this.part);for(var t=0;t<this.allChildren.length;t++)e.push(this.allChildren[t].part);ipcApi.fitToParts(e,"")}}function CloseContextMenu(){workTable&&workTable.cMenu&&workTable.cMenu.close()}function SmartCloseContextMenu(e,t){workTable&&workTable.cMenu&&(workTable.cMenu.checkPoint(e,t)||workTable.cMenu.close())}function OnContextMenuBlur(){menuTimeout&&clearTimeout(menuTimeout),isWaitMenu||(menuTimeout=setTimeout(CloseContextMenu,0))}function ContextMenuNoBlur(e){return isWaitMenu=e,menuTimeout&&clearTimeout(menuTimeout),document.getElementById("cmenu_anchor").focus(),!1}function CheckContextMenuOpen(){return workTable.cMenu&&workTable.cMenu.checkIsOpen()}function ContextMenu(e){this.oContextHTML=e;var t=function(){return!1};this.oContextHTML.onselectstart=t,this.oContextHTML.oncontextmenu=t,this.oContextHTML.style.MozUserSelect="none",this.oContextHTML.style.webkitUserSelect="none",this.oContentDiv=null,this.oIframeShim=null,this.isOpen=!1,this.coords=[0,0,0,0],this.isOver3D=!1}function ContextMenu_show(e,t,i,n,o){function r(e,t,i){return i?"<tr><td colspan='2' style='background-color: "+cMenuBackgroundColor+'; color: #000000; font-family:tahoma, sans-serif; font-size:8pt; padding: 2px 17px 2px 17px; cursor: default; white-space : nowrap; text-align : left;\' onmouseover=\'this.style.color="#FFFFFF"; this.style.backgroundColor="#000080";\' onmouseout=\'this.style.color="#000000"; this.style.backgroundColor="'+cMenuBackgroundColor+"\";' onmousedown='cortona3d.app.ContextMenuNoBlur(true);' onmouseup='cortona3d.app.ContextMenuNoBlur(false);' onclick='"+t+" cortona3d.app.contextMenuClose();'>"+e+"</td></tr>":"<tr><td colspan='2' disabled style='background-color: "+cMenuBackgroundColor+"; color: #707070; font-family:tahoma, sans-serif; font-size:8pt; padding: 2px 17px 2px 17px; cursor: default; white-space : nowrap; text-align : left;'>"+e+"</td></tr>"}function s(e){for(var t=e.offsetLeft,i=e.offsetTop,n=e.offsetParent;n;n=n.offsetParent)t+=n.offsetLeft,i+=n.offsetTop;return{left:t,top:i}}if(!e||!ipc_data.dplist[e.index].note&&!ipc_data.dplist[e.index].attachingKeyword){var a=isFF&&o?"#C0C0C0":"#FFFFFF",l="<tr><td colspan='2' style='background-color: "+cMenuBackgroundColor+"; padding: 0px 2px 0px 2px; cursor: default;'><hr></td></tr>",c="<a id='cmenu_anchor' style='text-decoration: none;cursor: default;' onblur='cortona3d.app.OnContextMenuBlur();' onmousedown='cortona3d.app.ContextMenuNoBlur(true);' onmouseup='cortona3d.app.ContextMenuNoBlur(false);' onclick='return false;' href='#'><div style='border: 1px solid; border-color: #C0C0C0 #000000 #000000 #C0C0C0;'><div style='border: 1px solid; border-color: "+a+" #808080 #808080 "+a+"; background-color: "+cMenuBackgroundColor+"; padding: 2px 2px 2px 2px;'><table style='border-collapse:collapse;'>",d=e?e.getTitle():" ";c+="<tr><th style='background-color: "+cMenuBackgroundColor+"; color: #000000; font-family:tahoma, sans-serif; font-size: 9pt; padding: 2px 0 2px 17px; cursor: default; font-weight:bold; white-space : nowrap; text-align : left;'>"+d+"</th>",c+="<th aligh='right' style='background-color: "+cMenuBackgroundColor+"; padding: 1px 1px 1px 1px;'><div style='float : right; color: #000000; height:18px; width:18px; font-size:14px; border: 1px solid "+cMenuBackgroundColor+"; font-weight:bold; text-align : center; vertical-align : middle; cursor: pointer;' title='"+iContextMenuCloseButtonToolTip+"' onmouseover='this.style.borderColor =\"#000000\";' onmouseout='this.style.borderColor=\""+cMenuBackgroundColor+"\";' onclick='cortona3d.app.contextMenuClose();'>&#0215;</div></th></tr>",c+=l;var u;if(e&&e.presentInSheet&&(!is2D&&e.state>=0&&(c+=r(iContextMenuFit,"cortona3d.app.getWorkTable().getItem("+e.index+").fit();",e.state>0&&!e.table.block_fit),c+=1==e.state?r(iContextMenuHide,"cortona3d.app.getWorkTable().getItem("+e.index+").show(false);",!0):r(iContextMenuShow,"cortona3d.app.getWorkTable().getItem("+e.index+").show(true);",!0)),c+=e.selected?r(iContextMenuUnselect,"cortona3d.app.getWorkTable().getItem("+e.index+").select(false);",!0):r(iContextMenuSelect,"cortona3d.app.getWorkTable().getItem("+e.index+").select(true);",!0),c+=l),e&&(is2D||e.state>=-1)){var p=rightViews,h=[];for(u=0;u<p.length;u++)if(!p[u].hidden)for(var f=p[u],m=0;m<f.items.length;m++)if(f.items[m]==e.index){h.push(f);break}if(!workTable._checkUnusedItem(e)&&h.length>0){var v=ipc_data.dplist[e.index].mainview;for(u=0;u<h.length;u++){var _=iContextMenuGotoViewPrefix+" "+_cut_sheet_description(h[u].description);h[u].id==v&&(_="<b>"+_+"</b>"),c+=h[u].id==current_view?r(_+" "+iContextMenuActiveViewMark,"",!1):r(_,'cortona3d.app.activateView("'+h[u].id+'");',!0)}c+=l}}if(e){var g=ipc_data.dplist[e.index].links;if(g.length>0){for(u=0;u<g.length;u++)c+=r(g[u].description,"cortona3d.app.openLink("+e.index+","+u+");",!0);c+=l}}if(is2D?(c+=r(TXT_CMENU_VIEWER2D_ZOOMIN,"cortona3d.app.zoomIn();",!0),c+=r(TXT_CMENU_VIEWER2D_ZOOMOUT,"cortona3d.app.zoomOut();",!0),c+=l,c+=r(TXT_CMENU_VIEWER2D_BESTFIT,"cortona3d.app.reset();",!0),c+=l):(c+=r(iContextMenuShowAll,"cortona3d.app.getWorkTable().showAll();",workTable.hiddenItems.length>0),c+=l),o&&isCortona3D&&(c+=r(iContextMenuCortonaProperties,"cortona3d.app.showCortonaProperties();",!0)),o&&!isCortona3D&&window.showFPSSelector){var C=!!cortona3d.scene("cContainer").fps;c+=r(C?iHideFPS:iShowFPS,"cortona3d.app.toggleFPSIndicator();",!0)}"undefined"!=typeof iContextMenuAbout&&(c+=r(iContextMenuAbout,"setTimeout(cortona3d.app.showAbout,0);",!0)),c+="</table></div></div></a>",this.isOver3D=o,this.isOver3D&&!isMSIE&&ipcApi.enableNavigation(!1),this.oContextHTML.style.width="",this.oContextHTML.style.height="",this.oContextHTML.innerHTML=c;var I=this.oContextHTML.clientWidth,y=this.oContextHTML.clientHeight,b=document.body.offsetWidth,S=document.body.offsetHeight,w=s(n),T=w.left,P=w.top,E=2,F=t+I+E<b?t+T+E:t+T-E-I,A=P+5,D=i+y+E+A<S?i+P+E:i+P-E-y;this.oContextHTML.style.left=F+"px",this.oContextHTML.style.top=D+"px",this.coords=[F,D,F+I,D+y],this.oContentDiv=document.createElement("div"),this.oContentDiv.className="cmenuholder",this.oContentDiv.innerHTML=this.oContextHTML.innerHTML;var x=this.oContentDiv.style;x.display="block",this.oIframeShim=document.createElement("iframe"),this.oIframeShim.frameBorder=0,this.oIframeShim.scrolling="no",this.oIframeShim.src="about:blank";var O=this.oIframeShim.style;x.position=O.position="absolute",x.left=O.left=F+"px",x.top=O.top=D+"px",x.width=O.width=I+"px",x.height=O.height=y+"px",x.zIndex=1e3,O.zIndex=x.zIndex-1,document.body.appendChild(this.oContentDiv),document.body.appendChild(this.oIframeShim),this.oContextHTML.innerHTML="",this.oContextHTML.style.left="0",this.oContextHTML.style.top="0",this.oContextHTML.style.width="0",this.oContextHTML.style.height="0",document.getElementById("cmenu_anchor").hideFocus=!0,document.getElementById("cmenu_anchor").focus(),this.isOpen=!0}}function ContextMenu_close(){this.isOpen&&(this.isOpen=!1,this.oContentDiv&&this.oContentDiv.parentNode.removeChild(this.oContentDiv),this.oIframeShim&&this.oIframeShim.parentNode.removeChild(this.oIframeShim),this.oContentDiv=null,this.oIframeShim=null,this.isOver3D&&!isMSIE&&ipcApi.enableNavigation(!0),workTable._onContextMenuClose())}function ContextMenu_checkIsOpen(){return this.isOpen}function ContextMenu_checkPoint(e,t){return this.isOpen&&this.coords[0]>e&&this.coords[2]<e&&this.coords[1]>t&&this.coords[3]<t}function navigateLink(e,t){t&&"_blank"==t?(window.open(e,"",""),window.event&&(window.event.cancelBubble=!0)):window.location.assign(e)}function openLink(e,t){workTable.contextMenuClose();var i=ipc_data.dplist[e].links[t];navigateLink(i.href,i.target)}function initialize_api(e){if(with3D){var t=cortona3d.scene("cContainer");if(ipcApi=new cortona3d.interfaces[viewer3DKey].IPCApi(t[viewer3DKey]),cortona3d.factory[viewer3DKey].skins&&(ipcApi._default_skin=cortona3d.factory[viewer3DKey].skins.review,ipcApi.uiActions=["revokePropPage:{E5711FD5-464F-11D3-9D7D-00A0247A5F3F}","revokePropPage:{EC48A005-4978-11D3-9D7E-00A0247A5F3F}","revokePropPage:{E5711FD4-464F-11D3-9D7D-00A0247A5F3F}"]),isMSIE||(ipcApi.ATP=1),workTable=new IPCTable(document.getElementById("tableIPC")),ipcApi.checkCortonaComponent()){var i=parseInt(ipcApi.getCortonaVersion(),10);i<8&&alertx(iWarningCortonaOldVersion),ipcApi.attach(),workTable.on_selection_changed=on_3D_selection,ipcApi.SKIP_TRANSPARENCY_THRESHOLD_LEVEL=0,ipcApi.on_part_over=function(e){isCalloutsMode||workTable.onOver3D(e)},ipcApi.on_part_click=function(e,t,i,n,o){isCalloutsMode||workTable.onClick3D(e,t,i,n,o)},ipcApi.on_reset=function(){workTable.clearHighlight(),navControl.checkMode()},ipcApi.on_simulation_load=on_simulation_load,ipcApi.on_view_changed=on_view_changed,ipcApi.on_fraction_changed=on_fraction_changed,on_set_properties(e),ipcApi.load(isTiramisu?e.interactivity:e.vrmlfile,e)}else{with3D=!1;var n="";"undefined"!=typeof iCaptionCortonaNotFound&&(n=iCaptionCortonaNotFound),document.getElementById("cFooter").style.visibility="hidden",ipcApi=new cortona3d.interfaces[viewer3DKey].IPCApiDummy,workTable=new IPCTable(document.getElementById("tableIPC")),on_simulation_load(!0)}}else set2D(!0),ipcApi=new cortona3d.interfaces[viewer3DKey].IPCApiDummy,
workTable=new IPCTable(document.getElementById("tableIPC")),on_simulation_load(!0)}function getViewIdByName(e){var t="";for(var i in ipcApi.data.viewById)if(ipcApi.data.viewById[i].description===e){t=i;break}return t}function on_simulation_load(e){if(e){current_view=null;var t="",i=location.hash.substring(1);if(""!==i){var n=i.replace(/^([^(]+)\(.*\)$/,"$1").toLowerCase();n&&(i=i.replace(/^[^(]+\((.*)\)$/,"$1")),t=getDefaultView(i),"view"==n&&(preSelectedItem="")}with3D?(isTiramisu&&ipcApi.solo.app.setDefaultBackgroundColors(clr3DBackgroundColor),window.forceFPSIndicator&&(ipcApi.initialViewName=getViewIdByName("TestView1")),t||(t=ipcApi.initialViewName),t?ipcApi.setIPCView(t):on_view_changed(t),_checkSkinControl(),options.rotationCenter||navControl.onBtnClick(5),options.ignoreTransparency||(setIgnoreTransp(!1),topControl.setState(2,0))):(!t&&rightViews.length>0&&(t=rightViews[0].id),t&&on_view_changed(t)),document.getElementById("slctUsage").selectedIndex=0,document.getElementById("slctModel").selectedIndex=0,document.getElementById("slctSB").selectedIndex=0}else{var o=document.getElementById("cContainer");if(isX3DOM){if(with3D)if(o.className="x3dom-nox3d",ipcApi.isValid()){var r=cortona3d.scene(o)[viewer3DKey].inline._x3domNode,s=document.createElement("div");s.className="message",s.innerHTML="<p>"+iWarningErrorOnVRMLLoading+"</p><p>Status: "+r.status+" "+r.statusText+"</p><p>"+r.parseError+"</p>",o.appendChild(s)}else o.appendChild(document.getElementById("x3dom-nox3d")),o.appendChild(document.getElementById("x3dom-create-init-failed"))}else alertx(iWarningErrorOnVRMLLoading)}}function getDefaultView(e){e=e.replace(/^0{1,2}/,"");var t,i=e.indexOf("/")===-1?e+"/00A":e.split("/")[0],n="",o=ipc_data.dplist,r=rightViews;for(t=0;t<o.length;t++)if(IPCItem_isEqual.call({dpl_item:o[t]},e)){o[t].mainview&&(n=o[t].mainview);break}if(!n)for(t=0;t<r.length;t++)if(r[t].id==current_view){(e in r[t].itemnbr||i in r[t].itemnbr)&&(n=r[t].id);break}if(!n)for(t=0;t<r.length;t++)if(e in r[t].itemnbr||i in r[t].itemnbr){n=r[t].id;break}return n&&(preSelectedItem=e),n}function on_view_changed(e){console.log("IPC view changed "+e);var t,i="";for(t=0;t<document.getElementById("viewsSelector").options.length;t++)if(document.getElementById("viewsSelector").options[t].value==e){document.getElementById("viewsSelector").selectedIndex=t,view_description=iViewNamePrefix+" "+views_descriptions[t],i=views_descriptions[t];break}current_view=e,last_view=current_view;var n=rightViews;for(t=0;t<n.length;t++)n[t].id==current_view&&(document.getElementById("revision_mark").style.visibility=n[t].changed?"visible":"hidden");clearTimeout(current_view_timeout),"GENERIC"!=specType&&(document.getElementById("metasheet")[sInnerText]=view_description),dispatchContentResize(),ipcApi.activatePageViewpoint(),workTable.update(),document.getElementById("tbdContainer").style.visibility="visible",document.getElementById("tableHeader").style.visibility="visible",load_2D_graphics(getCGM(i)),disableViews(!1),workTable.setBlock(!1),""!==preSelectedItem&&(workTable.onClick2D(preSelectedItem,0),preSelectedItem=""),cortona3d.scene("cContainer").loading.hide(),hideCortona3D(is2D),hideCortona2D(!is2D),isX3DOM&&with3D&&(cortona3d.scene("cContainer")[viewer3DKey].instance.runtime.viewpoint()._xmlNode.onviewpointChanged=axesViewpoint,on_fraction_changed())}function on_fraction_changed(){var e=cortona3d.scene("cContainer")[viewer3DKey].instance.runtime,t=e.viewpoint();t._xmlNode.onviewpointChanged=axesViewpoint;var i=e.viewMatrix(),n=t.getCurrentTransform();n=n.inverse().mult(i),axesViewpoint({matrix:n})}function axesViewpoint(e){var t=new x3dom.fields.Quaternion(0,0,1,0);t.setValue(e.matrix);var i=t.toAxisAngle();document.getElementById("axes").setAttribute("rotation",i[0].x+" "+i[0].y+" "+i[0].z+" "+i[1]),ipcApi.valiadteCenterpointAxisPosition()}function on_doc_load(){cortona3d.loadSpecIDCSS(resFolder+""+ipcSpecID.toLowerCase(),init)}function init(){sInnerText=document.body.textContent?"textContent":"innerText";var e=navigator.appName.toLowerCase();if(isMSIE="microsoft internet explorer"==e)isIE8=!document.addEventListener;else if(isOpera="opera"==e,!isOpera){var t=navigator.userAgent.toLowerCase();isFF=t.lastIndexOf("firefox/")>0,isFF||(isChrome=t.lastIndexOf("chrome/")>0||t.lastIndexOf("safari/")>0,isMSIE=!isChrome)}var i=cortona3d.scene("cContainer");i.add(cortona3d.factory.loading),i.loading.show(),window.forceFPSIndicator&&(i.add(cortona3d.factory.fps),i.fps.show());var n=__webpack_require__(69)({options:{UsePlugins:window.usePlugins}});viewer3DKey=n.viewer3D[0],viewer2DKey=n.viewer2D[0],viewer3DType=viewer3DKey,viewer2DType={svg:-1,viewer2d:1,isoview:2}[viewer2DKey],isX3DOM="x3dom"==viewer3DType,isCortona3D="viewer3d"==viewer3DType,isTiramisu=!isCortona3D&&!isX3DOM,with3D=2!=illustrationType,with2D=is2DGraphicsEnabled,tableColsWidth=getCollumnsWidth(),setCollumnsWidth(tableColsWidth);for(var o=ipc_data.dplist,r=o.length-1;r>=0;r--){var s=o[r].filter.modelapply;if(1===s.length){var a=s[0];a.indexOf('", "')!==-1&&(o[r].filter.modelapply=a.split('", "'))}}window.onresize=on_content_resize,document.getElementById("baseDiv").onmousedown=CloseContextMenu,on_content_resize(),window.document.onkeydown=CloseContextMenu,window.onblur=CloseContextMenu,window.onbeforeprint=fBeforePrint,window.onafterprint=fAfterPrint,"undefined"!=typeof fullTableOnlyRowColor&&(fullTableRowColor=fullTableOnlyRowColor),embed3DControl(),embed2DControl(),window.onhashchange=onHashChange,setTimeout(function(){presetHtml(ipc_data),disableViews(!0),_initialize_views(),initialize_api(ipc_data),set2D(!with3D)},100)}function on_doc_unload(){cortona3d.app.error=function(){};try{scrwin.close()}catch(e){}with3D&&ipcApi&&(ipcApi.unload(),ipcApi.detach());var e=cortona3d.scene("cContainer");cortona3d.factory[viewer2DKey].events.forEach(function(t){e.container.removeEventListener(t,defaultHandler,!1)}),e.destroy()}function _getSingleValue(e,t){for(var i=0;i<t.length;i++)if(t[i].name==e)return t[i].value;return null}function dispatchContentResize(){try{window.dispatchEvent(new Event("resize"))}catch(e){on_content_resize()}}function on_content_resize(){try{document.getElementById("viewersPanel").style.width="",document.getElementById("tablePanel").style.left="";var e=document.body.offsetWidth-document.getElementById("tablePanel").offsetWidth;e<350&&(e=350),document.getElementById("viewersPanel").style.width=e+"px",document.getElementById("tablePanel").style.left=e+"px";var t=document.body.offsetHeight-document.getElementById("THeader").offsetHeight-document.getElementById("TFooter").offsetHeight;t<0&&(t=0),document.getElementById("tbdContainer").style.height=t+"px";var i=document.body.offsetHeight-document.getElementById("cHeader").offsetHeight-document.getElementById("cFooter").offsetHeight;i<0&&(i=0),document.getElementById("cContainer").style.height=i+"px",setTimeout(function(){ipcApi&&ipcApi.redrawCallouts&&ipcApi.redrawCallouts()},10)}catch(e){}isTiramisu&&ipcApi&&ipcApi.control3d&&ipcApi.control3d.didChangeLayout&&ipcApi.control3d.didChangeLayout(),CloseContextMenu()}function updateTableHeader(){document.getElementById("meta_currentdate").innerHTML=iPrintTableFooterPrinted+_getFormatedDate(GetCurrentDate()),document.getElementById("tableIPC").deleteTHead();for(var e=document.getElementById("tableIPC").createTHead(),t=document.getElementById("tableHeader").rows,i=0;i<t.length;i++)e.appendChild(t[i].cloneNode(!0))}function _getFormatedDate(e){var t,i,n,o="";try{8==e.length&&(t=e.substr(0,4),i=e.substr(4,2),n=e.substr(6,2),o=""+t+"-"+i+"-"+n)}catch(e){}if("ATA"==dateFormat)try{8==e.length&&(t=e.substr(2,2),i=e.substr(4,2),n=e.substr(6,2),o=iMonths[parseInt(i,10)-1]+" "+n+"/"+t)}catch(e){}return o}function activateUIElements(){}function attachUIEvents(){for(var e,t,i=[["btnCalloutsUndo","onclick",undoCallout],["btnFitSelection","onclick",fit_3D_selection],["btnShowSelection","onclick",show_3D_selection],["btnHideSelection","onclick",hide_3D_selection],["chkFullTable","onclick",function(){setFullTable(this.checked)}],["chbxShowBoxes","onclick",function(){user_chkbxs=this.checked,hideCheckBoxesColumn(user_chkbxs)}],["viewsSelector","onchange",function(){selectView(this.selectedIndex)}],["ScrollSlider","onmousedown",function(){tSlider&&(is_tSliderActive=!0)}],["ScrollSlider","onscroll",set_transparency_3D_selection]],n=0;n<i.length;n++)e=i[n],t=document.getElementById(e[0]),t&&(t[e[1]]=e[2])}function presetHtml(e){var t,i,n;if(attachUIEvents(),document.getElementById("tableIPC").onselectstart=function(e){if(e=e||window.event,e.shiftKey||e.ctrlKey)return!1},document.getElementById("btn_2d").style.display=with3D&&with2D?"":"none",document.getElementById("chbxShowBoxes").disabled=is2D,document.getElementById("chkFullTable").checked=!1,document.getElementById("chbxShowBoxes").checked=!0,isTiramisu&&(document.getElementById("btn_callouts").style.display="none",document.getElementById("btnSpin").style.display="none",document.getElementById("btnZoom").style.display="none",document.getElementById("btnPan").style.display="none"),on_3D_selection([]),(!isMSIE||!isCortona3D||"undefined"!=typeof isDisableTableExport&&isDisableTableExport)&&(document.getElementById("btn_excel").style.display="none"),"S1000D"==specType)formated_rev_date=_getFormatedDate(M_REVDATE),""!==M_MODEL&&(document.getElementById("meta_model").innerHTML=iModelNamePrefix+" "+M_MODEL),document.getElementById("meta_date").innerHTML=formated_rev_date,""!==M_TSN&&"."!=M_TSN&&(document.getElementById("meta_revnumber").innerHTML=iRevisionNamePrefix+" "+M_TSN);else if("ATA"==specType)formated_rev_date=_getFormatedDate(M_REVDATE),""!==M_ENGINEMODEL&&(document.getElementById("metamodel")[sInnerText]=iModelNamePrefix+" "+M_ENGINEMODEL),document.getElementById("revDate")[sInnerText]=formated_rev_date;else if("GENERIC"==specType)try{formated_rev_date=iPublishedDatePrefix+_getFormatedDate(PUBLISH_DATE),document.getElementById("metaPublishedDate")[sInnerText]=formated_rev_date}catch(e){}if(updateTableHeader(),topControl=new TopLineControl,with3D){navControl=new NavigationControl;try{C_YELLOW=new Array(parseInt("0x"+clr3DSelectedColor.substr(1,2),16)/255,parseInt("0x"+clr3DSelectedColor.substr(3,2),16)/255,parseInt("0x"+clr3DSelectedColor.substr(5,2),16)/255)}catch(e){}tSlider=document.getElementById("ScrollSlider")}var o=ipc_data.dplist,r={};for(t=0;t<o.length;t++){var s=o[t].filter.usage;for(n=0;n<s.length;n++)s[n]in r||(r[s[n]]=1,usageList.push(s[n]))}for(usageList.sort(),t=0;t<usageList.length;t++)i=document.createElement("OPTION"),i.text=usageList[t],i.value=usageList[t],isMSIE?document.getElementById("slctUsage").add(i):document.getElementById("slctUsage").add(i,null);for(r={},t=0;t<o.length;t++){var a=o[t].filter.modelapply;for(n=0;n<a.length;n++)a[n]in r||(r[a[n]]=1,modelsList.push(a[n]))}for(modelsList.sort(),t=0;t<modelsList.length;t++)i=document.createElement("OPTION"),i.text=modelsList[t],i.value=modelsList[t],isMSIE?document.getElementById("slctModel").add(i):document.getElementById("slctModel").add(i,null);for(r={},t=0;t<o.length;t++){var l=o[t].filter.sb;for(n=0;n<l.length;n++)l[n]in r||(r[l[n]]=1,sbList.push(l[n]))}for(sbList.sort(),t=0;t<sbList.length;t++)i=document.createElement("OPTION"),i.text=sbList[t],i.value=sbList[t],isMSIE?document.getElementById("slctSB").add(i):document.getElementById("slctSB").add(i,null);document.getElementById("slctUsage").onchange=onchangeSelection,document.getElementById("slctModel").onchange=onchangeSelection,document.getElementById("slctSB").onchange=onchangeSelection}function onchangeSelection(){if("ATA"==specType){var e=[getSelection(document.getElementById("slctModel")),getSelection(document.getElementById("slctUsage")),getSelection(document.getElementById("slctSB"))];workTable.multifilter(e[0],e[1],e[2])}else workTable.filter(document.getElementById("slctModel").selectedIndex,document.getElementById("slctUsage").selectedIndex,document.getElementById("slctSB").selectedIndex)}function getSelection(e){for(var t=[],i=1;i<e.options.length;i++)e.options[i].selected&&t.push(i-1);return t}function _initialize_views(){var e,t;rightViews=[];var i=ipc_data.views,n=[];for(t=0;t<i.length;t++)n[t]="";if("undefined"!=typeof sheetIdentSymbol&&""!==sheetIdentSymbol){var o={};for(t=0;t<i.length;t++)for(var r=i[t].transitions,s=0;s<r.length;s++)o[r[s].id]=i[t];for(t=0;t<i.length;t++){for(var a="",l=i[t].id,c=0;l in o;)if(o[l].hidden||(a+=sheetIdentSymbol),l=o[l].id,c++>100){a=0;break}n[t]=a}}for(t=0;t<i.length;t++)i[t].hidden||(with3D||!with2D||i[t].cgmsrc)&&(rightViews.push(i[t]),e=document.createElement("OPTION"),e.text=_cut_sheet_description(n[t]+i[t].description),e.title=i[t].description,e.value=i[t].id,isMSIE?document.getElementById("viewsSelector").add(e):document.getElementById("viewsSelector").add(e,null),views_descriptions.push(i[t].description),i[t].changed&&(document.getElementById("revision_mark").style.display=""));document.getElementById("viewsSelector").selectedIndex=0}function _cut_sheet_description(e){return e.length>30?e.substr(0,27)+"...":e}function on_set_properties(e){if(with3D){var t=_getSingleValue("AxesFile",e.media);t&&ipcApi.set_axes_file(t);var i=_getSingleValue("Skin",e.media);i&&ipcApi.setCortonaSkin(i)}}function activateView(e){e&&(workTable.setFullTable(!1),enableCallouts(!1),document.getElementById("chkFullTable").checked=!1,disableViews(!0),workTable.reset(),document.getElementById("slctUsage").selectedIndex=0,document.getElementById("slctModel").selectedIndex=0,document.getElementById("slctSB").selectedIndex=0,workTable.setBlock(!0),last_view=e,with3D?e!=current_view?skip_animation||is2D?ipcApi.setIPCView(e):ipcApi.gotoIPCView(e):(ipcApi.resetIPCView(),on_view_changed(e)):on_view_changed(e))}function disableViews(e){try{document.getElementById("viewsSelector").disabled=e,document.getElementById("chkFullTable").disabled=e,document.getElementById("slctUsage").disabled=e,document.getElementById("slctModel").disabled=e,document.getElementById("slctSB").disabled=e,topControl.blocked=e}catch(e){}dispatchContentResize()}function selectView(e){if(document.getElementById("viewsSelector").options.length>e){try{var t=window.location.hash.toString();t&&"#"!=t&&window.location.assign("#")}catch(e){}activateView(document.getElementById("viewsSelector").options[e].value)}}function GetCurrentDate(){var e=new Date,t="";return t+=e.getFullYear(),e.getMonth()<9&&(t+="0"),t+=e.getMonth()+1,e.getDate()<10&&(t+="0"),t+=e.getDate()}function __printHeaderToHTML(e,t){var i="";return t&&t.length&&(i+="font-weight:"+t[0]+";",i+="font-style:"+t[1]+";",i+="font-size:"+t[2]+"pt;",i+="font-family:"+t[3]+";"),e.split(/[\r\n]+/).map(function(e){return'<div class="__printLine" style="'+i+'">'+e.split("&b").map(function(e,t){return'<span class="__printCell'+t+'">'+(e?e:"&nbsp;")+"</span>"}).join("")+"</div>"}).join("")}function print3D(){var e=prnApiGeneric;ipcApi&&ipcApi.setPrintHeaderStyle&&(e=ipcApi);var t,i,n;if(!is2D&&with3D||!isCortona3D){var o="undefined"!=typeof iPrint3DHeaderStyle,r="undefined"!=typeof iPrint3DFooterStyle;if(o&&e.setPrintHeaderStyle(iPrint3DHeaderStyle),r&&e.setPrintFooterStyle(iPrint3DFooterStyle),"S1000D"==specType)n=view_description,view_description.length>65&&(n=n.substr(0,64)),o||e.setPrintHeaderStyle(["normal","normal","6","Tahoma","1","solid"]),e.setPrintHeader(iPrint3DHeaderTitle+M_CSN+"   "+iFigureNamePrefix+" "+M_FIGURE+"   "+iRevisionNamePrefix+" "+M_TSN+"  "+formated_rev_date+"&b&b"+n),r||e.setPrintFooterStyle(["normal","normal","7","Tahoma","1","solid"]);else if("ATA"==specType){t=view_description,i=M_TITLE;var s="";""!==M_ENGINEMODEL&&(s=iModelNamePrefix+" "+M_ENGINEMODEL),t.length>70&&(t=t.substr(0,68)+"..."),i.length>70&&(i=i.substr(0,68)+"..."),o||e.setPrintHeaderStyle(["normal","normal","7.5","Tahoma","1","solid"]),e.setPrintHeader(iPrint3DHeaderTitle+M_CSN+"  "+iFigureNamePrefix+" "+M_FIGURE+"&b&b"+iRevisionNamePrefix+" "+M_TSN+"\n"+i+"&b&b"+formated_rev_date+"\n"+t+"&b&b"+s),r||e.setPrintFooterStyle(["normal","normal","7.5","Tahoma","1","solid"])}else"ITEM"==specType?(t=view_description,i=M_TITLE,t.length>70&&(t=t.substr(0,68)+"..."),i.length>70&&(i=i.substr(0,68)+"..."),o||e.setPrintHeaderStyle(["normal","normal","7.5","Tahoma","1","solid"]),e.setPrintHeader(iPrint3DHeaderTitle+M_TOOLNBR+"&b&b"+iRevisionNamePrefix+" "+M_TSN+"\n"+i+"&b&b"+formated_rev_date+"\n"+t),r||e.setPrintFooterStyle(["normal","normal","7.5","Tahoma","1","solid"])):"GENERIC"==specType&&(n=view_description,view_description.length>65&&(n=n.substr(0,64)),o||e.setPrintHeaderStyle(["normal","normal","8","Tahoma","1","solid"]),e.setPrintHeader(iPrint3DHeaderTitle+M_TITLE),r||e.setPrintFooterStyle(["normal","normal","8","Tahoma","1","solid"]));e.setPrintFooter(preparePrintFooter(iPrint3DFooterProprietary,iPrint3DFooterPrinted+_getFormatedDate(GetCurrentDate())))}if(is2D)print2D();else if(with3D){if(!isCortona3D){document.getElementById("tablePanel").style.display="none",document.getElementById("viewersPanel").style.display="block",document.getElementById("cContainer").style.height="",document.getElementById("viewersPanel").style.width="";var a=cortona3d.scene("cContainer")[viewer3DKey].instance.style;a.width="170mm",a.height="210mm",on_content_resize()}ipcApi.print3D(function(){isCortona3D||(isTableHidden||(document.getElementById("tablePanel").style.display="block"),document.getElementById("viewersPanel").style.display="",a.width="100%",a.height="100%",setTimeout(on_content_resize,10))}),isMSIE&&isCortona3D&&!ipcApi.checkPrintComponent()&&alert(iWarningPrintComponentNotFound)}}function preparePrintFooter(e,t){for(var i="",n=e.split("\n"),o=t.split("\n"),r=Math.max(n.length,o.length),s=0;s<r;s++)n.length>s&&(i+=n[s]),o.length>s&&(i+="&b&b"+o[s]),s!==r-1&&(i+="\n");return i}function printTable(){document.getElementById("cContainer").style.display="none",document.getElementById("viewer_printHeader").style.display="none",document.getElementById("viewer_printFooter").style.display="none";var e=("undefined"!=typeof iPrintHeaderHtml,"undefined"!=typeof iPrintFooterHtml,!1);updateTableHeader(),e||window.print(),document.getElementById("cContainer").style.display="",document.getElementById("viewer_printHeader").style.display="",document.getElementById("viewer_printFooter").style.display=""}function setFullTable(e){workTable&&workTable.setFullTable(e)}function hideTable(e){document.getElementById("tablePanel").style.display=e?"none":"",isTableHidden=e,dispatchContentResize(),setTimeout(gohome_iso,200)}function setIgnoreTransp(e){ipcApi.SKIP_TRANSPARENCY_THRESHOLD_LEVEL=e?0:.95}function TopLineControl(){this.blocked=!0,this.buttonsNames=["btn_3donly","btn_skipanimation","btn_ignoretransp","btn_help","btn_print_3d","btn_print_table","btn_reset","btn_excel","btn_callouts","btn_2d","btn_composite_print"],this.btns=[];for(var e=0;e<this.buttonsNames.length;e++){var t=document.getElementById(this.buttonsNames[e]);t&&(this.btns.push({span:t,state:0,pressed:!1,over:!1}),function(e){t.onclick=function(){topControl.onBtnClick(e)},t.onmouseover=function(){topControl.onBtnOver(e)},t.onmouseout=function(){topControl.onBtnOut(e)},t.onmousedown=function(){topControl.onMouseDown(e)},t.onmouseup=function(){topControl.onMouseUp(e)}}(e))}this.btns[2].state=1,this.btns[2].span.style.backgroundPosition="-50px 0"}function TopLineControl_setState(e,t){this.btns[e].state=t,this.btns[e].span.style.backgroundPosition=1==t?"-50px 0":this.btns[e].over?"-25px 0":"0 0"}function TopLineControl_onMouseDown(e){this.blocked&&3!=e||(this.btns[e].pressed=!0,this.btns[e].span.style.backgroundPosition="-50px 0")}function TopLineControl_onMouseUp(e){this.blocked&&3!=e||(0===this.btns[e].state&&(this.btns[e].span.style.backgroundPosition=this.btns[e].over?"-25px 0":"0 0"),this.btns[e].pressed=!1)}function TopLineControl_onBtnClick(e){this.blocked&&3!=e||((e<3||8==e||9==e)&&(0===this.btns[e].state?(this.btns[e].state=1,this.btns[e].span.style.backgroundPosition="-50px 0"):(this.btns[e].state=0,this.btns[e].span.style.backgroundPosition="-25px 0")),0===e?hideTable(1==this.btns[e].state):1==e?skip_animation=1==this.btns[e].state:2==e?setIgnoreTransp(1==this.btns[e].state):3==e?showHelp():4==e?print3D():5==e?(clearTempGraphics(),printTable()):6==e?activateView(last_view):7==e?workTable.toExcel():8==e?enableCallouts(1==this.btns[e].state):9==e?set2D(1==this.btns[e].state):10==e&&compositePrint())}function TopLineControl_onBtnOver(e){this.blocked&&3!=e||(this.btns[e].over=!0,0===this.btns[e].state&&(this.btns[e].span.style.backgroundPosition=this.btns[e].pressed?"-50px 0":"-25px 0"))}function TopLineControl_onBtnOut(e){this.blocked&&3!=e||(this.btns[e].over=!1,0===this.btns[e].state&&(this.btns[e].span.style.backgroundPosition="0 0"))}function NavigationControl(){this.buttonsNames=["btnSpin","btnZoom","btnPan","btnCenter","btnFit","btnCMark","btnV1","btnV2","btnV3","btnV4","btnV5","btnV6","btnV7"],this.modes=["spin","zoom","pan","goto"],this.sviews=["front","back","left","right","top","bottom","isometric"],this.btns=[];for(var e=0;e<this.buttonsNames.length;e++){var t=document.getElementById(this.buttonsNames[e]);t&&(this.btns.push({span:t,state:0,pressed:!1,over:!1}),function(e){t.onclick=function(){navControl.onBtnClick(e)},t.onmouseover=function(){navControl.onBtnOver(e)},t.onmouseout=function(){navControl.onBtnOut(e)},t.onmousedown=function(){navControl.onMouseDown(e)},t.onmouseup=function(){navControl.onMouseUp(e)}}(e))}this.currentMode=0,this.btns[0].state=1,this.btns[0].span.style.backgroundPosition="-64px 0",this.btns[5].state=1,this.btns[5].span.style.backgroundPosition="-64px 0"}function NavigationControl_onMouseDown(e){this.btns[e].pressed=!0,this.btns[e].over?this.btns[e].span.style.backgroundPosition=e<6?"-64px 0":"-44px 0":this.btns[e].span.style.backgroundPosition="0 0"}function NavigationControl_onMouseUp(e){0===this.btns[e].state&&(this.btns[e].span.style.backgroundPosition=e<6?"-32px 0":"-22px 0"),this.btns[e].pressed=!1}function NavigationControl_onBtnClick(e){if(e<4)if(0===this.btns[e].state){this.btns[e].state=1,this.btns[e].span.style.backgroundPosition="-64px 0",ipcApi.setNavigationStyle(this.modes[e]);for(var t=0;t<this.modes.length;t++)e!=t&&(this.btns[t].state=0,this.btns[t].span.style.backgroundPosition="0 0")}else 3==e&&this.onBtnClick(0);else 4==e?ipcApi.fitToViewParts():5==e?0===this.btns[e].state?(this.btns[e].state=1,ipcApi.set_ui_centerpoint(!0),this.btns[e].span.style.backgroundPosition="-64px 0"):(this.btns[e].state=0,ipcApi.set_ui_centerpoint(!1),this.btns[e].span.style.backgroundPosition="0 0"):ipcApi.fitToViewParts(this.sviews[e-6])}function NavigationControl_onBtnOver(e){this.btns[e].over=!0,0===this.btns[e].state&&(this.btns[e].pressed?this.btns[e].span.style.backgroundPosition=e<6?"-64px 0":"-44px 0":this.btns[e].span.style.backgroundPosition=e<6?"-32px 0":"-22px 0")}function NavigationControl_onBtnOut(e){this.btns[e].over=!1,0===this.btns[e].state&&(this.btns[e].span.style.backgroundPosition="0 0")}function NavigationControl_checkMode(){if(ipcApi.getNavigationStyle()!=this.modes[3])for(var e=0;e<this.modes.length;e++)if(ipcApi.getNavigationStyle()==this.modes[e])return void this.onBtnClick(e)}function on_3D_selection(e){e.length>0?document.getElementById("txtCalloutCaption").value=e[e.length-1].getItemNumber():document.getElementById("txtCalloutCaption").value="",selected3DItems=[];for(var t=0;t<e.length;t++)e[t].state>=0&&e[t].presentInSheet&&selected3DItems.push(e[t]);var i=0===selected3DItems.length;document.getElementById("ScrollSliderCaption").style.visibility=i?"hidden":"visible",document.getElementById("ScrollSlider").style.visibility=i?"hidden":"visible",disableButton("btnFitSelection",i||isCalloutsMode),disableButton("btnShowSelection",i),disableButton("btnHideSelection",i),selected3DItems.length>0&&(is_tSliderActive=!1,tSlider.scrollLeft=selected3DItems[0].getTransparency()*(tSlider.scrollWidth-tSlider.offsetWidth)/.85)}function fit_3D_selection(){selected3DItems.length>0&&workTable.fitToItems(selected3DItems)}function hide_3D_selection(){isMSIE||ipcApi.setAutoRefreshOff();for(var e=0;e<selected3DItems.length;e++)selected3DItems[e].show(!1);isMSIE||ipcApi.setAutoRefreshOn()}function show_3D_selection(){isMSIE||ipcApi.setAutoRefreshOff();for(var e=0;e<selected3DItems.length;e++)selected3DItems[e].show(!0);isMSIE||ipcApi.setAutoRefreshOn()}function set_transparency_3D_selection(){if(is_tSliderActive){var e;e=tSlider.scrollWidth==tSlider.offsetWidth?.85*tSlider.scrollLeft/1080:.85*tSlider.scrollLeft/(tSlider.scrollWidth-tSlider.offsetWidth),isMSIE||ipcApi.setAutoRefreshOff();for(var t=0;t<selected3DItems.length;t++)selected3DItems[t].setTransparency(e);isMSIE||ipcApi.setAutoRefreshOn()}}function showHelp(){try{helpWindow.close()}catch(e){}helpWindow=window.open(resFolder+helpFile,"","statusbar=no,resizable=yes,scrollbars=yes,width=750,height=600")}function enableCallouts(e){with3D&&(isCalloutsMode=e,ipcApi.enableNavigation(!e),ipcApi.clearAllCallouts(),calloutDraw=null,allCallouts=[],document.getElementById("navigation_controls").style.display=isCalloutsMode?"none":"",document.getElementById("callouts_controls").style.display=isCalloutsMode?"":"none",topControl.setState(8,isCalloutsMode?1:0),disableButton("btnFitSelection",0===selected3DItems.length||isCalloutsMode),workTable.block_fit=isCalloutsMode)}function undoCallout(){allCallouts.length>0&&allCallouts.pop().hide(),document.getElementById("btnCalloutsUndo").disabled=0===allCallouts.length}function defaultHandler(event){var res=!0,targetEvent,scene=cortona3d.scene("cContainer");switch(event.type){case"OnObjectMouseDown":if(targetEvent=event.detail.src,1===targetEvent.button?SmartCloseContextMenu(targetEvent.clientX,targetEvent.clientY):CloseContextMenu(),navControl.checkMode(),isCalloutsMode&&1===targetEvent.button){if(""===document.getElementById("txtCalloutCaption").value)return setTimeout(function(){alertx(iWarningEmptyCalloutTextBox)},0),void document.getElementById("txtCalloutCaption").focus();calloutDraw=new cortona3d.interfaces[viewer3DKey].Callout3D(document.getElementById("txtCalloutCaption").value,targetEvent.worldX,targetEvent.worldY,targetEvent.worldZ),calloutDraw.show()}break;case"MouseDown":if(!event.detail.src&&(targetEvent={Button:event.detail.raw[0],Shift:event.detail.raw[1],X:event.detail.raw[2],Y:event.detail.raw[3]},navControl.checkMode(),isCalloutsMode&&1===targetEvent.Button)){if(""===document.getElementById("txtCalloutCaption").value)return setTimeout(function(){alertx(iWarningEmptyCalloutTextBox)},0),void document.getElementById("txtCalloutCaption").focus();calloutDraw=new cortona3d.interfaces[viewer3DKey].Callout3D(document.getElementById("txtCalloutCaption").value,targetEvent.X,targetEvent.Y,targetEvent.X,targetEvent.Y),calloutDraw.show()}break;case"MouseUp":targetEvent=event.detail.src,targetEvent||(targetEvent={button:event.detail.raw[0],keys:event.detail.raw[1],clientX:event.detail.raw[2],clientY:event.detail.raw[3]}),!workTable.cMenu.checkIsOpen()&&targetEvent&&2===targetEvent.button&&workTable.cMenu.show(null,targetEvent.clientX,targetEvent.clientY,viewer3DNode,!0),navControl.checkMode(),targetEvent&&calloutDraw&&(calloutDraw.setPoint2(targetEvent.clientX,targetEvent.clientY),allCallouts.push(calloutDraw),calloutDraw=null,document.getElementById("btnCalloutsUndo").disabled=!1);break;case"MouseMove":targetEvent=event.detail.src,targetEvent||(targetEvent={button:event.detail.raw[0],keys:event.detail.raw[1],clientX:event.detail.raw[2],clientY:event.detail.raw[3]}),calloutDraw&&calloutDraw.setPoint2(targetEvent.clientX,targetEvent.clientY);break;case"HotspotHit":res=isoview2DControl_ObjectHit(1,event.detail.raw[0],"",event.detail.raw[1]);break;case"HotspotEnter":res=isoview2DControl_ObjectHit(0,event.detail.raw[0],"");break;case"HotspotLeave":res=isoview2DControl_ObjectHit(0,"","");break;case"ContextMenuItemHit":try{cmenuActions.length>=event.detail.raw[0]&&eval(cmenuActions[event.detail.raw[0]-1])}catch(e){}break;case"ObjectHit":res=isoview2DControl_ObjectHit.apply(null,event.detail.raw);break;case"HotspotMenu":res=cortona2DControl_HotspotMenu.apply(null,event.detail.raw);break;case"HotspotMenuSelect":try{eval(cmenuObjs[event.detail.raw[1]])}catch(e){}break;case"ContextMenu":var item=workTable.getItemBy2DHotspot(event.detail.raw[0]),x=event.detail.raw[1],y=event.detail.raw[2];workTable.cMenu.close(),ipcApi.tooltipOver3D.hide(),workTable.cMenu.show(item,x,y,document.body,!1);break;case"DocumentComplete":scene.error&&scene.remove(scene.error);break;case"DocumentLoadingError":var message="Failed to loading image "+event.detail.raw[0]+".";"undefined"!=typeof event.detail.raw[1]?message+=" XHR Status: "+event.detail.raw[1]:event.detail.src instanceof Error&&(message+=" Reason: "+event.detail.src.message),scene.loading.hide(),cortona3d.app.error(message,"","","",new Error(message))}switch(event.type){case"OnObjectVMMove":case"MouseMove":case"OnMouseEnter":case"OnMouseOut":case"OnFrameRateMeasured":case"OnCameraMove":return res}var msg=event.type+"("+(event.target.id||event.target.localName)+"): "+event.detail.raw.map(function(e){if(e&&void 0!==e.toString)return e.toString();switch(typeof e){case"string":case"number":case"boolean":return e;default:return typeof e}});return console.log(msg),res}function insertLoadingRing(){}function embed3DControl(){var e=cortona3d.scene("cContainer");e.add(cortona3d.factory[viewer3DKey]);var t=cortona3d.RGB(255,255,255);try{t=parseInt(clr3DBackgroundColor.substr(5,2)+clr3DBackgroundColor.substr(3,2)+clr3DBackgroundColor.substr(1,2),16)}catch(e){}if(viewer3DNode=e[viewer3DKey].instance,"viewer3d"==viewer3DKey){var i={BackColor:t,GradientBackColor:t,Skin:cortona3d.factory[viewer3DKey].skins.review,ConsoleMode:0,ContextMenu:!1,ShowLogo:!1,LoadDroppedScene:!1,HeadLight:!0,NavigationBar:0,RendererHints:5168,RendererOptimization:0,TravelSpeed:2,viewpoint_transition_mode:0,WaitForAllResources:!0,PixelBufferAccess:!0};forceDirectX&&(i.RendererName="DirectX Renderer"),cortona3d.expand(viewer3DNode,i)}cortona3d.factory[viewer3DKey].events.forEach(function(t){e.container.addEventListener(t,defaultHandler,!1)})}function embed2DControl(){var e=cortona3d.scene("cContainer");e.add(cortona3d.factory[viewer2DKey]),viewer2DNode=e[viewer2DKey].instance,cortona3d.factory[viewer2DKey].events.forEach(function(t){e.container.addEventListener(t,defaultHandler,!1)})}function alertx(e){""!==e&&alert(e)}function RGB(e,t,i){return e+256*t+65536*i}function checkControl2D(){return!0}function load_2D_graphics(e){if(C2D_check(),!isControl2DNotFound&&(C2D_closeFile(),e&&""!==e)){if(isCGMLoaded=C2D_open(e),errCode=[!isCGMLoaded&&!is2D,e],!isCGMLoaded&&is2D&&alertx(iWarning2DViewerLoadingError+" "+e),2==viewer2DType){var t=!0;"undefined"!=typeof iCompleteControl2DToolBox?t=!iCompleteControl2DToolBox:("ATA"==specType&&"undefined"!=typeof isFixedPrintTable&&isFixedPrintTable||"ITEM"==specType)&&(t=!1);try{t&&parseInt(viewer2DNode.GetVersion().substr(0,1),10)>=6&&viewer2DNode.ConfigTools2(1,39,1,!1,!1),viewer2DNode.Iso4SetPreference("use_default_printer",0)}catch(e){}viewer2DNode.AcceptDroppedFiles=!1,viewer2DNode.Iso3SetObjectTipStyle("Arial",8,0,1,1,1e3),viewer2DNode.ResizeToFit=!0,viewer2DNode.SetPrintStringStyle(1,"Tahoma",8,0,0,20,20,5,5),viewer2DNode.SetPrintStringStyle(2,"Tahoma",8,0,0,20,20,5,5),viewer2DNode.Iso3SetHome(e)}setTimeout(gohome_iso,200),ISOSELECTEDCOLOR=get2DColor(clr2DSelectedColor,ISOSELECTEDCOLOR),ISOHLIGHTEDCOLOR=get2DColor(clr2DHighLightColor,ISOHLIGHTEDCOLOR),1==viewer2DType&&(viewer2DNode.HitColor=ISOHLIGHTEDCOLOR),reset2DContextMenu()}}function get2DColor(e,t){var i=t;try{i=RGB(parseInt("0x"+e.substr(1,2),16),parseInt("0x"+e.substr(3,2),16),parseInt("0x"+e.substr(5,2),16))}catch(e){}return i}function select_iso(e){if(isCortona3D)C2D_HHsp(e,!0,ISOSELECTEDCOLOR);else{var t=cortona3d.scene("cContainer")[viewer2DKey].instance;Array.prototype.slice.call(t.getElementsByTagName("a")).forEach(function(t){t.getAttribute("name")===e&&Array.prototype.slice.call(t.getElementsByTagName("path")).forEach(function(e){
e.style.fill=clr2DSelectedColor,e.style.fillOpacity=1})})}}function unselect_iso(e){if(isCortona3D)C2D_HHsp(e,!1,ISONORMALCOLOR);else{var t=cortona3d.scene("cContainer")[viewer2DKey].instance;Array.prototype.slice.call(t.getElementsByTagName("a")).forEach(function(t){t.getAttribute("name")===e&&Array.prototype.slice.call(t.getElementsByTagName("path")).forEach(function(e){e.style.fill="",e.style.fillOpacity=0})})}}function hlight_iso(e){if(isCortona3D)C2D_HHsp(e,!0,ISOHLIGHTEDCOLOR);else{var t=cortona3d.scene("cContainer")[viewer2DKey].instance;Array.prototype.slice.call(t.getElementsByTagName("a")).forEach(function(t){t.getAttribute("name")===e&&Array.prototype.slice.call(t.getElementsByTagName("path")).forEach(function(e){e.style.stroke=clr2DHighLightColor})})}}function unhlight_iso(e){if(isCortona3D)C2D_HHsp(e,!1,ISONORMALCOLOR);else{var t=cortona3d.scene("cContainer")[viewer2DKey].instance;Array.prototype.slice.call(t.getElementsByTagName("a")).forEach(function(t){t.getAttribute("name")===e&&Array.prototype.slice.call(t.getElementsByTagName("path")).forEach(function(e){e.style.stroke=""})})}}function dispose2DContextMenu(){2==viewer2DType&&(viewer2DNode.DisposeContextMenu(),cmenuActions=[])}function add2DContextItem(e,t,i){""!==e&&2==viewer2DType&&(viewer2DNode.AddContextMenuItem(e,t),t?cmenuActions.push(i):cmenuActions.push(null))}function reset2DContextMenu(){isControl2DNotFound||2!=viewer2DType||(dispose2DContextMenu(),add2DContextItem(iContextMenuAbout,!0,"cortona3d.app.showAbout();"),viewer2DNode.CreateContextMenu())}function isoview2DControl_ObjectHit(e,t,i,n){dispose2DContextMenu();var o,r=t,s=[];if(1==viewer2DType){if(""!==t){r=viewer2DNode.GetHotspotName(t);try{var a=viewer2DNode.getWebCGMDocument(),l=a.firstPicture,c=l.getAppStructureById(t);s=c.getAppStructureAttr("linkuri");var d=s.substring(0,1);s=s.split(d)}catch(e){}}}else if(2==viewer2DType)try{r=viewer2DNode.Iso3GetObjectName(t)}catch(e){}if(1==e){if(s.length)return navigateLink(s[1],s[5]),!0;var u=0;arguments.length>3&&(u=n),workTable.onClick2D(r,u)}else workTable.onOver2D(r);if(2==viewer2DType){if(contextItem=workTable.getItemBy2DHotspot(r)){var p=contextItem;add2DContextItem(p.getTitle(),!1),p.presentInSheet&&(p.selected?add2DContextItem(iContextMenuUnselect,!0,"cortona3d.app.selectontextItem(false);"):add2DContextItem(iContextMenuSelect,!0,"cortona3d.app.selectontextItem(true);"));var h=rightViews,f=[];for(o=0;o<h.length;o++)if(!h[o].hidden)for(var m=h[o],v=0;v<m.items.length;v++)if(m.items[v]==p.index){f.push(m);break}if(!workTable._checkUnusedItem(p)&&f.length>0)for(add2DContextItem("---",!1),o=0;o<f.length;o++){var _=iContextMenuGotoViewPrefix+" "+_cut_sheet_description(f[o].description);f[o].id==current_view?add2DContextItem(_+" "+iContextMenuActiveViewMark,!1):add2DContextItem(_,!0,'cortona3d.app.activateView("'+f[o].id+'");')}add2DContextItem("---",!1);var g=ipc_data.dplist[p.index].links;if(g.length>0){for(o=0;o<g.length;o++)add2DContextItem(g[o].description,!0,"cortona3d.app.openLink("+p.index+","+o+");");add2DContextItem("---",!1)}}add2DContextItem(iContextMenuAbout,!0,"cortona3d.app.showAbout();"),viewer2DNode.CreateContextMenu()}return!0}function cortona2DControl_HotspotMenu(e,t){if(t.RemoveMenuItem(32777),t.RemoveMenuItem(32778),cmenuObjs={},""!==e){var i=viewer2DNode.GetHotspotName(e);if(""!==i&&(contextItem=workTable.getItemBy2DHotspot(i))){t.RemoveAll();var n=contextItem;t.AppendMenuItem(n.getTitle(),3),n.selected?cmenuObjs[t.AppendMenuItem(iContextMenuUnselect,32)]="cortona3d.app.selectontextItem(false);":cmenuObjs[t.AppendMenuItem(iContextMenuSelect,32)]="cortona3d.app.selectontextItem(true);";for(var o=rightViews,r=[],s=0;s<o.length;s++)if(!o[s].hidden)for(var a=o[s],l=0;l<a.items.length;l++)if(a.items[l]==n.index){r.push(a);break}if(!workTable._checkUnusedItem(n)&&r.length>0)for(s=0;s<r.length;s++){var c=0===s?32:0,d=iContextMenuGotoViewPrefix+" "+_cut_sheet_description(r[s].description);r[s].id==current_view?cmenuObjs[t.AppendMenuItem(d+" "+iContextMenuActiveViewMark,7+c)]="":cmenuObjs[t.AppendMenuItem(d,c)]='cortona3d.app.activateView("'+r[s].id+'");'}var u=ipc_data.dplist[n.index].links;if(u.length>0)for(s=0;s<u.length;s++)cmenuObjs[t.AppendMenuItem(u[s].description,0===s?32:0)]="cortona3d.app.openLink("+n.index+","+s+");"}}cmenuObjs[t.AppendMenuItem(iContextMenuAbout,32)]="cortona3d.app.showAbout();"}function gohome_iso(){!isControl2DNotFound&&isCGMLoaded&&(1==viewer2DType?viewer2DNode.ResetView():2==viewer2DType&&viewer2DNode.GoHome(),isFirstISO&&with2D&&(isFirstISO=!1,hideCortona2D(!is2D)))}function print2D(){if(!isControl2DNotFound&&isCGMLoaded){var e=view_description;e.length>50&&(e=e.substr(0,48)+"...");var t="",i=""!==iPrintCGMFooterProprietary?iPrintCGMFooterProprietary+" ":"";"S1000D"==specType?(t=iPrintCGMHeaderTitle+" "+M_CSN+"   "+iFigureNamePrefix+" "+M_FIGURE+"   "+iRevisionNamePrefix+" "+M_TSN+"  "+formated_rev_date+" "+e,i=i+iPrintCGMFooterPrinted+_getFormatedDate(GetCurrentDate())):"GENERIC"==specType?(t=iPrintCGMHeaderTitle+" "+M_TITLE+"  "+e,i=i+iPrintCGMFooterPrinted+_getFormatedDate(GetCurrentDate())):"ATA"==specType?(t=iPrintCGMHeaderTitle+" "+M_CSN+"   "+iFigureNamePrefix+" "+M_FIGURE+"   "+iRevisionNamePrefix+" "+M_TSN+"  "+formated_rev_date+" "+e,i=i+iPrintCGMFooterPrinted+_getFormatedDate(GetCurrentDate())):"ITEM"==specType&&(t=iPrintCGMHeaderTitle+M_TOOLNBR+"   "+iRevisionNamePrefix+" "+M_TSN+"  "+formated_rev_date+" "+e,i=i+iPrintCGMFooterPrinted+_getFormatedDate(GetCurrentDate())),C2D_print(t,i)}}function C2D_check(){try{viewer2DNode.CloseFile(),isControl2DNotFound=!1,1==viewer2DType&&"undefined"!=typeof langID&&(viewer2DNode.LangID=langID)}catch(e){isControl2DNotFound=isCortona3D}return!isControl2DNotFound}function getAbsoluteUrl(e){var t=location.protocol+"//"+location.host,i=location.pathname.replace(/[^\/]+$/,"");return e&&e.indexOf("://")===-1&&(e="/"===e.charAt(0)?t+e:t+i+e),e}function C2D_open(e){var t=!0,i=/\.(png|jpg)$/i.test(e);return cortona3d.scene("cContainer")[viewer2DKey].load(e,i),t}function C2D_closeFile(){cortona3d.scene("cContainer")[viewer2DKey].unload()}function C2D_print(e,t){1==viewer2DType?viewer2DNode.Print(e,t):2==viewer2DType?(viewer2DNode.SetPrintStrings(e,t),viewer2DNode.DoPrint(1,0,1,-1)):(document.getElementById("viewersPanel").style.display="block",document.getElementById("tablePanel").style.display="none",document.getElementById("cContainer").style.height="",document.getElementById("viewersPanel").style.width="",window.print(),isTableHidden||(document.getElementById("tablePanel").style.display="block"),document.getElementById("viewersPanel").style.display="",dispatchContentResize())}function C2D_version(){try{return 1==viewer2DType?"Cortona2D Viewer "+viewer2DNode.GetVersion():2==viewer2DType?"IsoView "+viewer2DNode.GetVersion():"HTML5 SVG 1.1"}catch(e){}return""}function C2D_HHsp(e,t,i){if(!isControl2DNotFound&&isCGMLoaded&&e)if(1==viewer2DType){var n=[];try{n=viewer2DNode.GetHotspotIDs(e).toArray()}catch(e){}for(var o=0;o<n.length;o++)viewer2DNode.HighlightHotspot(n[o],t,i)}else 2==viewer2DType&&viewer2DNode.Iso3HighlightObject("name("+e+")",t?4:0,i)}function C2D_findHotspot(e){if(isControl2DNotFound||!isCGMLoaded||!e)return!1;var t=!1;if(1==viewer2DType)try{t=viewer2DNode.GetHotspotIDs(e).toArray().length>0}catch(e){}else if(2==viewer2DType)try{t=""!==viewer2DNode.Iso3GetObjectLayer("name("+e+")")}catch(e){}else{var i=cortona3d.scene("cContainer")[viewer2DKey].instance;t=Array.prototype.slice.call(i.getElementsByTagName("a")).some(function(t){return t.getAttribute("name")===e})}return t}function C2D_setTooltip(e,t){try{if(1==viewer2DType){var i=[];try{i=viewer2DNode.GetHotspotIDs(e).toArray()}catch(e){}for(var n=0;n<i.length;n++)viewer2DNode.SetObjectTip(i[n],t)}else 2==viewer2DType?viewer2DNode.Iso3SetObjectTip("name("+e+")",t):document.getElementById("cContainer").title=t}catch(e){}}function getCGM(e){for(var t="",i=rightViews,n=0;n<i.length;n++)if(i[n].id==current_view){try{t=i[n].cgmsrc}catch(e){}break}return t}function hideCheckBoxesColumn(e){var t,i=document.querySelectorAll(".chkbox"),n=e?"":"hidden";for(t=0,length=i.length;t<length;t++)i[t].style.visibility=n;i=document.querySelectorAll(".ccl");var o=e?"":"0";for(t=0,length=i.length;t<length;t++)i[t].style.borderRightWidth=o;var r=[].concat(tableColsWidth);e||(r[1]=isIE8?5:1),setCollumnsWidth(r),dispatchContentResize()}function _HideTC(e,t){for(var i=document.getElementById(e).rows,n=t?"":"0",o=0;o<i.length;o++){var r=i[o].cells;r.length>1&&(r[1].style.width=n)}}function hideCortona3D(e){var t=e?"hide":"show";if(cortona3d.scene("cContainer")[viewer3DKey][t](),isX3DOM){var i=document.getElementById("x3dAxes");i&&(i.style.display=e?"none":"block")}}function hideCortona2D(e){var t=e?"hide":"show";cortona3d.scene("cContainer")[viewer2DKey][t]()}function set2D(e){is2D=e,hideCortona3D(is2D),hideCortona2D(!is2D),enableCallouts(!1),document.getElementById("cFooter").style.display=is2D?"none":"",document.getElementById("lblChbxShowBoxes").style.display=is2D?"none":"",document.getElementById("chbxShowBoxes").style.display=is2D?"none":"",document.getElementById("btn_callouts").style.display=is2D||isTiramisu?"none":"",document.getElementById("btn_ignoretransp").style.display=is2D?"none":"",document.getElementById("btn_skipanimation").style.display=is2D?"none":"",document.getElementById("chbxShowBoxes").disabled=is2D,hideCheckBoxesColumn(!is2D&&user_chkbxs);var t=cortona3d.scene("cContainer");if(t.error&&t.remove(t.error),!t[e?viewer2DKey:viewer3DKey].isValid()){var i=(e?viewer2DNode:viewer3DNode)[sInnerText];cortona3d.app.error(i,"","","",new Error(i))}dispatchContentResize()}function getVersion(){var e="2.5.7.126";try{e=ipcPublisherVersion}catch(e){}var t="0.0";return"undefined"!=typeof ipcSpecVersion&&""!==ipcSpecVersion&&(t=ipcSpecVersion),e+"-"+t+"-"+ipcScriptVersion}function showAbout(){var e="";with3D&&(e+="\n"+iAboutCortonaVersion+" "+cortona3d.scene("cContainer")[viewer3DKey].version()),with2D&&(e+="\n"+iAboutCgmViewerVersion+" "+cortona3d.scene("cContainer")[viewer2DKey].version()),alertx(iAboutDocumentVersion+" "+getVersion()+e)}function getCollumnsWidth(){for(var e=getTableCollumnCells(document.getElementById("tableHeader")),t=getTableCollumnCells(document.getElementById("tableIPC")),i=[],n=0;n<e.length&&n<t.length;n++)i.push(Math.max(e[n].offsetWidth,t[n].offsetWidth));return i}function setCollumnsWidth(e){var t=document.getElementById("tableHeader"),i=document.getElementById("tableIPC");t.tableLayout=i.tableLayout="";for(var n,o,r=getTableCollumns(t),s=getTableCollumns(i),a=0,l=0;l<e.length;l++)n=!1,1==l&&(o=getCSSRule("screen","col.col01"),o&&(o.style.width=e[l]+"px",n=!0)),n||(r[l].style.width=e[l]+"px",s[l].style.width=e[l]+"px"),a+=e[l];o=getCSSRule("screen","table.ipc"),o&&(o.style.tableLayout="fixed",o.style.width=a+"px");var c=getCSSRule("screen","#ipcfooter");c&&(c.style.display="none"),document.getElementById("screenHeader").style.display=""}function getTableCollumns(e){for(var t=[],i=e.getElementsByTagName("col"),n=0;n<i.length;n++)i[n].parentNode.parentNode!=e&&i[n].parentNode!=e||t.push(i[n]);return t}function getTableCollumnCells(e){var t,i=[],n=0,o=0;for(t=e.rows.length-1;t>=0;t--)o<e.rows[t].cells.length&&(o=e.rows[t].cells.length,n=t);var r=e.rows[n].cells;for(t=0;t<r.length;t++)i.push(r[t]);return i}function getCSSRule(e,t){var i,n=e.toLowerCase(),o=t.toLowerCase(),r=[];for(i=0;i<document.styleSheets.length;i++)(document.styleSheets[i].media.mediaText&&document.styleSheets[i].media.mediaText.toLowerCase()==n||document.styleSheets[i].media==n)&&r.push(document.styleSheets[i]);if(r.length>0)for(var s=0;s<r.length;s++){var a=isMSIE?r[s].rules:r[s].cssRules;if(a)for(i=0;i<a.length;i++)if(a[i].selectorText.toLowerCase()==o)return a[i]}return null}function disableButton(e,t){document.getElementById(e).disabled=t,document.getElementById(e).style.color=t?"#777777":""}function compositePrint(){checkControl2D()&&(updateTableHeader(),clearTempGraphics(),isSpPrn=!0,prepareGraphics(printTable))}function prepareGraphicsAsync(e){function t(n){i.container.removeEventListener("DocumentComplete",t,!1),i.container.removeEventListener("DocumentLoadingError",t,!1);try{"DocumentComplete"==n.type&&(rightViews[prepareGraphicsAsyncCounter].svgCode=i[viewer2DKey].getSVGSource())}catch(e){}prepareGraphicsAsyncCounter--,prepareGraphicsAsync(e)}var i=cortona3d.scene("cContainer");if(prepareGraphicsAsyncCounter>=0){var n=rightViews[prepareGraphicsAsyncCounter].cgmsrc;!rightViews[prepareGraphicsAsyncCounter].svgCode&&n?(i.container.addEventListener("DocumentComplete",t,!1),i.container.addEventListener("DocumentLoadingError",t,!1),i[viewer2DKey].load(getAbsoluteUrl(n))):(prepareGraphicsAsyncCounter--,prepareGraphicsAsync(e))}else e()}function prepareGraphics(e){prepareGraphicsAsyncCounter=rightViews.length-1;var t=viewer2DNode.src;prepareGraphicsAsync(function(){var i,n,o,r=document.getElementById("screenHeader").parentNode,s=document.getElementById("footerContent").innerHTML,a=document.getElementById("metasheet"),l="",c=[],d=!isMSIE,u=0,p="position:relative;";try{d=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}catch(e){}if(d){for(o=rightViews.length-1;o>=0;o--){if(i=rightViews[o].svgCode,!i){if(!rightViews[o].cgmsrc)continue;i='<svg xmlns="http://www.w3.org/2000/svg"><g><title>Error</title><text y="45%" x="50%" text-anchor="middle" fill="#000000" font-size="20" font-family="Sans-serif">Image file transformation error</text><text y="50%" x="50%" text-anchor="middle" fill="#000000" font-size="16" font-family="Sans-serif">'+rightViews[o].cgmsrc+'</text><text y="53%" x="50%" text-anchor="middle" fill="#000000" font-size="7" font-family="Sans-serif">'+viewer2DNode.src+'</text><text y="58%" x="50%" text-anchor="middle" fill="#000000" font-size="20" font-family="Sans-serif">'+C2D_version()+"</text></g></svg>"}i=i.replace(/<\?xml[^>]+\?>/i,""),n=document.createElement("div"),a[sInnerText]=rightViews[o].description,(isChrome||isFF)&&(p="position:absolute; top:"+100*o+"%; ",u++),n.innerHTML='<div class="extgr" style="'+p+'"><div class="grHeader">'+r.innerHTML+'</div><div class="grImg">'+i+'</div><div class="grFooter">'+s+"</div></div>",TEMP_GRAPHICS.push(n.firstChild),document.body.insertBefore(n.firstChild,document.body.firstChild)}(isChrome||isFF)&&(n=document.createElement("div"),n.innerHTML='<style id="chromeCSS" type="text/css" media="print">#tableIPC{position:absolute; top:'+100*u+"%;}</style>",TEMP_GRAPHICS.push(n.firstChild),document.body.insertBefore(n.firstChild,document.body.firstChild)),viewer2DNode.src=t,a[sInnerText]=""}else if(isMSIE){for(o=0;o<rightViews.length;o++)rightViews[o].cgmsrc&&""!==rightViews[o].cgmsrc&&(c.push(o),a[sInnerText]=rightViews[o].description,l+='<table class="crvTable" style="width:100%;height:100%;border-collapse: collapse;"><tr><td class="revcol" rowspan="3">&nbsp;</td><td class="prnHdr">'+r.innerHTML+'</td></tr><tr><td class="tdCRV" align="center" valign="middle"><object class="RapidViewControl" style="width:190mm;height:200mm" id="RpdCntr'+o+'" classid="CLSID:1D4A81CB-25A3-4EB7-A75E-4F8A5386D8F8"></object></td></tr><tr><td class="prnFtr">'+s+"</td></tr></table>");a[sInnerText]="",n=document.createElement("div"),n.className="divCSC",n.innerHTML=l,TEMP_GRAPHICS.push(n),document.body.insertBefore(n,document.body.firstChild);try{if(c.length>0&&"undefined"==typeof document.getElementById("RpdCntr"+c[0]).backColor)for(o=0;o<c.length;o++)document.getElementById("RpdCntr"+c[o]).outerHTML='<div style="padding-top:50%;">'+iCaptionRapid2DViewerNotFound+"</div>";else for(o=0;o<c.length;o++)try{document.getElementById("RpdCntr"+c[o]).openFile(rightViews[c[o]].cgmsrc,"")}catch(e){document.getElementById("RpdCntr"+c[o]).outerHTML='<div style="padding-top:50%;">Cortona2D Viewer ('+document.getElementById("Cntr2D_"+o).GetVersion()+") Error<br>Image file was not loaded:<br>"+rightViews[o].cgmsrc+"</div>"}}catch(e){}}e()})}function clearTempGraphics(){for(var e=0;e<TEMP_GRAPHICS.length;e++)TEMP_GRAPHICS[e].parentNode.removeChild(TEMP_GRAPHICS[e]);TEMP_GRAPHICS=[]}function fBeforePrint(){isSpPrn&&workTable.setPrintMode(!0)}function fAfterPrint(){isSpPrn&&(clearTempGraphics(),isSpPrn=!1,"GENERIC"!=specType&&document.getElementById("metasheet")&&(document.getElementById("metasheet")[sInnerText]=view_description),workTable.setPrintMode(!1))}function onHashChange(){switch(window.location.hash.toString()){case"":on_simulation_load(!0);break;case"#":break;default:var e=window.location.hash.substring(1),t=e.replace(/^([^(]+)\(.*\)$/,"$1").toLowerCase();if(t&&(e=e.replace(/^[^(]+\((.*)\)$/,"$1")),"view"==t){var i=getDefaultView(e);preSelectedItem="",i&&setTimeout(function(){activateView(i)},100)}else setTimeout(function(){workTable.gotoItem(e)},100)}}function _checkSkinControl(){try{skin_navigation.nav_roll=!keepCameraUpRight,skin_navigation.align=!keepCameraUpRight;for(var e,t=viewer3DNode,i=[],n=t.Engine.Nodes.Item("_SKIN_INFO"),o=n.Fields.Item("info"),r=0;r<o.Count;r++)for(e in skin_navigation)if(o.GetValue(r).indexOf(e+"=")>=0){o.SetValue(r,e+"="+skin_navigation[e]),i.push(e);break}for(e in skin_navigation){var s=!1;for(var a in i)a==e&&(s=!0);s||o.Add(e+"="+skin_navigation[e])}}catch(e){}}var isMSIE=!0,isIE8=!1,isOpera=!1,isFF=!1,isChrome=!1,ipcScriptVersion="5.00",with2D=!0,with3D=!0,is2D=!1,C_BLACK=new Array(0,0,0),C_DARKGREY=new Array(.5,.5,.5),C_YELLOW=new Array(1,1,0),selectionChildrenColor="transparent",fullTableRowColor="#808080",isFirstISO=!0,skip_animation=!1,usageList=[],modelsList=[],sbList=[],ipcApi=null,workTable=null,preSelectedItem="",viewer3DNode=null,viewer2DNode=null,sInnerText="innerText",viewer2DType=1,viewer3DType="viewer3d",viewer2DKey="viewer2d",viewer3DKey="viewer3d",errCode=[!1,""],isSpPrn=!1,isUnloaded=!1,chrmCrc=[!0,null],tableColsWidth,user_chkbxs=!0,options={multiLink:!1,rotationCenter:!1,ignoreTransparency:!0},isX3DOM=!1,isCortona3D=!1,isTiramisu=!isCortona3D&&!isX3DOM,skin_navigation={spin:!0,pan:!0,zoom:!0,fit:!1,setcenter:!1,zoom_center:!0,skipsensors:!0,nav_roll:!0,align:!0};IPCTable.prototype.fitToItems=IPCTable_fitToItems,IPCTable.prototype.getItem=IPCTable_getItem,IPCTable.prototype._transformIPCDataToIndexedFormat=IPCTable__transformIPCDataToIndexedFormat,IPCTable.prototype.generateItems=IPCTable_generateItems,IPCTable.prototype.update=IPCTable_update,IPCTable.prototype.setFullTable=IPCTable_setFullTable,IPCTable.prototype.onOver3D=IPCTable_onOver3D,IPCTable.prototype.onClick3D=IPCTable_onClick3D,IPCTable.prototype.onOver2D=IPCTable_onOver2D,IPCTable.prototype.onClick2D=IPCTable_onClick2D,IPCTable.prototype.getItemBy2DHotspot=IPCTable_getItemBy2DHotspot,IPCTable.prototype._onItemClick=IPCTable__onItemClick,IPCTable.prototype._onItemDblClick=IPCTable__onItemDblClick,IPCTable.prototype._onItemOver=IPCTable__onItemOver,IPCTable.prototype._onItemOut=IPCTable__onItemOut,IPCTable.prototype._clearOverItem=IPCTable__clearOverItem,IPCTable.prototype._onChkBox=IPCTable__onChkBox,IPCTable.prototype._onCancelEvent=IPCTable__onCancelEvent,IPCTable.prototype._onTableContextMenu=IPCTable__onTableContextMenu,IPCTable.prototype._onContextMenuClose=IPCTable__onContextMenuClose,IPCTable.prototype.contextMenuClose=IPCTable_contextMenuClose,IPCTable.prototype._onClick=IPCTable__onClick,IPCTable.prototype.clearSelection=IPCTable_clearSelection,IPCTable.prototype.clearHighlight=IPCTable_clearHighlight,IPCTable.prototype.hideSecondary=IPCTable_hideSecondary,IPCTable.prototype.showAll=IPCTable_showAll,IPCTable.prototype.resetMaterials=IPCTable_resetMaterials,IPCTable.prototype.reset=IPCTable_reset,IPCTable.prototype.toExcel=IPCTable_toExcel,IPCTable.prototype.setBlock=IPCTable_setBlock,IPCTable.prototype._onSelectionChanged=IPCTable__onSelectionChanged,IPCTable.prototype.filter=IPCTable_filter,IPCTable.prototype.multifilter=IPCTable_multifilter,IPCTable.prototype._checkUnusedItem=IPCTable__checkUnusedItem,IPCTable.prototype.gotoItem=IPCTable_gotoItem,IPCTable.prototype._updAttRows=IPCTable__updAttRows,IPCTable.prototype._sortSelection=IPCTable__sortSelection,IPCTable.prototype.setPrintMode=IPCTable_setPrintMode,IPCItem.prototype.updateCheckBox=IPCItem_updateCheckBox,IPCItem.prototype.setRowVisibility=IPCItem_setRowVisibility,IPCItem.prototype.update=IPCItem_update,IPCItem.prototype.update2=IPCItem_update2,IPCItem.prototype.select=IPCItem_select,IPCItem.prototype.subselect=IPCItem_subselect,IPCItem.prototype.show=IPCItem_show,IPCItem.prototype.hlight=IPCItem_hlight,IPCItem.prototype.setTransparency=IPCItem_setTransparency,IPCItem.prototype.getTransparency=IPCItem_getTransparency,IPCItem.prototype.restore3DSelection=IPCItem_restore3DSelection,IPCItem.prototype.paint3D=IPCItem_paint3D,IPCItem.prototype.resetMaterial=IPCItem_resetMaterial,IPCItem.prototype.getTooltipText=IPCItem_getTooltipText,IPCItem.prototype.getItemNumber=IPCItem_getItemNumber,IPCItem.prototype.isEqual=IPCItem_isEqual,IPCItem.prototype.getTitle=IPCItem_getTitle,IPCItem.prototype.fit=IPCItem_fit,IPCItem.prototype.setFiltered=IPCItem_setFiltered,IPCItem.prototype.setFilteredWithoutChildren=IPCItem_setFilteredWithoutChildren,IPCItem.prototype.getVisibility=IPCItem_getVisibility,IPCItem.prototype.updateDoubles=IPCItem_updateDoubles;var isWaitMenu=!1,menuTimeout=null;ContextMenu.prototype.show=ContextMenu_show,ContextMenu.prototype.close=ContextMenu_close,ContextMenu.prototype.checkIsOpen=ContextMenu_checkIsOpen,ContextMenu.prototype.checkPoint=ContextMenu_checkPoint;var scroll_timeout=null,last_view=null,current_view=null,current_view_timeout=null,view_description="",formated_rev_date="MMM DD/YY",TEMP_GRAPHICS=[],tooltipStructure=[],baseItemField=null,views_descriptions=[],rightViews=[],prnApiGeneric={printParams:{},setPrintHeaderStyle:function(e){this.printParams.header=e},setPrintFooterStyle:function(e){this.printParams.footer=e},setPrintHeader:function(e){var t=document.getElementById("viewer_printHeader"),i=this.printParams.header;i&&i.length&&(t.style.borderBottomWidth=i[4]+"pt",t.style.borderBottomStyle=i[5]),t.innerHTML=__printHeaderToHTML(e,this.printParams.header)},setPrintFooter:function(e){var t=document.getElementById("viewer_printFooter"),i=this.printParams.footer;i&&i.length&&(t.style.borderTopWidth=i[4]+"pt",t.style.borderTopStyle=i[5]),t.innerHTML=__printHeaderToHTML(e,this.printParams.footer)}},isTableHidden=!1,topControl;TopLineControl.prototype.onBtnClick=TopLineControl_onBtnClick,TopLineControl.prototype.onBtnOver=TopLineControl_onBtnOver,TopLineControl.prototype.onBtnOut=TopLineControl_onBtnOut,TopLineControl.prototype.onMouseDown=TopLineControl_onMouseDown,TopLineControl.prototype.onMouseUp=TopLineControl_onMouseUp,TopLineControl.prototype.setState=TopLineControl_setState;var navControl;NavigationControl.prototype.onBtnClick=NavigationControl_onBtnClick,NavigationControl.prototype.onBtnOver=NavigationControl_onBtnOver,NavigationControl.prototype.onBtnOut=NavigationControl_onBtnOut,NavigationControl.prototype.checkMode=NavigationControl_checkMode,NavigationControl.prototype.onMouseDown=NavigationControl_onMouseDown,NavigationControl.prototype.onMouseUp=NavigationControl_onMouseUp;var selected3DItems=[],tSlider=null,is_tSliderActive=!1,helpWindow=null,isCalloutsMode=!1,allCallouts=[],calloutDraw=null,ISOSELECTEDCOLOR=RGB(255,255,0),ISOHLIGHTEDCOLOR=RGB(50,255,50),ISONORMALCOLOR=RGB(255,255,255),isControl2DNotFound=!0,isCGMLoaded=!1,contextItem=null,cmenuActions=[],cmenuObjs={},prepareGraphicsAsyncCounter=-1;module.exports={error:function(e,t,i,n,o){var r=cortona3d.scene("cContainer");r.error||r.add(cortona3d.factory.error);var s=[window.iGenericErrorMessage,e];(t||i||n)&&s.push(t+" ("+i+"/"+n+")"),r.error.message.apply(r.error,s).show(),r.loading&&r.loading.hide(),document.getElementById("cFooter")&&(document.getElementById("cFooter").style.display="none"),dispatchContentResize()},ContextMenuNoBlur:ContextMenuNoBlur,OnContextMenuBlur:OnContextMenuBlur,showAbout:showAbout,openLink:openLink,activateView:activateView,zoomIn:function(){cortona3d.scene("cContainer")[viewer2DKey].scaleBy(.1)},zoomOut:function(){cortona3d.scene("cContainer")[viewer2DKey].scaleBy(-.1)},reset:function(){cortona3d.scene("cContainer")[viewer2DKey].reset()},"selectontextItem":function(e){contextItem&&contextItem.select(e)},showCortonaProperties:function(){ipcApi.showCortonaProperties()},toggleFPSIndicator:function(){var e=cortona3d.scene("cContainer");e.fps?e.remove(e.fps):(e.add(cortona3d.factory.fps),e.fps.show())},getWorkTable:function(){return workTable},contextMenuClose:function(){workTable.contextMenuClose()},options:options,onLoad:on_doc_load,onUnload:on_doc_unload,ipcApi:ipcApi}},function(e,t){e.exports=function(e){var t={viewer2D:e.options.UsePlugins?["viewer2d","isoview"]:["svg","iframe"],viewer3D:e.options.UsePlugins?["viewer3d"]:["solo"]};return"undefined"!=typeof e.options.Viewer2DType&&(t.viewer2D={0:["viewer2d","isoview","svg","iframe"],1:["viewer2d"],2:["isoview"],3:["svg"],4:["iframe"]}[e.options.Viewer2DType]),"undefined"!=typeof e.options.Viewer3D&&(t.viewer3D={auto:["viewer3d","solo"],viewer3d:["viewer3d"],solo:["solo"],x3dom:["x3d"]}[e.options.Viewer3D]),t}},function(e,t,i){document.addEventListener("DOMContentLoaded",function(){i.p=(window.publicFolder||window.resFolder||".").replace(/\/+$/,"")+"/",window.Cortona3DSolo={config:i(71)},window.Cortona3DSolo.config.TOTAL_MEMORY=Math.max(16777216,1024*window.totalMemory*1024),document.body.onload=cortona3d.app.onLoad,document.body.onbeforeunload=cortona3d.app.onUnload,window.onerror=function(e,t,i,n,o){cortona3d.app.error.call(null,e,t,i,n,o||new Error(e))}},!1)},function(e,t,i){e.exports={locateFile:function(e){return i.p+e},TOTAL_MEMORY:window&&window.TOTAL_MEMORY||134217728}}]);